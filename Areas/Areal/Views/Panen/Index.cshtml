@using Ptpn8.Areas.Areal.Models
@{
    ViewBag.Title = "Kegiatan Panen";
}

@(Html.Kendo().Splitter()
          .Name("vertical")
          .Orientation(SplitterOrientation.Vertical)
          .Panes(verticalPanes =>
          {
          verticalPanes.Add()
                  .HtmlAttributes(new { id = "top-pane" })
                  .Scrollable(false)
                  .Collapsible(false)
                  .Content(
                    Html.Kendo().Splitter()
                        .Name("horizontal")
                        .HtmlAttributes(new { style = "height: 600px;" })
                        .Panes(horizontalPanes =>
                        {
                        horizontalPanes.Add()
                            .HtmlAttributes(new { id = "left-pane" })
                            .Size("200px")
                            .Collapsible(true)
                            .Content(@<div class="pane-content">
                                <h3>Layer</h3>
                                <br />
                                <table style="width: inherit;">
                                    <tr><td>@Html.Kendo().CheckBox().Name("chkPopUp").Label("PopUp Window ").Checked(false).HtmlAttributes(new { @onchange = "chkPopUpOnChange()" })</td></tr>
                                    <tr><td>@Html.Kendo().CheckBox().Name("chkKebun").Label("Kebun").Checked(true).HtmlAttributes(new { @onchange = "chkKebunOnChange()" })</td></tr>
                                    <tr><td>@Html.Kendo().CheckBox().Name("chkStreetMap").Label("Street Map").Checked(true).HtmlAttributes(new { @onchange = "chkStreetMapOnChange()" })</td></tr>
                                    <tr><td>@Html.Kendo().CheckBox().Name("chkCitra").Label("Citra").Checked(false).HtmlAttributes(new { @onchange = "chkCitraOnChange()" })</td></tr>
                                    <tr><td>@Html.Kendo().CheckBox().Name("chkKontur").Label("Peta Kontur").Checked(false).HtmlAttributes(new { @onchange = "chkKonturOnChange()" })</td></tr>
                                    <tr><td><br /></td></tr>
                                    <tr><td>@Html.Kendo().Button().Name("btnMapExport").Content("Ekspor Peta").Events(e => e.Click("btnMapExportOnClick"))</td></tr>

                                    <tr><td><h4>Cari Kebun/Afdeling/Blok</h4></td></tr>
                                    <tr><td width="100%"><input type="text" id="txtCari" name="txtCari" width="100%" /></td></tr>
                                    <tr><td>@Html.Kendo().Button().Name("btnSearch").Content("Cari").Events(e => e.Click("btnSearchOnClick"))</td></tr>
                                    <tr><td><h4>Budidaya</h4></td></tr>
                                    <tr>
                                        <td width="100%">
                                            @(Html.Kendo().DropDownList()
                                                    .Name("ddlBudidaya")
                                                    .OptionLabel("Pilih Budidaya")
                                                    .AutoBind(true)
                                                    .DataValueField("Nama")
                                                    .DataTextField("Nama")
                                                    .DataSource(o => o.Read(r => r.Action("getBudidaya", "Home")).ServerFiltering(true))
                                                    .HtmlAttributes(new { style = "width: 100%;" })
                                                    .Events(e =>
                                                    {
                                                        e.Select("ddlBudidayaOnSelect");
                                                        e.Change("ddlBudidayaOnChange");
                                                    })
                                            )
                                        </td>
                                    </tr>
                                    <tr><td><h4>Bulan-Tahun</h4></td></tr>
                                    <tr>
                                        <td>
                                            @(Html.Kendo().DropDownList()
                                                .Name("ddlBulan")
                                                .AutoBind(true)
                                                .OptionLabel("Pilih Bulan...")
                                                .DataTextField("Text")
                                                .DataValueField("Value")
                                                .HtmlAttributes(new { style = "width: 100px;" })
                                                .Events(e=> { e.Change("ddlBulanChange");e.Select("ddlBulanSelect");})
                                                .Value(((DateTime.Now.Month)-1).ToString())
                                                .BindTo(new List<SelectListItem>()
                                                {
                                                    new SelectListItem() {Text = "Januari",Value = "1"},
                                                    new SelectListItem() {Text = "Februari",Value = "2"},
                                                    new SelectListItem() {Text = "Maret",Value = "3"},
                                                    new SelectListItem() {Text = "April",Value = "4"},
                                                    new SelectListItem() {Text = "Mei",Value = "5"},
                                                    new SelectListItem() {Text = "Juni",Value = "6"},
                                                    new SelectListItem() {Text = "Juli",Value = "7"},
                                                    new SelectListItem() {Text = "Agustus",Value = "8"},
                                                    new SelectListItem() {Text = "September",Value = "9"},
                                                    new SelectListItem() {Text = "Oktober",Value = "10"},
                                                    new SelectListItem() {Text = "November",Value = "11"},
                                                    new SelectListItem() {Text = "Desember",Value = "12"},
                                                })
                                            )
                                            -
                                            @(Html.Kendo().IntegerTextBox()
                                                .Name("txtTahun")
                                                .Value(DateTime.Now.Year)
                                                .HtmlAttributes(new { style = "width: 60px;" })
                                                .Events(e => { e.Change("txtTahunChange"); })
                                                .Format("{0:0000}")
                                            )

                                        </td>
                                    </tr>
                                </table>
                            </div>);

                        horizontalPanes.Add()
                            .HtmlAttributes(new { id = "center-pane" })
                            .Content(@<div id="map" style="width:100%;height:100%;">
                                @(Html.Kendo().Map()
                                      .Name("map")
                                      .HtmlAttributes(new { style = "height: 100%;" })
                                      .Center(-6, 108) //(-6.878055, 107.596070)
                                      .Zoom(9)
                                      .Layers(layers =>
                                      {
                                          layers.Add()
                                              .Type(MapLayerType.Tile)
                                              .Key("streetmap")
                                              .UrlTemplate("https://#= subdomain #.tile.openstreetmap.org/#= zoom #/#= x #/#= y #.png")
                                              .Subdomains("a", "b", "c")
                                              .Attribution("&copy; <a href='http://osm.org/copyright'>OpenStreetMap contributors</a>");
                                      })
                                      .Layers(layers =>
                                      {
                                          layers.Add()
                                            .Style(style => style.Fill(fill => fill.Opacity(1)))
                                            .Type(MapLayerType.Tile)
                                            .UrlTemplate("https://tile.thunderforest.com/cycle/#= zoom #/#= x #/#= y #.png")
                                            .Key("kontur");
                                      })
                                    .Layers(layers =>
                                    {
                                        layers.Add()
                                        .Style(style => style.Fill(fill => fill.Opacity(1)))
                                        .Key("citra")
                                        .Type(MapLayerType.Bing)
                                        .ImagerySet(MapLayersImagerySet.AerialWithLabels)
                                        .Key("AqaPuZWytKRUA8Nm5nqvXHWGL8BDCXvK8onCl2PkC581Zp3T_fYAQBiwIphJbRAK");
                                    })

                                    .Layers(layers =>
                                    {
                                        layers.Add()
                                            .Style(style => style.Fill(fill => fill.Opacity(0.2)))
                                            .Key("KebunTile")    // Index : 3
                                            .Type(MapLayerType.Tile)
                                            .UrlTemplate("../Areas/Areal/Tiles/#= zoom #/#= x #/#= y #.png")
                                            .Attribution("&copy; PT Perkebunan Nusantara VIII</a>");

                                        layers.Add()
                                            .Type(MapLayerType.Marker)
                                            .Key("Kebun") // Index : 4
                                            .DataSource(dataSource => dataSource
                                                .Read(read => read.Action("KebunGeoJson", "Home").Data("KebunGeoJsonData")))
                                            .LocationField("Location")
                                            .TitleField("NAMA_KEBUN");


                                        layers.Add()
                                         .Style(style => style.Fill(fill => fill.Opacity(1)))
                                         .Key("Afdeling") // Index : 5
                                         .Type(MapLayerType.Shape)
                                         .DataSource(dataSource => dataSource
                                             .GeoJson()
                                             .Read(read => read.Action("AfdelingGeoJson", "Home").Data("AfdelingGeoJsonData"))
                                         );

                                        layers.Add()
                                            .Style(style => style.Fill(fill => fill.Opacity(1)))
                                            .Key("Blok") // Index : 6
                                            .Type(MapLayerType.Shape)
                                            .DataSource(dataSource => dataSource
                                                .GeoJson()
                                                .Read(read => read.Action("BlokGeoJson", "Home").Data("BlokGeoJsonData"))
                                            );
                                    })

                                    .Events(events => events
                                        .ShapeCreated("onShapeCreated")
                                        .ShapeMouseEnter("onShapeMouseEnter")
                                        .ShapeMouseLeave("onShapeMouseLeave")
                                        .ShapeClick("onShapeClick")
                                        .MarkerClick("onMarkerClick")
                                        .Click("onMapClick")
                                    )
                                )

                            </div>);

                        horizontalPanes.Add()
                            .HtmlAttributes(new { id = "right-pane" })
                            .Collapsible(true)
                            .Scrollable(true)
                            .Size("220px")
                            .Content(@<div class="pane-content">
                                <div class="legendKebun" style="display: block;">
                                    <h4>Kebun</h4>
                                    @(Html.Kendo().Grid<Ptpn8.Areas.Areal.Models.PetaView>().Name("grdLegendKebun")
                                        .Events(e => { e.DataBound("grdLegendKebunOnDataBound"); e.Change("grdLegendKebunOnChange"); })
                                        .Selectable()
                                        .AutoBind(false)
                                        .Columns(c =>
                                        {
                                            c.Bound(o => o.Peta).Width(30).ClientTemplate("").HtmlAttributes(new { style = "background: #= Warna #;" });
                                            c.Bound(o => o.Nama).Width(190).HeaderTemplate("Kebun");
                                        })
                                        .DataSource(d => d
                                            .Ajax()
                                            .Read(r => r.Action("getLegendKebun", "Home").Data("legendData"))
                                    ))
                                </div>
                                <div class="legendAfdeling" style="display: none">
                                    <h4>Afdeling</h4>
                                    @(Html.Kendo().Grid<Ptpn8.Areas.Areal.Models.PetaView>().Name("grdLegendAfdeling")
                                        .Events(e => { e.DataBound("grdLegendAfdelingOnDataBound"); e.Change("grdLegendAfdelingOnChange"); })
                                        .Selectable()
                                        .AutoBind(false)
                                        .Columns(c =>
                                        {
                                            c.Bound(o => o.Peta).Width(30).ClientTemplate("").HtmlAttributes(new { style = "background: #= Warna #;" });
                                            c.Bound(o => o.Nama).Width(190).HeaderTemplate("Afdeling");
                                        })
                                        .DataSource(d => d
                                            .Ajax()
                                            .Read(r => r.Action("getLegendAfdeling", "Home").Data("legendData"))
                                    ))
                                </div>
                                <div class="legendBlok" style="display: none">
                                    <h4>Blok</h4>
                                    @(Html.Kendo().Grid<Ptpn8.Areas.Areal.Models.PetaView>().Name("grdLegendBlok")
                                        .Events(e => { e.DataBound("grdLegendBlokOnDataBound"); e.Change("grdLegendBlokOnChange"); })
                                        .Selectable()
                                        .AutoBind(false)
                                        .Columns(c =>
                                        {
                                            c.Bound(o => o.Peta).Width(30).ClientTemplate("").HtmlAttributes(new { style = "background: #= Warna #;" });
                                            c.Bound(o => o.Nama).Width(190).HeaderTemplate("Blok");
                                        })
                                        .DataSource(d => d
                                            .Ajax()
                                            .Read(r => r.Action("getLegendBlok", "Home").Data("legendData"))
                                    ))
                                </div>
                                <div class="legendCari" style="display: none">
                                    <h4>Hasil Pencarian</h4>
                                    @(Html.Kendo().Grid<Ptpn8.Areas.Areal.Models.PetaView>().Name("grdLegendCari")
                                        .Events(e => { e.DataBound("grdLegendCariOnDataBound"); e.Change("grdLegendCariOnChange"); })
                                        .Selectable()
                                        .AutoBind(false)
                                        .Columns(c =>
                                        {
                                            c.Bound(o => o.Warna).Width(30).HeaderTemplate("Id");//.ClientTemplate("").HtmlAttributes(new { style = "background: #= Warna #;" });
                                            c.Bound(o => o.Nama).Width(190).HeaderTemplate("Lokasi");
                                        })
                                        .DataSource(d => d
                                            .Ajax()
                                            .Read(r => r.Action("cariData", "Home").Data("legendCari"))
                                    ))
                                </div>
                        </div>);

                }).ToHtmlString()
              );

            verticalPanes.Add()
              .Size("600px")
              .HtmlAttributes(new { id = "middle-pane" })
              .Collapsible(false)
              .Content(@<div class="pane-content">
                <div><h3>Panen, Bulan : <input type="text" id="lblBulan" readonly="readonly" style="font-weight: 600; background: none; " /></h3></div>
                            
                <div class="grdKebun">
                    @(Html.Kendo().Grid<Ptpn8.Areas.Areal.Models.DataKegiatanKebun>().Name("grdDataKebun")
                            //.Pageable()
                            .Resizable(resizeable => resizeable.Columns(true))
                            .Sortable()
                            .Scrollable()
                            .Filterable()
                            .ColumnMenu()
                            .Groupable()
                            .Selectable()
                            .Events(e => { e.DataBound("grdDataKebunOnDataBound"); e.Change("grdDataKebunOnChange"); })
                            .HtmlAttributes(new { style = "height: 600px;" })
                            .ToolBar(tools => tools.Excel())
                            .AutoBind(false)
                            .Excel(excel => excel
                                  .FileName("ArealKebun.xlsx")
                                  .Filterable(true)
                                  .AllPages(true)
                                  .ProxyURL(Url.Action("Excel_Export_Save", "Home"))
                              )
                          .Columns(c =>
                          {
                              c.Bound(o => o.Id).Hidden();
                              c.Bound(o => o.NamaKebun).HeaderTemplate("Kebun").Locked(true).Width(100);
                              c.Bound(o => o.NamaWilayah).HeaderTemplate("Wilayah").Groupable(true).Hidden();
                              c.Bound(o => o.NamaBudidaya).HeaderTemplate("Budidaya").Groupable(true).Locked(true).Width(150); //.ClientTemplate("#= StringJSonDecode(JSON.stringify(DaftarBudidaya)) #");
                              c.Bound(o => o.LuasAreal).Locked(true).HeaderTemplate("Luas (Ha)").Width(80).Format("{0:n2}").HtmlAttributes(new { style = "text-align: right;" })
                                                .ClientGroupFooterTemplate("#= kendo.toString(sum,'n2') #")
                                                .ClientFooterTemplate("#= kendo.toString(sum,'n2') #")
                                                .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                              c.Group(cc=>cc
                                  .Title("Hasil Kerja dan HK")
                                  .Columns(c1=>
                                  {
                                      c1.Group(o => o
                                        .Title("Karyawan PKWT")
                                        .Columns(g =>
                                        {
                                            g.Bound(q => q.RealisasiJumlahKaryawanLepas).HeaderTemplate("Jml Kary").Format("{0:n0}")
                                                        .Width(70)
                                                        .HtmlAttributes(new { style = "text-align: right;" })
                                                        .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                        .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                        .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            g.Bound(q => q.RealisasiJumlahHKKerjaKaryawanLepas).HeaderTemplate("Jml HK").Format("{0:n0}")
                                                .Width(70)
                                                .HtmlAttributes(new { style = "text-align: right;" })
                                                .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            g.Bound(q => q.RealisasiHasilKerjaKaryawanLepas).HeaderTemplate("Hasil Panen").Format("{0:n0}")
                                                .Width(70)
                                                .HtmlAttributes(new { style = "text-align: right;" })
                                                .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            //g.Bound(q => q.RealisasiHasilKerjaLumpKaryawanLepas).HeaderTemplate("Jml Lump Kg")
                                            //    .ClientTemplate("<div>#=kendo.toString(RealisasiHasilKerjaLumpKaryawanLepas,'n0')#</div><div>(#=kendo.toString(RealisasiHasilKerjaLumpKaryawanLepas/Jumlahkan(RealisasiHasilKerjaKaryawanLepas,RealisasiHasilKerjaLumpKaryawanLepas),'p0')#)</div>")
                                            //    .Width(70)
                                            //    .HtmlAttributes(new { style = "text-align: right;" })
                                            //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            //g.Bound(q => q.RealisasiJumlahUpahKerjaKaryawanLepas).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                            //    .Width(100)
                                            //    .HtmlAttributes(new { style = "text-align: right;" })
                                            //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        }));

                                      c1.Group(o => o
                                          .Title("Karyawan Tetap")
                                          .Columns(p =>
                                          {
                                              p.Bound(q => q.RealisasiJumlahKaryawanTetap).HeaderTemplate("Jml Kary").Format("{0:n0}")
                                                    .Width(70)
                                                    .HtmlAttributes(new { style = "text-align: right;" })
                                                    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              p.Bound(q => q.RealisasiJumlahHKKerjaKaryawanTetap).HeaderTemplate("HK Eff").Format("{0:n0}")
                                                  .Width(70)
                                                  .HtmlAttributes(new { style = "text-align: right;" })
                                                  .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              p.Bound(q => q.RealisasiJumlahHKTidakKerja).HeaderTemplate("Hk Sosial").Format("{0:n0}")
                                                  .Width(70)
                                                  .HtmlAttributes(new { style = "text-align: right;" })
                                                  .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              p.Bound(q => q.RealisasiJumlahHKMangkir).HeaderTemplate("HK Mangkir").Format("{0:n0}")
                                                  .Width(70)
                                                  .HtmlAttributes(new { style = "text-align: right;" })
                                                  .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              p.Bound(q => q.RealisasiHasilKerjaKaryawanTetap).HeaderTemplate("Hasil Panen").Format("{0:n0}")
                                                  .Width(70)
                                                  .HtmlAttributes(new { style = "text-align: right;" })
                                                  .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              //p.Bound(q => q.RealisasiHasilKerjaLumpKaryawanTetap).HeaderTemplate("Jml Lump Kg")
                                              //    .ClientTemplate("<div>#=kendo.toString(RealisasiHasilKerjaLumpKaryawanTetap,'n0')#</div><div>(#=kendo.toString(RealisasiHasilKerjaLumpKaryawanTetap/Jumlahkan(RealisasiHasilKerjaLumpKaryawanTetap,RealisasiHasilKerjaKaryawanTetap),'p0')#)</div>")
                                              //    .Width(70)
                                              //    .HtmlAttributes(new { style = "text-align: right;" })
                                              //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              //p.Bound(q => q.RealisasiJumlahUpahKerjaKaryawanTetap).HeaderTemplate("Jml Upah Eff").Format("{0:n0}")
                                              //    .Width(100)
                                              //    .HtmlAttributes(new { style = "text-align: right;" })
                                              //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              //p.Bound(q => q.RealisasiJumlahUpahSosial).HeaderTemplate("Jml Upah Sosial").Format("{0:n0}")
                                              //    .Width(100)
                                              //    .HtmlAttributes(new { style = "text-align: right;" })
                                              //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              //p.Bound(q => q.RealisasiJumlahUpahKaryawanTetap).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                              //    .Width(100)
                                              //    .HtmlAttributes(new { style = "text-align: right;" })
                                              //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          })
                                      );

                                  })
                                  );

                              c.Group(g => g
                                .Title("Realisasi Biaya")
                                .Columns(p2 =>
                                {
                                    p2.Group(bi=>bi.Title("Bulan Ini").Columns(cbi=> {
                                        cbi.Bound(q => q.RealisasiHasilKerja).HeaderTemplate("Jml Kg").Format("{0:n0}")
                                            .Width(70)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        cbi.Bound(q => q.RealisasiJumlahUpahKerja).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        cbi.Bound(q => q.RealisasiBiayaLain).HeaderTemplate("Brg Bahan / Lain-Lain").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        cbi.Bound(q => q.RealisasiTotalBiaya).HeaderTemplate("Jumlah Biaya").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        cbi.Bound(q => q.Id).HeaderTemplate("Rp/Kg").Format("{0:n2}")
                                            .ClientTemplate("#= kendo.toString(RealisasiJumlahUpahKerja/RealisasiHasilKerja,'n2') #")
                                            .Width(85)
                                            .HtmlAttributes(new { style = "text-align: right;" });
                                        cbi.Bound(q => q.Id).HeaderTemplate("Kg/Ha").Format("{0:n2}")
                                            .ClientTemplate("#= kendo.toString(RealisasiHasilKerja/LuasAreal,'n2') #")
                                            .Width(85)
                                            .HtmlAttributes(new { style = "text-align: right;" });

                                    }));

                                    p2.Group(sbi => sbi.Title("sd Bulan Ini").Columns(csbi =>
                                    {
                                        csbi.Bound(q => q.RealisasiSBIHasilKerja).HeaderTemplate("Jml Kg").Format("{0:n0}")
                                            .Width(70)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        csbi.Bound(q => q.RealisasiSBIJumlahUpahKerja).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        csbi.Bound(q => q.RealisasiSBIBiayaLain).HeaderTemplate("Brg Bahan / Lain-Lain").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        csbi.Bound(q => q.RealisasiSBITotalBiaya).HeaderTemplate("Jumlah Biaya").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        csbi.Bound(q => q.Id).HeaderTemplate("Rp/Kg").Format("{0:n2}")
                                            .ClientTemplate("#= kendo.toString(RealisasiSBIJumlahUpahKerja/RealisasiSBIHasilKerja,'n2') #")
                                            .Width(85)
                                            .HtmlAttributes(new { style = "text-align: right;" });
                                        csbi.Bound(q => q.Id).HeaderTemplate("Kg/Ha").Format("{0:n2}")
                                            .ClientTemplate("#= kendo.toString(RealisasiSBIHasilKerja/LuasAreal,'n2') #")
                                            .Width(85)
                                            .HtmlAttributes(new { style = "text-align: right;" });
                                    }));
                                })
                              );
                              c.Group(g => g
                                .Title("RKAP")
                                .Columns(p2 =>
                                {
                                    p2.Bound(q => q.RKAPJumlahUpahKerja).HeaderTemplate("Bulan Ini").Format("{0:n0}")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" })
                                        .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                    p2.Bound(q => q.Id).HeaderTemplate("% Bln Ini").Format("{0:n0}")
                                        .ClientTemplate("#= kendo.toString(RealisasiTotalBiaya/RKAPJumlahUpahKerja,'p')  #")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" });
                                    p2.Bound(q => q.RKAPSBIJumlahUpahKerja).HeaderTemplate("sd Bulan Ini").Format("{0:n0}")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" })
                                        .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                    p2.Bound(q => q.Id).HeaderTemplate("% sd Bln Ini").Format("{0:n0}")
                                        .ClientTemplate("#= kendo.toString(RealisasiSBITotalBiaya/RKAPSBIJumlahUpahKerja,'p')  #")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" });

                                })
                              );
                              c.Group(g => g
                                .Title("PKB")
                                .Columns(p2 =>
                                {
                                    p2.Bound(q => q.PKBJumlahUpahKerja).HeaderTemplate("Bulan Ini").Format("{0:n0}")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" })
                                        .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                    p2.Bound(q => q.Id).HeaderTemplate("% Bln Ini").Format("{0:n0}")
                                        .ClientTemplate("#= kendo.toString(RealisasiTotalBiaya/PKBJumlahUpahKerja,'p')  #")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" });
                                    p2.Bound(q => q.PKBSBIJumlahUpahKerja).HeaderTemplate("sd Bulan Ini").Format("{0:n0}")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" })
                                        .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                    p2.Bound(q => q.Id).HeaderTemplate("% sd Bln Ini").Format("{0:n0}")
                                        .ClientTemplate("#= kendo.toString(RealisasiSBITotalBiaya/PKBSBIJumlahUpahKerja,'p')  #")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" });

                                })
                              );

                          })
                          .DataSource(d => d
                              .Ajax()
                              .Read(r => r.Action("getKebun", "Panen").Data("getKebunData"))
                              .Group(g => { g.Add(p => p.NamaWilayah); })
                              .Model(m => m.Id(p => p.Id))
                              .Aggregates(ag =>
                              {
                                  ag.Add(o => o.RealisasiJumlahKaryawanLepas).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKKerjaKaryawanLepas).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahKerjaKaryawanLepas).Sum();
                                  ag.Add(o => o.RealisasiJumlahKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKKerjaKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKTidakKerja).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKMangkir).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahKerjaKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahSosial).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiHasilKerjaKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiHasilKerjaKaryawanLepas).Sum();
                                  ag.Add(o => o.RealisasiHasilKerjaLumpKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiHasilKerjaLumpKaryawanLepas).Sum();


                                  ag.Add(o => o.RealisasiJumlahKaryawan).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKKerja).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahKerja).Sum();
                                  ag.Add(o => o.RealisasiHasilKerja).Sum();

                                  ag.Add(o => o.RKAPJumlahKaryawan).Sum();
                                  ag.Add(o => o.RKAPJumlahHKKerja).Sum();
                                  ag.Add(o => o.RKAPJumlahUpahKerja).Sum();
                                  ag.Add(o => o.RKAPHasilKerja).Sum();

                                  ag.Add(o => o.PKBJumlahKaryawan).Sum();
                                  ag.Add(o => o.PKBJumlahHKKerja).Sum();
                                  ag.Add(o => o.PKBJumlahUpahKerja).Sum();
                                  ag.Add(o => o.PKBHasilKerja).Sum();

                                  ag.Add(o => o.RealisasiSBIJumlahKaryawan).Sum();
                                  ag.Add(o => o.RealisasiSBIJumlahHKKerja).Sum();
                                  ag.Add(o => o.RealisasiSBIJumlahUpahKerja).Sum();
                                  ag.Add(o => o.RealisasiSBIHasilKerja).Sum();

                                  ag.Add(o => o.RKAPSBIJumlahKaryawan).Sum();
                                  ag.Add(o => o.RKAPSBIJumlahHKKerja).Sum();
                                  ag.Add(o => o.RKAPSBIJumlahUpahKerja).Sum();
                                  ag.Add(o => o.RKAPSBIHasilKerja).Sum();

                                  ag.Add(o => o.PKBSBIJumlahKaryawan).Sum();
                                  ag.Add(o => o.PKBSBIJumlahHKKerja).Sum();
                                  ag.Add(o => o.PKBSBIJumlahUpahKerja).Sum();
                                  ag.Add(o => o.PKBSBIHasilKerja).Sum();
                                  ag.Add(o => o.LuasAreal).Sum();

                                  ag.Add(o => o.RealisasiBiayaLain).Sum();
                                  ag.Add(o => o.RealisasiSBIBiayaLain).Sum();
                                  ag.Add(o => o.RealisasiTotalBiaya).Sum();
                                  ag.Add(o => o.RealisasiSBITotalBiaya).Sum();

                              })
                      ))
                </div>
                <div class="grdAfdeling" style="display: none">
                    @(Html.Kendo().Grid<Ptpn8.Areas.Areal.Models.DataKegiatanAfdeling>().Name("grdDataAfdeling")
                          //.Pageable()
                          .AutoBind(false)
                          .Resizable(resizeable => resizeable.Columns(true))
                          .Sortable()
                          .Scrollable()
                          .Filterable()
                          .ColumnMenu()
                          .Groupable()
                          .Selectable()
                          .Events(e => { e.DataBound("grdDataAfdelingOnDataBound"); e.Change("grdDataAfdelingOnChange"); })
                          .HtmlAttributes(new { style = "height: 600px;" })
                          .ToolBar(tools => tools.Excel())
                          .AutoBind(false)
                          .Excel(excel => excel
                                  .FileName("ArealAfdeling.xlsx")
                                  .Filterable(true)
                                  .AllPages(true)
                                  .ProxyURL(Url.Action("Excel_Export_Save", "Home"))
                          )
                          .Columns(c =>
                          {
                              c.Bound(o => o.Id).Hidden();
                              c.Bound(o => o.NamaAfdeling).Locked(true).HeaderTemplate("Afdeling").Width(100);
                              c.Bound(o => o.NamaKebun).HeaderTemplate("Kebun").Groupable(true).Hidden();
                              c.Bound(o => o.NamaBudidaya).Locked(true).HeaderTemplate("Budidaya").Width(150); //.ClientTemplate("#= StringJSonDecode(JSON.stringify(DaftarBudidaya)) #");
                              c.Bound(o => o.LuasAreal).Locked(true).HeaderTemplate("Luas (Ha)").Width(80).Format("{0:n2}").HtmlAttributes(new { style = "text-align: right;" })
                                                .ClientGroupFooterTemplate("#= kendo.toString(sum,'n2') #")
                                                .ClientFooterTemplate("#= kendo.toString(sum,'n2') #")
                                                .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                              c.Group(cc=>cc
                                .Title("Hasil Kerja dan HK")
                                .Columns(c1=>
                                {
                                    c1.Group(o => o
                                      .Title("Karyawan PKWT")
                                      .Columns(g =>
                                      {
                                          g.Bound(q => q.RealisasiJumlahKaryawanLepas).HeaderTemplate("Jml Kary").Format("{0:n0}")
                                                      .Width(70)
                                                      .HtmlAttributes(new { style = "text-align: right;" })
                                                      .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                      .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                      .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          g.Bound(q => q.RealisasiJumlahHKKerjaKaryawanLepas).HeaderTemplate("Jml HK").Format("{0:n0}")
                                              .Width(70)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          g.Bound(q => q.RealisasiHasilKerjaKaryawanLepas).HeaderTemplate("Hasil Panen").Format("{0:n0}")
                                              .Width(70)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          //g.Bound(q => q.RealisasiHasilKerjaLumpKaryawanLepas).HeaderTemplate("Lump Kg")
                                          //    .ClientTemplate("<div>#=kendo.toString(RealisasiHasilKerjaLumpKaryawanLepas,'n0')#</div><div>(#=kendo.toString(RealisasiHasilKerjaLumpKaryawanLepas/Jumlahkan(RealisasiHasilKerjaKaryawanLepas,RealisasiHasilKerjaLumpKaryawanLepas),'p0')#)</div>")
                                          //    .Width(70)
                                          //    .HtmlAttributes(new { style = "text-align: right;" })
                                          //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                          //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                          //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          //g.Bound(q => q.RealisasiJumlahUpahKerjaKaryawanLepas).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                          //    .Width(100)
                                          //    .HtmlAttributes(new { style = "text-align: right;" })
                                          //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                          //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                          //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                      }));

                                    c1.Group(o => o
                                        .Title("Karyawan Tetap")
                                        .Columns(p =>
                                        {
                                            p.Bound(q => q.RealisasiJumlahKaryawanTetap).HeaderTemplate("Jml Kary").Format("{0:n0}")
                                                  .Width(70)
                                                  .HtmlAttributes(new { style = "text-align: right;" })
                                                  .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            p.Bound(q => q.RealisasiJumlahHKKerjaKaryawanTetap).HeaderTemplate("HK Eff").Format("{0:n0}")
                                                .Width(70)
                                                .HtmlAttributes(new { style = "text-align: right;" })
                                                .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            p.Bound(q => q.RealisasiJumlahHKTidakKerja).HeaderTemplate("Hk Sosial").Format("{0:n0}")
                                                .Width(70)
                                                .HtmlAttributes(new { style = "text-align: right;" })
                                                .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            p.Bound(q => q.RealisasiJumlahHKMangkir).HeaderTemplate("HK Mangkir").Format("{0:n0}")
                                                .Width(70)
                                                .HtmlAttributes(new { style = "text-align: right;" })
                                                .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            p.Bound(q => q.RealisasiHasilKerjaKaryawanTetap).HeaderTemplate("Hasil Panen").Format("{0:n0}")
                                                .Width(70)
                                                .HtmlAttributes(new { style = "text-align: right;" })
                                                .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            //p.Bound(q => q.RealisasiHasilKerjaLumpKaryawanTetap).HeaderTemplate("Lump Kg")
                                            //    .ClientTemplate("<div>#=kendo.toString(RealisasiHasilKerjaLumpKaryawanTetap,'n0')#</div><div>(#=kendo.toString(RealisasiHasilKerjaLumpKaryawanTetap/Jumlahkan(RealisasiHasilKerjaKaryawanTetap,RealisasiHasilKerjaLumpKaryawanTetap),'p0')#)</div>")
                                            //    .Width(70)
                                            //    .HtmlAttributes(new { style = "text-align: right;" })
                                            //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            //p.Bound(q => q.RealisasiJumlahUpahKerjaKaryawanTetap).HeaderTemplate("Jml Upah Eff").Format("{0:n0}")
                                            //    .Width(100)
                                            //    .HtmlAttributes(new { style = "text-align: right;" })
                                            //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            //p.Bound(q => q.RealisasiJumlahUpahSosial).HeaderTemplate("Jml Upah Sosial").Format("{0:n0}")
                                            //    .Width(100)
                                            //    .HtmlAttributes(new { style = "text-align: right;" })
                                            //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            //p.Bound(q => q.RealisasiJumlahUpahKaryawanTetap).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                            //    .Width(100)
                                            //    .HtmlAttributes(new { style = "text-align: right;" })
                                            //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        })
                                    );
                                })
                              );

                              c.Group(g => g
                                .Title("Realisasi Biaya")
                                .Columns(p2 =>
                                {
                                    p2.Group(bi => bi.Title("Bulan Ini").Columns(cbi =>
                                    {
                                        cbi.Bound(q => q.RealisasiHasilKerja).HeaderTemplate("Jml Kg").Format("{0:n0}")
                                            .Width(70)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        cbi.Bound(q => q.RealisasiJumlahUpahKerja).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        cbi.Bound(q => q.RealisasiBiayaLain).HeaderTemplate("Brg Bahan / Lain-Lain").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        cbi.Bound(q => q.RealisasiTotalBiaya).HeaderTemplate("Jml Biaya").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        cbi.Bound(q => q.Id).HeaderTemplate("Rp/Kg").Format("{0:n2}")
                                            .ClientTemplate("#= kendo.toString(RealisasiJumlahUpahKerja/RealisasiHasilKerja,'n2') #")
                                            .Width(85)
                                            .HtmlAttributes(new { style = "text-align: right;" });
                                        cbi.Bound(q => q.Id).HeaderTemplate("Kg/Ha").Format("{0:n2}")
                                            .ClientTemplate("#= kendo.toString(RealisasiHasilKerja/LuasAreal,'n2') #")
                                            .Width(85)
                                            .HtmlAttributes(new { style = "text-align: right;" });
                                    }));

                                    p2.Group(sbi => sbi.Title("sd Bulan Ini").Columns(csbi =>
                                    {
                                        csbi.Bound(q => q.RealisasiSBIHasilKerja).HeaderTemplate("Jml Kg").Format("{0:n0}")
                                            .Width(70)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        csbi.Bound(q => q.RealisasiSBIJumlahUpahKerja).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        csbi.Bound(q => q.RealisasiSBIBiayaLain).HeaderTemplate("Brg Bahan / Lain-Lain").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        csbi.Bound(q => q.RealisasiSBITotalBiaya).HeaderTemplate("Jml Biaya").Format("{0:n0}")
                                            .Width(100)
                                            .HtmlAttributes(new { style = "text-align: right;" })
                                            .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                            .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                        csbi.Bound(q => q.Id).HeaderTemplate("Rp/Kg").Format("{0:n2}")
                                            .ClientTemplate("#= kendo.toString(RealisasiSBIJumlahUpahKerja/RealisasiSBIHasilKerja,'n2') #")
                                            .Width(85)
                                            .HtmlAttributes(new { style = "text-align: right;" });
                                        csbi.Bound(q => q.Id).HeaderTemplate("Kg/Ha").Format("{0:n2}")
                                            .ClientTemplate("#= kendo.toString(RealisasiSBIHasilKerja/LuasAreal,'n2') #")
                                            .Width(85)
                                            .HtmlAttributes(new { style = "text-align: right;" });

                                    }));
                                })
                              );
                              c.Group(g => g
                                .Title("RKAP")
                                .Columns(p2 =>
                                {
                                    p2.Bound(q => q.RKAPJumlahUpahKerja).HeaderTemplate("Bulan Ini").Format("{0:n0}")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" })
                                        .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                    p2.Bound(q => q.Id).HeaderTemplate("% Bln Ini").Format("{0:n0}")
                                        .ClientTemplate("#= kendo.toString(RealisasiJumlahUpahKerja/RKAPJumlahUpahKerja,'p')  #")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" });
                                    p2.Bound(q => q.RKAPSBIJumlahUpahKerja).HeaderTemplate("sd Bulan Ini").Format("{0:n0}")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" })
                                        .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                    p2.Bound(q => q.Id).HeaderTemplate("% sd Bln Ini").Format("{0:n0}")
                                        .ClientTemplate("#= kendo.toString(RealisasiSBIJumlahUpahKerja/RKAPSBIJumlahUpahKerja,'p')  #")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" });

                                })
                              );
                              c.Group(g => g
                                .Title("PKB")
                                .Columns(p2 =>
                                {
                                    p2.Bound(q => q.PKBJumlahUpahKerja).HeaderTemplate("Bulan Ini").Format("{0:n0}")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" })
                                        .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                    p2.Bound(q => q.Id).HeaderTemplate("% Bln Ini").Format("{0:n0}")
                                        .ClientTemplate("#= kendo.toString(RealisasiJumlahUpahKerja/PKBJumlahUpahKerja,'p')  #")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" });
                                    p2.Bound(q => q.PKBSBIJumlahUpahKerja).HeaderTemplate("sd Bulan Ini").Format("{0:n0}")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" })
                                        .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                        .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                    p2.Bound(q => q.Id).HeaderTemplate("% sd Bln Ini").Format("{0:n0}")
                                        .ClientTemplate("#= kendo.toString(RealisasiSBIJumlahUpahKerja/PKBSBIJumlahUpahKerja,'p')  #")
                                        .Width(100)
                                        .HtmlAttributes(new { style = "text-align: right;" });

                                })
                              );


                          })
                          .DataSource(d => d
                              .Ajax()
                              .Read(r => r.Action("getAfdeling", "Panen").Data("getAfdelingData"))
                              .Group(g => { g.Add(p => p.NamaKebun);})
                              .Model(m => m.Id(p => p.Id))
                              .Aggregates(ag =>
                              {
                                  ag.Add(o => o.RealisasiJumlahKaryawanLepas).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKKerjaKaryawanLepas).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahKerjaKaryawanLepas).Sum();
                                  ag.Add(o => o.RealisasiJumlahKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKKerjaKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKTidakKerja).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKMangkir).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahKerjaKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahSosial).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiHasilKerjaKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiHasilKerjaKaryawanLepas).Sum();
                                  ag.Add(o => o.RealisasiHasilKerjaLumpKaryawanTetap).Sum();
                                  ag.Add(o => o.RealisasiHasilKerjaLumpKaryawanLepas).Sum();

                                  ag.Add(o => o.RealisasiJumlahKaryawan).Sum();
                                  ag.Add(o => o.RealisasiJumlahHKKerja).Sum();
                                  ag.Add(o => o.RealisasiJumlahUpahKerja).Sum();
                                  ag.Add(o => o.RealisasiHasilKerja).Sum();

                                  ag.Add(o => o.RKAPJumlahKaryawan).Sum();
                                  ag.Add(o => o.RKAPJumlahHKKerja).Sum();
                                  ag.Add(o => o.RKAPJumlahUpahKerja).Sum();
                                  ag.Add(o => o.RKAPHasilKerja).Sum();

                                  ag.Add(o => o.PKBJumlahKaryawan).Sum();
                                  ag.Add(o => o.PKBJumlahHKKerja).Sum();
                                  ag.Add(o => o.PKBJumlahUpahKerja).Sum();
                                  ag.Add(o => o.PKBHasilKerja).Sum();

                                  ag.Add(o => o.RealisasiSBIJumlahKaryawan).Sum();
                                  ag.Add(o => o.RealisasiSBIJumlahHKKerja).Sum();
                                  ag.Add(o => o.RealisasiSBIJumlahUpahKerja).Sum();
                                  ag.Add(o => o.RealisasiSBIHasilKerja).Sum();

                                  ag.Add(o => o.RKAPSBIJumlahKaryawan).Sum();
                                  ag.Add(o => o.RKAPSBIJumlahHKKerja).Sum();
                                  ag.Add(o => o.RKAPSBIJumlahUpahKerja).Sum();
                                  ag.Add(o => o.RKAPSBIHasilKerja).Sum();

                                  ag.Add(o => o.PKBSBIJumlahKaryawan).Sum();
                                  ag.Add(o => o.PKBSBIJumlahHKKerja).Sum();
                                  ag.Add(o => o.PKBSBIJumlahUpahKerja).Sum();
                                  ag.Add(o => o.PKBSBIHasilKerja).Sum();

                                  ag.Add(o => o.LuasAreal).Sum();

                                  ag.Add(o => o.RealisasiBiayaLain).Sum();
                                  ag.Add(o => o.RealisasiSBIBiayaLain).Sum();
                                  ag.Add(o => o.RealisasiTotalBiaya).Sum();
                                  ag.Add(o => o.RealisasiSBITotalBiaya).Sum();

                              })
                      ))
                </div>
                <div class="grdBlok" style="display: none">
                    @(Html.Kendo().Grid<Ptpn8.Areas.Areal.Models.DataKegiatanBlok>().Name("grdDataBlok")
                              .Resizable(resizeable => resizeable.Columns(true))
                              .AutoBind(false)
                              .Sortable()
                              .Scrollable()
                              .Filterable()
                              .ColumnMenu()
                              .Groupable()
                              //.Pageable()
                              .Selectable()
                              .Events(e => { e.DataBound("grdDataBlokOnDataBound"); e.Change("grdDataBlokOnChange"); })
                              .HtmlAttributes(new { style = "height: 600px;" })
                              .ToolBar(tools => tools.Excel())
                              .Excel(excel => excel
                                      .FileName("ArealBlok.xlsx")
                                      .Filterable(true)
                                      .AllPages(true)
                                      .ProxyURL(Url.Action("Excel_Export_Save", "Home"))
                              )
                            .Columns(c =>
                            {
                                c.Bound(o => o.Id).Hidden();
                                c.Bound(o => o.NamaBlok).Locked(true).HeaderTemplate("Blok").Width(100);
                                c.Bound(o => o.NamaAfdeling).HeaderTemplate("Afdeling").Groupable(true).Hidden();
                                c.Bound(o => o.NamaBudidaya).Locked(true).HeaderTemplate("Budidaya").Width(150); //.ClientTemplate("#= StringJSonDecode(JSON.stringify(DaftarBudidaya)) #");
                                c.Bound(o => o.LuasAreal).Locked(true).HeaderTemplate("Luas (Ha)").Width(80).Format("{0:n2}").HtmlAttributes(new { style = "text-align: right;" })
                                                  .ClientGroupFooterTemplate("#= kendo.toString(sum,'n2') #")
                                                  .ClientFooterTemplate("#= kendo.toString(sum,'n2') #")
                                                  .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });

                                c.Bound(o => o.TahunTanam).Locked(true).HeaderTemplate("Tahun Tanam").Width(80);
                                c.Group(cc => cc
                                    .Title("Hasil Kerja dan HK")
                                    .Columns(c1 =>
                                    {
                                        c1.Group(o => o
                                          .Title("Karyawan PKWT")
                                          .Columns(g =>
                                          {
                                              g.Bound(q => q.RealisasiJumlahKaryawanLepas).HeaderTemplate("Jml Kary").Format("{0:n0}")
                                                          .Width(70)
                                                          .HtmlAttributes(new { style = "text-align: right;" })
                                                          .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                          .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                          .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              g.Bound(q => q.RealisasiJumlahHKKerjaKaryawanLepas).HeaderTemplate("Jml HK").Format("{0:n0}")
                                                  .Width(70)
                                                  .HtmlAttributes(new { style = "text-align: right;" })
                                                  .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              g.Bound(q => q.RealisasiHasilKerjaKaryawanLepas).HeaderTemplate("Hasil Panen").Format("{0:n0}")
                                                  .Width(70)
                                                  .HtmlAttributes(new { style = "text-align: right;" })
                                                  .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                  .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                              //g.Bound(q => q.RealisasiHasilKerjaLumpKaryawanLepas).HeaderTemplate("Lump Kg")
                                              //    .ClientTemplate("<div>#=kendo.toString(RealisasiHasilKerjaLumpKaryawanLepas,'n0')#</div><div>(#=kendo.toString(RealisasiHasilKerjaLumpKaryawanLepas/Jumlahkan(RealisasiHasilKerjaKaryawanLepas,RealisasiHasilKerjaLumpKaryawanLepas),'p0')#)</div>")
                                              //    .Width(70)
                                              //    .HtmlAttributes(new { style = "text-align: right;" })
                                              //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });

                                              //g.Bound(q => q.RealisasiJumlahUpahKerjaKaryawanLepas).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                              //    .Width(100)
                                              //    .HtmlAttributes(new { style = "text-align: right;" })
                                              //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          }));

                                        c1.Group(o => o
                                            .Title("Karyawan Tetap")
                                            .Columns(p =>
                                            {
                                                p.Bound(q => q.RealisasiJumlahKaryawanTetap).HeaderTemplate("Jml Kary").Format("{0:n0}")
                                                      .Width(70)
                                                      .HtmlAttributes(new { style = "text-align: right;" })
                                                      .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                      .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                      .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                                p.Bound(q => q.RealisasiJumlahHKKerjaKaryawanTetap).HeaderTemplate("HK Eff").Format("{0:n0}")
                                                    .Width(70)
                                                    .HtmlAttributes(new { style = "text-align: right;" })
                                                    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                                p.Bound(q => q.RealisasiHasilKerjaKaryawanTetap).HeaderTemplate("Hasil Panen").Format("{0:n0}")
                                                    .Width(70)
                                                    .HtmlAttributes(new { style = "text-align: right;" })
                                                    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                                //p.Bound(q => q.RealisasiHasilKerjaLumpKaryawanTetap).HeaderTemplate("Lump Kg")
                                                //    .ClientTemplate("<div>#=kendo.toString(RealisasiHasilKerjaLumpKaryawanTetap,'n0')#</div><div>(#=kendo.toString(RealisasiHasilKerjaLumpKaryawanTetap/Jumlahkan(RealisasiHasilKerjaKaryawanTetap,RealisasiHasilKerjaLumpKaryawanTetap),'p0')#)</div>")
                                                //    .Width(70)
                                                //    .HtmlAttributes(new { style = "text-align: right;" })
                                                //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                                //p.Bound(q => q.RealisasiJumlahUpahKaryawanTetap).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                                //    .Width(100)
                                                //    .HtmlAttributes(new { style = "text-align: right;" })
                                                //    .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                //    .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                                //    .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                            })
                                        );

                                    })
                                );
                                c.Group(g => g
                                  .Title("Jumlah Realisasi")
                                  .Columns(p2 =>
                                  {
                                      p2.Group(bi => bi.Title("Bulan Ini").Columns(cbi =>
                                      {
                                          cbi.Bound(q => q.RealisasiHasilKerja).HeaderTemplate("Jml Kg").Format("{0:n0}")
                                              .Width(70)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          cbi.Bound(q => q.RealisasiJumlahUpahKerja).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                              .Width(100)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          cbi.Bound(q => q.RealisasiBiayaLain).HeaderTemplate("Brg Bahan / Lain-Lain").Format("{0:n0}")
                                              .Width(100)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          cbi.Bound(q => q.RealisasiTotalBiaya).HeaderTemplate("Jml Biaya").Format("{0:n0}")
                                              .Width(100)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          cbi.Bound(q => q.Id).HeaderTemplate("Rp/Kg").Format("{0:n2}")
                                              .ClientTemplate("#= kendo.toString(RealisasiJumlahUpahKerja/RealisasiHasilKerja,'n2') #")
                                              .Width(85)
                                              .HtmlAttributes(new { style = "text-align: right;" });
                                          cbi.Bound(q => q.Id).HeaderTemplate("Kg/Ha").Format("{0:n2}")
                                                .ClientTemplate("#= kendo.toString(RealisasiHasilKerja/LuasAreal,'n2') #")
                                                .Width(85)
                                                .HtmlAttributes(new { style = "text-align: right;" });

                                      }));

                                      p2.Group(sbi => sbi.Title("sd Bulan Ini").Columns(csbi =>
                                      {
                                          csbi.Bound(q => q.RealisasiSBIHasilKerja).HeaderTemplate("Jml Kg").Format("{0:n0}")
                                              .Width(70)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          csbi.Bound(q => q.RealisasiSBIJumlahUpahKerja).HeaderTemplate("Jml Upah").Format("{0:n0}")
                                              .Width(100)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          csbi.Bound(q => q.RealisasiSBIBiayaLain).HeaderTemplate("Brg Bahan / Lain-Lain").Format("{0:n0}")
                                              .Width(100)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          csbi.Bound(q => q.RealisasiSBITotalBiaya).HeaderTemplate("Jml Biaya").Format("{0:n0}")
                                              .Width(100)
                                              .HtmlAttributes(new { style = "text-align: right;" })
                                              .ClientGroupFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .ClientFooterTemplate("#= kendo.toString(sum,'n0') #")
                                              .FooterHtmlAttributes(new { style = "text-align: right; font-weight: 500; color: black; font-size: medium; background: silver;" });
                                          csbi.Bound(q => q.Id).HeaderTemplate("Rp/Kg").Format("{0:n2}")
                                              .ClientTemplate("#= kendo.toString(RealisasiSBIJumlahUpahKerja/RealisasiSBIHasilKerja,'n2') #")
                                              .Width(85)
                                              .HtmlAttributes(new { style = "text-align: right;" });
                                          csbi.Bound(q => q.Id).HeaderTemplate("Kg/Ha").Format("{0:n2}")
                                              .ClientTemplate("#= kendo.toString(RealisasiSBIHasilKerja/LuasAreal,'n2') #")
                                              .Width(85)
                                              .HtmlAttributes(new { style = "text-align: right;" });
                                      }));
                                  })
                                );
                            })


                          .DataSource(d => d
                            .Ajax()
                            .Read(r => r.Action("getBlok", "Panen").Data("getBlokData"))
                            .Group(g => g.Add(p => p.NamaAfdeling))
                            .Model(m => m.Id(p => p.Id))
                            .Aggregates(ag =>
                            {
                                ag.Add(o => o.RealisasiJumlahKaryawanLepas).Sum();
                                ag.Add(o => o.RealisasiJumlahHKKerjaKaryawanLepas).Sum();
                                ag.Add(o => o.RealisasiJumlahUpahKerjaKaryawanLepas).Sum();
                                ag.Add(o => o.RealisasiJumlahKaryawanTetap).Sum();
                                ag.Add(o => o.RealisasiJumlahHKKerjaKaryawanTetap).Sum();
                                ag.Add(o => o.RealisasiJumlahHKTidakKerja).Sum();
                                ag.Add(o => o.RealisasiJumlahHKMangkir).Sum();
                                ag.Add(o => o.RealisasiJumlahUpahKerjaKaryawanTetap).Sum();
                                ag.Add(o => o.RealisasiJumlahUpahSosial).Sum();
                                ag.Add(o => o.RealisasiJumlahUpahKaryawanTetap).Sum();
                                ag.Add(o => o.RealisasiHasilKerjaKaryawanTetap).Sum();
                                ag.Add(o => o.RealisasiHasilKerjaKaryawanLepas).Sum();
                                ag.Add(o => o.RealisasiHasilKerjaLumpKaryawanTetap).Sum();
                                ag.Add(o => o.RealisasiHasilKerjaLumpKaryawanLepas).Sum();

                                ag.Add(o => o.RealisasiJumlahKaryawan).Sum();
                                ag.Add(o => o.RealisasiJumlahHKKerja).Sum();
                                ag.Add(o => o.RealisasiJumlahUpahKerja).Sum();
                                ag.Add(o => o.RealisasiHasilKerja).Sum();

                                ag.Add(o => o.RealisasiSBIJumlahKaryawan).Sum();
                                ag.Add(o => o.RealisasiSBIJumlahHKKerja).Sum();
                                ag.Add(o => o.RealisasiSBIJumlahUpahKerja).Sum();
                                ag.Add(o => o.RealisasiSBIHasilKerja).Sum();
                                ag.Add(o => o.LuasAreal).Sum();

                                ag.Add(o => o.RealisasiBiayaLain).Sum();
                                ag.Add(o => o.RealisasiSBIBiayaLain).Sum();
                                ag.Add(o => o.RealisasiTotalBiaya).Sum();
                                ag.Add(o => o.RealisasiSBITotalBiaya).Sum();

                            })
                      ))
                </div>
            </div>);
          })
)

<script>
    var chkPopUp, chkKebun, chkStreetMap, chkCitra, chkKontur;
    var tahun, bulan;
    var map, activeLayer;
    var shapeKlik;
    var statusAreal, lokasiID, kebunID, budidaya, masaBerlakuHGU, textSearch, loadDataKebun;
    var indexStreetMap = 0;
    var indexKontur = 1;
    var indexCitra = 2;
    var indexKebunTile = 3;
    var indexKebun = 4;
    var indexAfdeling = 5;
    var indexBlok = 6;
    var mapExtent;
    var inputProject;

    var popup = $("<div>Foo</div>")
        .appendTo(document.body)
        .kendoPopup()
        .data("kendoPopup");

    $(document).ready(function () {
        bulan = $('#ddlBulan').data('kendoDropDownList').value();
        tahun = $('#txtTahun').val();
        $('#lblBulan').val($('#ddlBulan').data('kendoDropDownList').text() + '-' + $('#txtTahun').val());

        chkPopUp = false;
        chkKebun = true;
        chkStreetMap = true;
        chkCitra = false;
        chkKontur = false;
        statusAreal = "0";
        budidaya = '';
        textSearch = "";
        masaBerlakuHGU = "0"
        shapeKlik = false;
        activeLayer = "Kebun";
        inputProject = false;
        map = $('#map').data('kendoMap');
        for (var i = 0; i < map.layers.length; i++)
        {
            var lyr = map.layers[i];
            if (lyr.options.key == "KebunTile" || lyr.options.key == "Kebun" || lyr.options.key == 'streetmap') lyr.show(); else lyr.hide();
        }
        loadDataKebun = true;
        resetGridData();
    });

    function onShapeCreated(e) {
        var shape = e.shape;
        if(activeLayer=="Afdeling" || activeLayer=="Blok")
        {
            shape.options.fill.set("color", shape.dataItem.properties.COLOR);

            var bbox = e.shape.bbox();
            var center = bbox.center();

            // Create the label
            var labelText = e.shape.dataItem.properties.NAMA_KEBUN;
            var label = new kendo.drawing.Text(labelText);
            var labelCenter = label.bbox().center();

            // Position the label
            label.position([
              center.x - labelCenter.x,
              center.y - labelCenter.y
            ]);

            // Render the label on the layer surface
            e.layer.surface.draw(label);
        }
    }

    function onShapeMouseEnter(e) {
        e.shape.options.set("fill.opacity", 0.7);
        var oe = e.originalEvent;
        var x = oe.pageX || oi.clientX;
        var y = oe.pageY || oi.clientY;
        var name = e.shape.dataItem.properties.NAMA_KEBUN;
        $('#NamaLokasi').val(name);
        popup.element.html(name);
        popup.open(x, y);
    }

    function onShapeMouseLeave(e) {
        e.shape.options.set("fill.opacity", 1);
        if (!$(e.originalEvent.relatedTarget).is(".k-popup, .k-animation-container")) {
            if (!chkPopUp) {
                popup.close();
                popup.element.kendoStop(true, true);
            }
        }
    }

    function onMarkerClick(e)
    {
        var map = $('#map').data('kendoMap');
        if (activeLayer == "Kebun") {
            var url = '../Areal/Home/areaKebun';
            $.ajax({
                url: url,
                data: {
                    id: e.marker.dataItem.IDPeta
                }, //parameters go here in object literal form
                type: 'GET',
                datatype: 'json',
                success: function (result) {
                    if (result[0] != '') {
                        var loc1 = new kendo.dataviz.map.Location(result[2], result[1]);
                        var loc2 = new kendo.dataviz.map.Location(result[4], result[3]);
                        var extent = new kendo.dataviz.map.Extent(loc1, loc2);
                        var lyr = map.layers[indexAfdeling];
                        mapExtent = extent;
                        lokasiID = result[0];
                        kebunID = result[0];
                        activeLayer = "Afdeling";
                        lyr.dataSource.data([]);
                        lyr.dataSource.read({ Id: lokasiID });
                        lyr.show();
                        map.layers[indexKebun].hide();
                        map.extent(extent);
                        resetGridData();
                    }
                },
                error: function () { alert("Error!"); }
            });
        }
    }

    function onMapClick(e)
    {
        var map = $('#map').data('kendoMap');
        if (activeLayer == "Kebun")
        {
        }
        else if (activeLayer == "Afdeling"  && !shapeKlik)
        {
            activeLayer = "Kebun";
            map.layers[indexKebun].show();
            map.layers[indexAfdeling].hide();
            map.layers[indexBlok].hide();
            //map.extent(mapExtent);
            map.zoom(12);
            resetGridData();
        }
        else if (activeLayer == "Blok" && !shapeKlik) {
            activeLayer = "Afdeling";
            map.layers[indexKebun].hide();
            map.layers[indexAfdeling].show();
            map.layers[indexBlok].hide();
            map.extent(mapExtent);
            map.zoom(14);
            lokasiID = kebunID;
            cariLokasi();
            resetGridData();
        }
        shapeKlik = false;
    }

    function onShapeClick(e) {
        var map = $('#map').data('kendoMap');
        var loc1 = new kendo.dataviz.map.Location(e.shape.dataItem.properties.TOPLEFT_Y, e.shape.dataItem.properties.TOPLEFT_X);
        var loc2 = new kendo.dataviz.map.Location(e.shape.dataItem.properties.BOTTOMRIGHT_Y, e.shape.dataItem.properties.BOTTOMRIGHT_X);
        var extent = new kendo.dataviz.map.Extent(loc1, loc2);

        lokasiID = e.shape.dataItem.properties.ID;
        shapeKlik = true;

        if (activeLayer == "Afdeling") {
            activeLayer = "Blok";
            var lyr = map.layers[indexBlok];
            lyr.dataSource.data([]);
            lyr.dataSource.read({ Id: lokasiID });
            map.extent(extent);
            mapExtent = extent;
            lyr.show();
            resetGridData();
        } else if (activeLayer == "Blok") {
            // tampilkan menu blok
            wnd.open().center();
            $('#yes').click(btnYesClick);
            $('#no').click(btnNoClick);
        }
    }

    function chkPopUpOnChange(e) {
        if (chkPopUp) chkPopUp = false; else chkPopUp=true;
    }

    function chkKebunOnChange(e) {
        var map = $('#map').data('kendoMap');
        if (chkKebun) {
            chkKebun = false;
            map.layers[indexKebun].hide();
            map.layers[indexAfdeling].hide();
            map.layers[indexBlok].hide();
        }
        else {
            chkKebun = true;
            if (activeLayer == "Kebun") {
                map.layers[indexKebun].show();
                map.layers[indexAfdeling].hide();
                map.layers[indexBlok].hide();
            }
            else if (activeLayer == "Afdeling") {
                map.layers[indexKebun].hide();
                map.layers[indexAfdeling].show();
                map.layers[indexBlok].hide();
            }
            else if (activeLayer == "Blok") {
                map.layers[indexKebun].hide();
                map.layers[indexAfdeling].show();
                map.layers[indexBlok].show();
            }
        }
    }

    function chkStreetMapOnChange(e) {
        var map = $('#map').data('kendoMap');
        if (chkStreetMap) {
            chkStreetMap = false;
            map.layers[indexStreetMap].hide();
        }
        else {
            chkStreetMap = true;
            map.layers[indexStreetMap].show();
        }
    }

    function chkKonturOnChange(e) {
        var map = $('#map').data('kendoMap');
        if (chkKontur) {
            chkKontur = false;
            map.layers[indexKontur].hide();
        }
        else {
            chkKontur = true;
            map.layers[indexKontur].show();
        }
    }

    function chkCitraOnChange(e) {
        var map = $('#map').data('kendoMap');
        if (chkCitra) {
            chkCitra= false;
            map.layers[indexCitra].hide();
        }
        else {
            chkCitra = true;
            map.layers[indexCitra].show();
        }
    }

    function grdLegendKebunOnDataBound(e)
    {
    }

    function grdLegendKebunOnChange(e) {
        var data = this.dataItem(this.select());
        var id = data.Id;
        cariLokasi(id, "Kebun");
    }

    function grdLegendAfdelingOnDataBound(e) {
    }

    function grdLegendAfdelingOnChange(e) {
        var data = this.dataItem(this.select());
        var id = data.Id;
        cariLokasi(id, "Afdeling");
    }

    function grdLegendBlokOnDataBound(e) {
    }

    function grdLegendBlokOnChange(e) {
        var data = this.dataItem(this.select());
        var id = data.Id;
        cariLokasi(id, "Blok");
    }

    function grdLegendCariOnDataBound(e) {
    }

    function grdLegendCariOnChange(e) {
        var data = this.dataItem(this.select());
        var id = data.Id;
        var lyrKey = data.Warna;
        lokasiID = data.IdInduk;
        cariLokasi(id, lyrKey);
    }

    function grdDataKebunOnDataBound(e)
    {
        var rows = e.sender.tbody.children();
        var JumlahLump = 0;
        var Jumlahroduksi = 0;
        var JumlahHK = 0;

        for (var j = 0; j < rows.length; j++) {
            var row = $(rows[j]);
            var dataItem = e.sender.dataItem(row);

            if (dataItem.get("NamaBudidaya") == 'Karet')
            {
                JumlahLump = dataItem.get("RealisasiHasilKerjaLumpKaryawanTetap") + dataItem.get("RealisasiHasilKerjaLumpKaryawanLepas");
                JumlahProduksi = dataItem.get("RealisasiHasilKerjaKaryawanTetap") + dataItem.get("RealisasiHasilKerjaKaryawanLepas")+dataItem.get("RealisasiHasilKerjaLumpKaryawanTetap") + dataItem.get("RealisasiHasilKerjaLumpKaryawanLepas");

                if (JumlahLump / JumlahProduksi >= 0.25) {
                    row.addClass("PencapaianDibawah90pct");
                }
                else {
                    row.addClass("PencapaianDiatas100pct");
                }
            }
            else if(dataItem.get("NamaBudidaya") == 'Teh')
            {
                JumlahHK = dataItem.get("RealisasiJumlahHKKerjaKaryawanTetap") + dataItem.get("RealisasiJumlahHKKerjaKaryawanLepas");
                JumlahProduksi = dataItem.get("RealisasiHasilKerjaKaryawanTetap") + dataItem.get("RealisasiHasilKerjaKaryawanLepas")
                if(JumlahProduksi/JumlahHK < 100 )
                {
                    row.addClass("PencapaianDibawah90pct");
                }
                else {
                    row.addClass("PencapaianDiatas100pct");
                }
            }
        }

    }

    function grdDataKebunOnChange(e) {
        var data = this.dataItem(this.select());
        var id = data.Id;
        cariLokasi(id, "Kebun");
    }

    function grdDataAfdelingOnDataBound(e)
    {
        var rows = e.sender.tbody.children();
        var JumlahLump = 0;
        var Jumlahroduksi = 0;
        var JumlahHK = 0;

        for (var j = 0; j < rows.length; j++) {
            var row = $(rows[j]);
            var dataItem = e.sender.dataItem(row);

            if (dataItem.get("NamaBudidaya") == 'Karet') {
                JumlahLump = dataItem.get("RealisasiHasilKerjaLumpKaryawanTetap") + dataItem.get("RealisasiHasilKerjaLumpKaryawanLepas");
                JumlahProduksi = dataItem.get("RealisasiHasilKerjaKaryawanTetap") + dataItem.get("RealisasiHasilKerjaKaryawanLepas") + dataItem.get("RealisasiHasilKerjaLumpKaryawanTetap") + dataItem.get("RealisasiHasilKerjaLumpKaryawanLepas");

                if (JumlahLump / JumlahProduksi >= 0.25) {
                    row.addClass("PencapaianDibawah90pct");
                }
                else
                {
                    row.addClass("PencapaianDiatas100pct");
                }
            }
            else if (dataItem.get("NamaBudidaya") == 'Teh') {
                JumlahHK = dataItem.get("RealisasiJumlahHKKerjaKaryawanTetap") + dataItem.get("RealisasiJumlahHKKerjaKaryawanLepas");
                JumlahProduksi = dataItem.get("RealisasiHasilKerjaKaryawanTetap") + dataItem.get("RealisasiHasilKerjaKaryawanLepas")
                if (JumlahProduksi / JumlahHK <= 70) {
                    row.addClass("PencapaianDibawah90pct");
                }
                else {
                    row.addClass("PencapaianDiatas100pct");
                }

            }
        }
    }

    function grdDataAfdelingOnChange(e) {
        var data = this.dataItem(this.select());
        var id = data.Id;
        cariLokasi(id, "Afdeling");
    }

    function grdDataBlokOnDataBound(e)
    {
        var rows = e.sender.tbody.children();
        var JumlahLump = 0;
        var Jumlahroduksi = 0;
        var JumlahHK = 0;

        for (var j = 0; j < rows.length; j++) {
            var row = $(rows[j]);
            var dataItem = e.sender.dataItem(row);

            if (dataItem.get("NamaBudidaya") == 'Karet') {
                JumlahLump = dataItem.get("RealisasiHasilKerjaLumpKaryawanTetap") + dataItem.get("RealisasiHasilKerjaLumpKaryawanLepas");
                JumlahProduksi = dataItem.get("RealisasiHasilKerjaKaryawanTetap") + dataItem.get("RealisasiHasilKerjaKaryawanLepas") + dataItem.get("RealisasiHasilKerjaLumpKaryawanTetap") + dataItem.get("RealisasiHasilKerjaLumpKaryawanLepas");

                if (JumlahLump / JumlahProduksi >= 0.25) {
                    row.addClass("PencapaianDibawah90pct");
                }
                else {
                    row.addClass("PencapaianDiatas100pct");
                }
            }
            else if (dataItem.get("NamaBudidaya") == 'Teh') {
                JumlahHK = dataItem.get("RealisasiJumlahHKKerjaKaryawanTetap") + dataItem.get("RealisasiJumlahHKKerjaKaryawanLepas");
                JumlahProduksi = dataItem.get("RealisasiHasilKerjaKaryawanTetap") + dataItem.get("RealisasiHasilKerjaKaryawanLepas")
                if (JumlahProduksi / JumlahHK <= 70) {
                    row.addClass("PencapaianDibawah90pct");
                }
                else {
                    row.addClass("PencapaianDiatas100pct");
                }

            }
        }
    }

    function grdDataBlokOnChange(e) {
        var data = this.dataItem(this.select());
        var id = data.Id;
        cariLokasi(id, "Blok");
    }

    function cariLokasi(id, lyrKey)
    {
        var map = $('#map').data('kendoMap');
        if (lyrKey == "Kebun") {
            if (lyrKey != activeLayer) {
                activeLayer = "Kebun";
                resetGridData();
            }
            var lyrKebun = map.layers[indexKebun];
            for (var i = 0; i < lyrKebun.items.length; i++) {
                if (lyrKebun.items[i].dataItem.ID == id) {
                    map.layers[indexKebun].show();
                    map.layers[indexAfdeling].hide();
                    map.layers[indexBlok].hide();
                    map.center([parseFloat(lyrKebun.items[i].dataItem.Location[0]), parseFloat(lyrKebun.items[i].dataItem.Location[1])]);
                    map.zoom(14);
                    break;
                }
            }
        }
        else {

            var url = '../Areal/Home/cariLokasi';
            $.ajax({
                url: url,
                data: {
                    id: id,
                    key: lyrKey
                }, //parameters go here in object literal form
                type: 'GET',
                datatype: 'json',
                success: function (result) {
                    if (result[0] != '') {
                        var loc1 = new kendo.dataviz.map.Location(result[2], result[1]);
                        var loc2 = new kendo.dataviz.map.Location(result[4], result[3]);
                        var extent = new kendo.dataviz.map.Extent(loc1, loc2);
                        if (lyrKey == "Afdeling") {
                            if (lyrKey != activeLayer) {
                                activeLayer = "Afdeling";
                                resetGridData();
                                map.layers[indexAfdeling].dataSource.data([]);
                                map.layers[indexAfdeling].dataSource.read({ Id: lokasiID });
                            }
                            map.layers[indexKebun].hide();
                            map.layers[indexAfdeling].show();
                            map.layers[indexBlok].hide();
                            mapExtent = extent;
                            map.extent(extent);
                            map.zoom(15);

                        }
                        else if (lyrKey == "Blok") {
                            if (lyrKey != activeLayer) {
                                activeLayer = "Blok";
                                resetGridData();
                                map.layers[indexBlok].dataSource.data([]);
                                map.layers[indexBlok].dataSource.read({ Id: lokasiID });
                            }
                            map.layers[indexKebun].hide();
                            map.layers[indexAfdeling].show();
                            map.layers[indexBlok].show();
                            mapExtent = extent;
                            map.extent(extent);
                            map.zoom(17);
                        }
                    }
                },
                error: function () { alert("Error!"); }
            });
        }
    }

    function getKebunData()
    {
        return { Id: "", budidaya: budidaya, tahun: tahun , bulan: bulan }
    }

    function getAfdelingData()
    {
        return { Id: lokasiID, budidaya: budidaya, tahun: tahun, bulan: bulan }
    }

    function getBlokData()
    {
        return { Id: lokasiID, budidaya: budidaya, tahun: tahun, bulan: bulan }
    }

    function legendData() {
        return { Id: lokasiID, statusAreal: '1.1',  budidaya: budidaya, tahun: tahun, bulan: bulan }
    }

    function legendCari() {
        return { cariText: $('#txtCari').val() }
    }

    function KebunGeoJsonData() {
        return { Id: lokasiID, budidaya: budidaya, tahun: tahun , bulan: bulan }
    }

    function AfdelingGeoJsonData() {
        return { Id: lokasiID, statusAreal: '1.1', budidaya: budidaya, tahun: tahun, bulan: bulan }
    }

    function BlokGeoJsonData() {
        return { Id: lokasiID, statusAreal: '1.1', budidaya: budidaya, tahun: tahun, bulan: bulan }
    }

    function ddlBudidayaOnSelect(e)
    {
        //budidaya = $('#ddlBudidaya').data('kendoDropDownList').value();
        //loadDataKebun = true;
        //resetGridData();
    }

    function ddlBudidayaOnChange(e)
    {
        budidaya = $('#ddlBudidaya').data('kendoDropDownList').value();
        loadDataKebun = true;
        resetGridData();
    }

    function resetGridData() {
        if (activeLayer == "Kebun") {
            if (loadDataKebun) {
                $('#grdDataKebun').data('kendoGrid').dataSource.read();
                $('#grdLegendKebun').data('kendoGrid').dataSource.read();
                loadDataKebun = false;
            }
            $('.grdKebun').css('display', 'block');
            $('.grdAfdeling').css('display', 'none');
            $('.grdBlok').css('display', 'none');
            $('.legendKebun').css('display', 'block');
            $('.legendAfdeling').css('display', 'none');
            $('.legendBlok').css('display', 'none');
            $('.legendCari').css('display', 'none');
        }
        else if (activeLayer == "Afdeling") {
            $('#grdDataAfdeling').data('kendoGrid').dataSource.read();
            $('#grdLegendAfdeling').data('kendoGrid').dataSource.read();
            $('.grdKebun').css('display', 'none');
            $('.grdAfdeling').css('display', 'block');
            $('.grdBlok').css('display', 'none');
            $('.legendKebun').css('display', 'none');
            $('.legendAfdeling').css('display', 'block');
            $('.legendBlok').css('display', 'none');
            $('.legendCari').css('display', 'none');
        }
        else {
            $('#grdDataBlok').data('kendoGrid').dataSource.read();
            $('#grdLegendBlok').data('kendoGrid').dataSource.read();
            $('.grdKebun').css('display', 'none');
            $('.grdAfdeling').css('display', 'none');
            $('.grdBlok').css('display', 'block');
            $('.legendKebun').css('display', 'none');
            $('.legendAfdeling').css('display', 'none');
            $('.legendBlok').css('display', 'block');
            $('.legendCari').css('display', 'none');
        }
    }

    function btnSearchOnClick(e)
    {
        activeLayer = "Kebun";
        $('#grdLegendCari').data('kendoGrid').dataSource.read({ cariText: $('#txtCari').val() });
        $('.legendKebun').css('display', 'none');
        $('.legendAfdeling').css('display', 'none');
        $('.legendBlok').css('display', 'none');
        $('.legendCari').css('display', 'block');
    }

    function btnMapExportOnClick(e)
    {
        // Convert the DOM element to a drawing using kendo.drawing.drawDOM
        kendo.drawing.drawDOM($("#map"))
        .then(function (group) {
            // Render the result as a PNG image
            return kendo.drawing.exportImage(group);
        })
        .done(function (data) {
            // Save the image file
            kendo.saveAs({
                dataURI: data,
                fileName: "Map.png",
                proxyURL: "@Url.Action("Export_Save", "Home")"
            });
    });

    }

    function StringJSonDecode(value)
    {
        return value.replace(/"/g, '').replace("[",'').replace("]",'').replace(/,/g,", ");
    }

    function ddlBulanChange(e) {
        bulan = $('#ddlBulan').data('kendoDropDownList').value();
        loadDataKebun = true;
        $('#lblBulan').val($('#ddlBulan').data('kendoDropDownList').text() + '-' + $('#txtTahun').val());
        resetGridData();
    }

    function ddlBulanSelect(e) {
        //bulan = $('#ddlBulan').data('kendoDropDownList').value();
        //loadDataKebun = true;
        //resetGridData();
    }

    function txtTahunChange(e)
    {
        tahun = $('#txtTahun').val();
        loadDataKebun = true;
        $('#lblBulan').val($('#ddlBulan').data('kendoDropDownList').text() + '-' + $('#txtTahun').val());
        resetGridData();
    }

    function Jumlahkan(a,b)
    {
        return a + b;
    }

</script>


<style>
    #vertical {
        height: 1200px;
        margin: 0 auto;
    }

    #middle-pane {
        background-color: rgba(60, 70, 80, 0.10);
    }

    #bottom-pane {
        background-color: rgba(60, 70, 80, 0.15);
    }

    #left-pane, #center-pane, #right-pane {
        background-color: rgba(60, 70, 80, 0.05);
    }

    .pane-content {
        padding: 0 10px;
    }
    /*.k-grid .k-header {
        display: none;
    }*/
        .PencapaianDibawah90pct {
        color: white;
        background-color : red;
    }

    .PencapaianDiatas100pct {
        color: white;
        background-color : green;
    }

    .PencapaianDiatas90sd100pct {
        color: black;
        background-color : yellow;
    }

</style>