SET DATEFORMAT DMY; 
DECLARE @tbl1 TABLE
( 
	NoUrut int, 
	Uraian nvarchar(max), 
	[PASIRMALANG] float, [KERTAMANAH] float, [MALABAR] float, [PURBASARI] float, [TALUNSANTOSA] float, [SEDEP] float, [PAPANDAYAN] float, [CISARUNI] float, [DAYEUHMANGGUNG] float,  [MIRAMARE] float, [BAGJANAGARA] float, [BATULAWANG] float, [BUNISARI/LENDRA] float, [CIATER] float, [TAMBAKSARI] float, [WANGUNREJA] float, [CIKUPA] float, [BUKITUNGGUL] float, [SINUMBRA] float, [RANCABALI] float, [RANCABOLANG] float, [PANGLEJAR / PANGHEOTAN] float, [MONTAYA] float, [PASIRNANGKA] float, [PANYAIRAN] float, [GOALPARA] float, [GEDEH] float, [GUNUNGMAS] float, [CIANTEN] float, [JALUPANG] float, [CIKUMPAY] float, [AGRABINTA] float, [CIKASO] float, [BOJONGDATAR] float, [CISALAKBARU] float, [CIKASUNGKA] float, [PARAKANSALAK] float, [SUKAMAJU] float, [CIBUNGUR] float, [PASIRBADAK] float, [KERTAJAYA] float    
) 
INSERT INTO @tbl1 
SELECT * FROM 
	( 
	SELECT DISTINCT D.Nama as NamaKebun, A.NoUrut, A.Uraian, B.Disetujui
	FROM [SPDK_KanpusEF].[dbo].[FormatRemiseKebutuhanModalKerja] as A 
	JOIN [SPDK_KanpusEF].[dbo].[DTL_RemiseKebutuhanModalKerja] as B 
	ON A.FormatRemiseKebutuhanModalKerjaId=B.FormatRemiseKebutuhanModalKerjaId
	JOIN [SPDK_KanpusEF].[dbo].[HDR_Remise] as C
	ON B.HDR_RemiseId = C.HDR_RemiseId
	JOIN [ReferensiEF].[dbo].[Kebun] as D
	ON C.KebunId = D.KebunId
	WHERE C.BulanRemise='07' and C.TahunRemise='2017' and A.IHT='Bukan'
	) 
src pivot 
( 
	sum(Disetujui) for NamaKebun in ([PASIRMALANG], [KERTAMANAH], [MALABAR], [PURBASARI], [TALUNSANTOSA], [SEDEP], [PAPANDAYAN], [CISARUNI], [DAYEUHMANGGUNG],  [MIRAMARE], [BAGJANAGARA], [BATULAWANG], [BUNISARI/LENDRA], [CIATER], [TAMBAKSARI], [WANGUNREJA], [CIKUPA], [BUKITUNGGUL], [SINUMBRA], [RANCABALI], [RANCABOLANG], [PANGLEJAR / PANGHEOTAN], [MONTAYA], [PASIRNANGKA], [PANYAIRAN], [GOALPARA], [GEDEH], [GUNUNGMAS], [CIANTEN], [JALUPANG], [CIKUMPAY], [AGRABINTA], [CIKASO], [BOJONGDATAR], [CISALAKBARU], [CIKASUNGKA], [PARAKANSALAK], [SUKAMAJU], [CIBUNGUR], [PASIRBADAK], [KERTAJAYA])
) 
piv 
ORDER BY NoUrut; 
DECLARE @tbl2 TABLE
( 
	NoUrut int,
	Uraian nvarchar(max), 
	[PASIRMALANG] float, [KERTAMANAH] float, [MALABAR] float, [PURBASARI] float, [TALUNSANTOSA] float, [SEDEP] float, [PAPANDAYAN] float, [CISARUNI] float, [DAYEUHMANGGUNG] float,  [MIRAMARE] float, [BAGJANAGARA] float, [BATULAWANG] float, [BUNISARI/LENDRA] float, [CIATER] float, [TAMBAKSARI] float, [WANGUNREJA] float, [CIKUPA] float, [BUKITUNGGUL] float, [SINUMBRA] float, [RANCABALI] float, [RANCABOLANG] float, [PANGLEJAR / PANGHEOTAN] float, [MONTAYA] float, [PASIRNANGKA] float, [PANYAIRAN] float, [GOALPARA] float, [GEDEH] float, [GUNUNGMAS] float, [CIANTEN] float, [JALUPANG] float, [CIKUMPAY] float, [AGRABINTA] float, [CIKASO] float, [BOJONGDATAR] float, [CISALAKBARU] float, [CIKASUNGKA] float, [PARAKANSALAK] float, [SUKAMAJU] float, [CIBUNGUR] float, [PASIRBADAK] float, [KERTAJAYA] float
) 
INSERT @tbl2 
SELECT NoUrut, Uraian, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 
FROM [SPDK_KanpusEF].[dbo].[FormatRemiseKebutuhanModalKerja]
where IHT='Bukan'

SELECT A.NoUrut,A.Uraian, 
B.PASIRMALANG,B.KERTAMANAH,B.MALABAR,B.PURBASARI,B.TALUNSANTOSA,B.SEDEP,B.PAPANDAYAN,B.CISARUNI,B.DAYEUHMANGGUNG,B.MIRAMARE,B.BAGJANAGARA,B.BATULAWANG,B.[BUNISARI/LENDRA] as BUNISARILENDRA,B.CIATER,B.TAMBAKSARI,B.WANGUNREJA,B.CIKUPA,B.BUKITUNGGUL,B.SINUMBRA,B.RANCABALI,B.RANCABOLANG,B.[PANGLEJAR / PANGHEOTAN] as PANGLEJAR,B.MONTAYA,B.PASIRNANGKA,B.PANYAIRAN,B.GOALPARA,B.GEDEH,B.GUNUNGMAS,B.CIANTEN,B.JALUPANG,B.CIKUMPAY,B.AGRABINTA,B.CIKASO,B.BOJONGDATAR,B.CISALAKBARU,B.CIKASUNGKA,B.PARAKANSALAK,B.SUKAMAJU,B.CIBUNGUR,B.PASIRBADAK,B.KERTAJAYA 
FROM @tbl2 AS A 
LEFT OUTER JOIN @tbl1 AS B 
ON A.NoUrut=B.NoUrut 
ORDER BY A.NoUrut