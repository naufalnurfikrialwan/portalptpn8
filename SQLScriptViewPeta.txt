USE [SPDK_KBN_KONSOL]
GO
/****** Object:  StoredProcedure [dbo].[ArealDanEvaluasiKinerja_HasilKerjaPerBlok]    Script Date: 01/09/2017 09:48:52 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
ALTER PROCEDURE [dbo].[ArealDanEvaluasiKinerja_PetaView]
@Id as nvarchar(max),						-- kode induk nya, kalo @Layer='Kebun' @Id='', kalo @Layer='Afdeling' @Id=Kode Kebun, kalo @Layer='Blok' @Id = Kode Afdeling
@Layer as nvarchar(max),					-- pilihan nya : 'Kebun', 'Afdeling' atau 'Blok'
@BulanAwal as int,@TahunAwal as int,@BulanAkhir as int, @TahunAkhir as int,
@Budidaya as nvarchar(max),					-- Kode Budidaya
@KodeRekening as nvarchar(max),				-- Kode Rekening
@FieldYangDibandingkan as nvarchar(max),	-- 'HK','PRESTASI','BIAYA','PROTAS'
@DibandingkanDengan as nvarchar(max),		-- 'INDUK','RKAP','PKB' atau 'BALAI'
@OrderBulan as nvarchar(max)				-- 'BI' atau 'SBI'
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	set dateformat dmy

	declare @tglAwal as datetime
	declare @tglAkhir as datetime
	
	set @tglAwal = CAST('01/'+cast(@BulanAwal as varchar(10))+'/'+cast(@TahunAwal as varchar(10)) as datetime)  
	if @BulanAkhir=12
	begin
		set @tglAkhir = CAST('01/01/'+cast(@TahunAkhir+1 as varchar(10)) as datetime)  
		set @tglAkhir = @tglAkhir-1
	end
	else
	begin
		set @tglAkhir = CAST('01/'+cast(@BulanAkhir+1 as varchar(10))+'/'+cast(@TahunAkhir as varchar(10)) as datetime)  
		set @tglAkhir = @tglAkhir-1
	end	

    -- Insert statements for procedure here
    
    SELECT A.KMK, A.kodeunit,A.kodebud1,A.kodeafd1,A.kdblok,month(A.tanggal) as bulan, year(A.tanggal) as tahun, A.kdpanen,A.thntnm,A.regmdr,A.grup,substring(A.norek,1,5) as norek,
		Count(*) as RealisasiJumlahHK, SUM(A.jmlupah) as jmlupah, SUM(A.hslpanen) as hslpanen, SUM(A.hslpanenlump) as hslpanenlump, 
        SUM(A.hslpanenTBS) as hslpanenTBS, sum(A.jelajahHA) as Jelajah, sum(A.nbrd) as JumlahPohon, avg(A.jelajahHA) as JelajahMesin,
        SUM(A.hslpemel) as hslpemel, SUM(A.hsllain2) as hsllain2  
        INTO #a FROM[SPDK_KBN_KONSOL].[dbo].[GajiAbsensi] A 
        inner join[SPDK_KBN_KONSOL].[dbo].[ref_areal] B on B.kodekebun + B.kodeafdeling + B.kodeblok = A.kodeunit + A.kodeafd1 + A.kdblok and A.thntnm = B.tahuntanam 
        where A.tanggal >= @tglAwal and A.tanggal <= @tglAkhir and LEN(A.kdblok) = 4 and len(rtrim(A.norek)) = 9 and substring(A.norek, 1, LEN(@KodeRekening)) = @KodeRekening 
        and A.kodeabs = '1' and B.status = 'TM' and len(A.thntnm) = 4 and A.kodebud1=@Budidaya 
        and @Id=substring(A.kodeunit+A.kodeafd1+A.kdblok,1,LEN(@Id))
        group by A.KMK, A.kodeunit, A.kodebud1, A.kodeafd1, A.kdblok, month(A.tanggal), year(A.tanggal), A.kdpanen, A.thntnm, A.regmdr, A.grup,substring(A.norek,1,5)
    
    SELECT A.KMK,A.kodeunit,A.kodebud,A.kodeafd,A.kdblok,month(A.tanggal) as bulan,year(A.tanggal) as tahun, A.thntnm,substring(A.norek,1,5) as norek,
		sum(A.nilai) as nilai, Count(*) as RealisasiJumlahHK, SUM(A.jmlhasil) as jmlhasil 
		INTO #b FROM [SPDK_KBN_KONSOL].[dbo].[GajiKulir] A
        inner join[SPDK_KBN_KONSOL].[dbo].[ref_areal] B on B.kodekebun + B.kodeafdeling + B.kodeblok = A.kodeunit + A.kodeafd + A.kdblok and A.thntnm = B.tahuntanam 
        where A.tanggal >= @tglAwal and A.tanggal <= @tglAkhir and LEN(A.kdblok)=4 and len(rtrim(A.norek))=9 and substring(A.norek,1,LEN(@KodeRekening))=@KodeRekening 
        and len(A.thntnm)=4 and B.status = 'TM' and A.kodebud=@Budidaya 
        and @Id=substring(A.kodeunit+A.kodeafd+A.kdblok,1,LEN(@Id))
        group by A.KMK,A.kodeunit, A.kodebud, A.kodeafd, A.kdblok, month(A.tanggal), year(A.tanggal),A.thntnm, substring(A.norek,1,5)       
        
	SELECT A.KMK,A.kodeunit, A.kodebud, A.kodeafd, A.kdblok, month(A.tanggal) as bulan, year(A.tanggal) as tahun, A.thntnm, substring(A.norek,1,5) as norek,
		sum(A.jmlupah) as jmlupah, sum(A.jmlhadir) as RealisasiJumlahHK, SUM(A.jmlhasil) as jmlhasil 
        INTO #c FROM [SPDK_KBN_KONSOL].[dbo].[GajiSPKHonor] A 
        inner join [SPDK_KBN_KONSOL].[dbo].[ref_areal] B on B.kodekebun + B.kodeafdeling + B.kodeblok = A.kodeunit + A.kodeafd + A.kdblok and A.thntnm = B.tahuntanam 
        where A.tanggal >= @tglAwal and A.tanggal <= @tglAkhir and LEN(A.kdblok)=4 and len(rtrim(A.norek))=9 and substring(A.norek,1,LEN(@KodeRekening))=@KodeRekening 
        and len(A.thntnm)=4  and B.status='TM' and A.kodebud=@Budidaya 
        and @Id=substring(A.kodeunit+A.kodeafd+A.kdblok,1,LEN(@Id))
        group by A.KMK, A.kodeunit, A.kodebud, A.kodeafd, A.kdblok, month(A.tanggal), year(A.tanggal),A.thntnm, substring(A.norek,1,5)

	SELECT A.KMK,A.kodeunit, A.kodebud, A.kodeafd, A.kodeblok, A.thntnm, month(A.tanggal) as bulan, year(A.tanggal) as tahun, substring(A.norek,1,5) as norek,
		sum(A.nilai_RKAP) as RKAPjmlupah, sum(A.nilai_PMK) as PMKjmlupah, 
        sum(A.jmlHK_RKAP) as RKAPJumlahHK, sum(A.jmlHK_PMK) as PMKJumlahHK,
        SUM(A.jmlHsl_RKAP) as RKAPjmlhasil, SUM(A.jmlHsl_PMK) as PMKjmlhasil
        INTO #d FROM [SPDK_KBN_KONSOL].[dbo].[AkunRKAP] A 
        inner join [SPDK_KBN_KONSOL].[dbo].[ref_areal] B on B.kodekebun + B.kodeafdeling + B.kodeblok = A.kodeunit + A.kodeafd + A.kodeblok and A.thntnm = B.tahuntanam 
        where A.tanggal >= @tglAwal and A.tanggal <= @tglAkhir and LEN(A.kodeblok)=4 and len(rtrim(A.norek))=9 and substring(A.norek,1,LEN(@KodeRekening))=@KodeRekening 
        and len(A.thntnm)=4  and B.status='TM' and A.kodebud=@Budidaya 
        and @Id=substring(A.kodeunit+A.kodeafd+A.kodeblok,1,LEN(@Id))
        group by A.KMK, A.kodeunit, A.kodebud, A.kodeafd, A.kodeblok, A.thntnm, month(A.tanggal),year(A.tanggal), substring(A.norek,1,5)

	-- Bulan Ini
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then A.kodeunit 
				when @Layer='Afdeling' then A.kodeunit+A.kodeafd1 
				else A.kodeunit+A.kodeafd1+A.kdblok 
			end,
		TahunTanam = A.thntnm,
		KodeBudidaya = A.kodebud1,
		GroupMesin = A.grup,
		R_KgLateks_BI = cast(case when A.kodebud1='00' and SUBSTRING(A.norek,1,3)='602' then A.hslpanen else 0 end as decimal(18,2)), 
		R_KgLump_BI = cast(case when A.kodebud1='00' and SUBSTRING(A.norek,1,3)='602' then A.hslpanenlump else 0 end as decimal(18,2)), 
		R_KgTBS_BI = cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' and A.kdpanen='1' then A.hslpanen else 0 end as decimal(18,2)),
		R_KgBrondol_BI =  cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' and A.kdpanen='2' then A.hslpanen else 0 end as decimal(18,2)),
		R_JumlahTandan_BI = cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' then A.hslpanenTBS else 0 end as decimal(18,2)),
		R_JumlahPohon_BI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.Jelajah else A.JumlahPohon end as decimal(18,2)),
		R_KgPucuk_BI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.hslPanen else 0 end as decimal(18,2)),
		R_PanenLainnya_BI = cast(case when A.kodebud1!='00' and A.kodebud1!='01' and A.kodebud1!='02' and SUBSTRING(A.norek,1,3)='602' then A.hslPanen else 0 end as decimal(18,2)),
		R_JumlahHK_BI = cast(A.RealisasiJumlahHK as decimal(18,2)),
		R_HaJelajah_BI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.JelajahMesin else A.Jelajah end as decimal(18,2)),
		R_RpGaji_BI = cast(A.jmlupah as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(case when SUBSTRING(A.norek,1,3)='601' then A.hslpemel else 0 end as decimal(18,2)),
		R_HasilLainnya_BI = cast(case when SUBSTRING(A.norek,1,3)!='601' and SUBSTRING(A.norek,1,3)!='602' then A.hsllain2 else 0 end as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = cast(0 as decimal(18,2)), 
		R_KgLump_SBI = cast(0 as decimal(18,2)), 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		R_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = cast(0 as decimal(18,2)),
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_SBI = cast(0 as decimal(18,2)),
		
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)), 
		A_KgBrondol_BI =  cast(0 as decimal(18,2)), 
		A_JumlahTandan_BI = cast(0 as decimal(18,2)), 
		A_JumlahPohon_BI = cast(0 as decimal(18,2)), 
		A_KgPucuk_BI = cast(0 as decimal(18,2)), 
		A_PanenLainnya_BI = cast(0 as decimal(18,2)), 
		A_JumlahHK_BI = cast(0 as decimal(18,2)), 
		A_HaJelajah_BI = cast(0 as decimal(18,2)), 
		A_RpGaji_BI = cast(0 as decimal(18,2)), 
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)), 
		A_HasilLainnya_BI = cast(0 as decimal(18,2)), 
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = cast(0 as decimal(18,2)), 
		A_KgLump_SBI = cast(0 as decimal(18,2)), 
		A_KgTBS_SBI = cast(0 as decimal(18,2)),
		A_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		A_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		A_KgPucuk_SBI = cast(0 as decimal(18,2)),
		A_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		A_JumlahHK_SBI = cast(0 as decimal(18,2)),
		A_HaJelajah_SBI = cast(0 as decimal(18,2)),
		A_RpGaji_SBI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_SBI = cast(0 as decimal(18,2))
		INTO #e FROM #a as A
		WHERE A.bulan=@BulanAkhir and A.tahun=@TahunAkhir and (A.KMK='01' or A.KMK is null)
	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then A.kodeunit 
				when @Layer='Afdeling' then A.kodeunit+A.kodeafd1 
				else A.kodeunit+A.kodeafd1+A.kdblok 
			end,
		TahunTanam = A.thntnm,
		KodeBudidaya = A.kodebud1,
		GroupMesin = A.grup,
		R_KgLateks_BI = 0, 
		R_KgLump_BI = 0, 
		R_KgTBS_BI = 0, 
		R_KgBrondol_BI =  0, 
		R_JumlahTandan_BI = 0, 
		R_JumlahPohon_BI = 0, 
		R_KgPucuk_BI = 0, 
		R_PanenLainnya_BI = 0, 
		R_JumlahHK_BI = 0, 
		R_HaJelajah_BI = 0, 
		R_RpGaji_BI = 0, 
		R_HasilPemeliharaan_BI = 0, 
		R_HasilLainnya_BI = 0, 
		R_RKAPKgLateks_BI = 0, 
		R_RKAPKgTBS_BI = 0, 
		R_RKAPKgPucuk_BI = 0, 
        R_RKAPPanenLainnya_BI = 0, 
        R_RKAPJumlahHK_BI = 0, 
        R_RKAPRpGaji_BI = 0, 
		R_RKAPHasilPemeliharaan_BI = 0, 
		R_RKAPHasilLainnya_BI = 0, 
        R_PKBKgLateks_BI = 0, 
        R_PKBKgTBS_BI = 0, 
        R_PKBKgPucuk_BI = 0, 
        R_PKBPanenLainnya_BI = 0, 
        R_PKBJumlahHK_BI = 0, 
        R_PKBRpGaji_BI = 0, 
		R_PKBHasilPemeliharaan_BI = 0, 
		R_PKBHasilLainnya_BI = 0, 
		R_KgLateks_SBI = 0, 
		R_KgLump_SBI = 0, 
		R_KgTBS_SBI = 0, 
		R_KgBrondol_SBI =  0, 
		R_JumlahTandan_SBI = 0, 
		R_JumlahPohon_SBI = 0, 
		R_KgPucuk_SBI = 0, 
		R_PanenLainnya_SBI = 0, 
		R_JumlahHK_SBI = 0, 
		R_HaJelajah_SBI = 0, 
		R_RpGaji_SBI = 0, 
		R_HasilPemeliharaan_SBI = 0, 
		R_HasilLainnya_SBI = 0, 
		R_RKAPKgLateks_SBI = 0, 
		R_RKAPKgTBS_SBI = 0, 
		R_RKAPKgPucuk_SBI = 0, 
        R_RKAPPanenLainnya_SBI = 0, 
        R_RKAPJumlahHK_SBI = 0, 
        R_RKAPRpGaji_SBI = 0, 
		R_RKAPHasilPemeliharaan_SBI = 0, 
		R_RKAPHasilLainnya_SBI = 0, 
        R_PKBKgLateks_SBI = 0, 
        R_PKBKgTBS_SBI = 0, 
        R_PKBKgPucuk_SBI = 0, 
        R_PKBPanenLainnya_SBI = 0, 
        R_PKBJumlahHK_SBI = 0, 
        R_PKBRpGaji_SBI = 0, 
		R_PKBHasilPemeliharaan_SBI = 0, 
		R_PKBHasilLainnya_SBI = 0, 
		A_KgLateks_BI = cast(case when A.kodebud1='00' and SUBSTRING(A.norek,1,3)='602' then A.hslpanen else 0 end as decimal(18,2)), 
		A_KgLump_BI = cast(case when A.kodebud1='00' and SUBSTRING(A.norek,1,3)='602' then A.hslpanenlump else 0 end as decimal(18,2)), 
		A_KgTBS_BI = cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' and A.kdpanen='1' then A.hslpanen else 0 end as decimal(18,2)),
		A_KgBrondol_BI =  cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' and A.kdpanen='2' then A.hslpanen else 0 end as decimal(18,2)),
		A_JumlahTandan_BI = cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' then A.hslpanenTBS else 0 end as decimal(18,2)),
		A_JumlahPohon_BI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.Jelajah else A.JumlahPohon end as decimal(18,2)),
		A_KgPucuk_BI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.hslPanen else 0 end as decimal(18,2)),
		A_PanenLainnya_BI = cast(case when A.kodebud1!='00' and A.kodebud1!='01' and A.kodebud1!='02' and SUBSTRING(A.norek,1,3)='602' then A.hslPanen else 0 end as decimal(18,2)),
		A_JumlahHK_BI = cast(A.RealisasiJumlahHK as decimal(18,2)),
		A_HaJelajah_BI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.JelajahMesin else A.Jelajah end as decimal(18,2)),
		A_RpGaji_BI = cast(A.jmlupah as decimal(18,2)),
		A_HasilPemeliharaan_BI = cast(case when SUBSTRING(A.norek,1,3)='601' then A.hslpemel else 0 end as decimal(18,2)),
		A_HasilLainnya_BI = cast(case when SUBSTRING(A.norek,1,3)!='601' and SUBSTRING(A.norek,1,3)!='602' then A.hsllain2 else 0 end as decimal(18,2)),
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = cast(0 as decimal(18,2)), 
		A_KgLump_SBI = cast(0 as decimal(18,2)), 
		A_KgTBS_SBI = cast(0 as decimal(18,2)),
		A_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		A_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		A_KgPucuk_SBI = cast(0 as decimal(18,2)),
		A_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		A_JumlahHK_SBI = cast(0 as decimal(18,2)),
		A_HaJelajah_SBI = cast(0 as decimal(18,2)),
		A_RpGaji_SBI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_SBI = cast(0 as decimal(18,2))



		FROM #a as A
		WHERE A.bulan=@BulanAkhir and A.tahun=@TahunAkhir and A.KMK='02'
		
	-- sd Bulan Ini
	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then A.kodeunit 
				when @Layer='Afdeling' then A.kodeunit+A.kodeafd1 
				else A.kodeunit+A.kodeafd1+A.kdblok 
			end,
		TahunTanam = A.thntnm,
		KodeBudidaya = A.kodebud1,
		GroupMesin = A.grup,
		
		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)),
		R_KgBrondol_BI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_BI = cast(0 as decimal(18,2)),
		R_JumlahPohon_BI = cast(0 as decimal(18,2)),
		R_KgPucuk_BI = cast(0 as decimal(18,2)),
		R_PanenLainnya_BI = cast(0 as decimal(18,2)),
		R_JumlahHK_BI = cast(0 as decimal(18,2)),
		R_HaJelajah_BI = cast(0 as decimal(18,2)),
		R_RpGaji_BI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_HasilLainnya_BI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = cast(case when A.kodebud1='00' and SUBSTRING(A.norek,1,3)='602' then A.hslpanen else 0 end as decimal(18,2)), 
		R_KgLump_SBI = cast(case when A.kodebud1='00' and SUBSTRING(A.norek,1,3)='602' then A.hslpanenlump else 0 end as decimal(18,2)), 
		R_KgTBS_SBI = cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' and A.kdpanen='1' then A.hslpanen else 0 end as decimal(18,2)),
		R_KgBrondol_SBI =  cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' and A.kdpanen='2' then A.hslpanen else 0 end as decimal(18,2)),
		R_JumlahTandan_SBI = cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' then A.hslpanenTBS else 0 end as decimal(18,2)),
		R_JumlahPohon_SBI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.Jelajah else A.JumlahPohon end as decimal(18,2)),
		R_KgPucuk_SBI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.hslPanen else 0 end as decimal(18,2)),
		R_PanenLainnya_SBI = cast(case when A.kodebud1!='00' and A.kodebud1!='01' and A.kodebud1!='02' and SUBSTRING(A.norek,1,3)='602' then A.hslPanen else 0 end as decimal(18,2)),
		R_JumlahHK_SBI = cast(A.RealisasiJumlahHK as decimal(18,2)),
		R_HaJelajah_SBI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.JelajahMesin else A.Jelajah end as decimal(18,2)),
		R_RpGaji_SBI = cast(A.jmlupah as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(case when SUBSTRING(A.norek,1,3)='601' then A.hslpemel else 0 end as decimal(18,2)),
		R_HasilLainnya_SBI = cast(case when SUBSTRING(A.norek,1,3)!='601' and SUBSTRING(A.norek,1,3)!='602' then A.hsllain2 else 0 end as decimal(18,2)),
		R_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)), 
		A_KgBrondol_BI =  cast(0 as decimal(18,2)), 
		A_JumlahTandan_BI = cast(0 as decimal(18,2)), 
		A_JumlahPohon_BI = cast(0 as decimal(18,2)), 
		A_KgPucuk_BI = cast(0 as decimal(18,2)), 
		A_PanenLainnya_BI = cast(0 as decimal(18,2)), 
		A_JumlahHK_BI = cast(0 as decimal(18,2)), 
		A_HaJelajah_BI = cast(0 as decimal(18,2)), 
		A_RpGaji_BI = cast(0 as decimal(18,2)), 
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)), 
		A_HasilLainnya_BI = cast(0 as decimal(18,2)), 
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = cast(0 as decimal(18,2)), 
		A_KgLump_SBI = cast(0 as decimal(18,2)), 
		A_KgTBS_SBI = cast(0 as decimal(18,2)),
		A_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		A_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		A_KgPucuk_SBI = cast(0 as decimal(18,2)),
		A_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		A_JumlahHK_SBI = cast(0 as decimal(18,2)),
		A_HaJelajah_SBI = cast(0 as decimal(18,2)),
		A_RpGaji_SBI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_SBI = cast(0 as decimal(18,2))
		FROM #a as A
		where A.KMK='01' or A.KMK is null

	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then A.kodeunit 
				when @Layer='Afdeling' then A.kodeunit+A.kodeafd1 
				else A.kodeunit+A.kodeafd1+A.kdblok 
			end,
		TahunTanam = A.thntnm,
		KodeBudidaya = A.kodebud1,
		GroupMesin = A.grup,
		
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)),
		A_KgBrondol_BI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_BI = cast(0 as decimal(18,2)),
		A_JumlahPohon_BI = cast(0 as decimal(18,2)),
		A_KgPucuk_BI = cast(0 as decimal(18,2)),
		A_PanenLainnya_BI = cast(0 as decimal(18,2)),
		A_JumlahHK_BI = cast(0 as decimal(18,2)),
		A_HaJelajah_BI = cast(0 as decimal(18,2)),
		A_RpGaji_BI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_HasilLainnya_BI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = cast(case when A.kodebud1='00' and SUBSTRING(A.norek,1,3)='602' then A.hslpanen else 0 end as decimal(18,2)), 
		A_KgLump_SBI = cast(case when A.kodebud1='00' and SUBSTRING(A.norek,1,3)='602' then A.hslpanenlump else 0 end as decimal(18,2)), 
		A_KgTBS_SBI = cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' and A.kdpanen='1' then A.hslpanen else 0 end as decimal(18,2)),
		A_KgBrondol_SBI =  cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' and A.kdpanen='2' then A.hslpanen else 0 end as decimal(18,2)),
		A_JumlahTandan_SBI = cast(case when A.kodebud1='01' and SUBSTRING(A.norek,1,3)='602' then A.hslpanenTBS else 0 end as decimal(18,2)),
		A_JumlahPohon_SBI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.Jelajah else A.JumlahPohon end as decimal(18,2)),
		A_KgPucuk_SBI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.hslPanen else 0 end as decimal(18,2)),
		A_PanenLainnya_SBI = cast(case when A.kodebud1!='00' and A.kodebud1!='01' and A.kodebud1!='02' and SUBSTRING(A.norek,1,3)='602' then A.hslPanen else 0 end as decimal(18,2)),
		A_JumlahHK_SBI = cast(A.RealisasiJumlahHK as decimal(18,2)),
		A_HaJelajah_SBI = cast(case when A.kodebud1='02' and SUBSTRING(A.norek,1,3)='602' then A.JelajahMesin else A.Jelajah end as decimal(18,2)),
		A_RpGaji_SBI = cast(A.jmlupah as decimal(18,2)),
		A_HasilPemeliharaan_SBI = cast(case when SUBSTRING(A.norek,1,3)='601' then A.hslpemel else 0 end as decimal(18,2)),
		A_HasilLainnya_SBI = cast(case when SUBSTRING(A.norek,1,3)!='601' and SUBSTRING(A.norek,1,3)!='602' then A.hsllain2 else 0 end as decimal(18,2)),
		A_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_SBI = cast(0 as decimal(18,2)),
		
		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)), 
		R_KgBrondol_BI =  cast(0 as decimal(18,2)), 
		R_JumlahTandan_BI = cast(0 as decimal(18,2)), 
		R_JumlahPohon_BI = cast(0 as decimal(18,2)), 
		R_KgPucuk_BI = cast(0 as decimal(18,2)), 
		R_PanenLainnya_BI = cast(0 as decimal(18,2)), 
		R_JumlahHK_BI = cast(0 as decimal(18,2)), 
		R_HaJelajah_BI = cast(0 as decimal(18,2)), 
		R_RpGaji_BI = cast(0 as decimal(18,2)), 
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)), 
		R_HasilLainnya_BI = cast(0 as decimal(18,2)), 
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = cast(0 as decimal(18,2)), 
		R_KgLump_SBI = cast(0 as decimal(18,2)), 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		R_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = cast(0 as decimal(18,2)),
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_SBI = cast(0 as decimal(18,2))
		
		FROM #a as A
		where A.KMK='02' 



	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then B.kodeunit 
				when @Layer='Afdeling' then B.kodeunit+B.kodeafd 
				else B.kodeunit+B.kodeafd+B.kdblok 
			end,
		TahunTanam = B.thntnm,
		KodeBudidaya = B.kodebud,
		GroupMesin = '',
		R_KgLateks_BI = case when B.kodebud='00' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end, 
		R_KgLump_BI = 0, 
		R_KgTBS_BI = case when B.kodebud='01' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		R_KgBrondol_BI =  0,
		R_JumlahTandan_BI = 0,
		R_JumlahPohon_BI = 0,
		R_KgPucuk_BI = case when B.kodebud='02' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		R_PanenLainnya_BI = case when B.kodebud!='00' and B.kodebud!='01' and B.kodebud!='02' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		R_JumlahHK_BI = B.RealisasiJumlahHK,
		R_HaJelajah_BI = 0,
		R_RpGaji_BI = B.nilai,
		R_HasilPemeliharaan_BI = case when SUBSTRING(B.norek,1,3)='601' then B.jmlhasil else 0 end,
		R_HasilLainnya_BI = case when SUBSTRING(B.norek,1,3)!='601' and SUBSTRING(B.norek,1,3)!='602' then B.jmlhasil else 0 end,
		R_RKAPKgLateks_BI = 0,
		R_RKAPKgTBS_BI = 0,
		R_RKAPKgPucuk_BI = 0,
        R_RKAPPanenLainnya_BI = 0,
        R_RKAPJumlahHK_BI = 0, 
        R_RKAPRpGaji_BI = 0, 
		R_RKAPHasilPemeliharaan_BI = 0,
		R_RKAPHasilLainnya_BI = 0,
        R_PKBKgLateks_BI = 0, 
        R_PKBKgTBS_BI = 0,
        R_PKBKgPucuk_BI = 0,
        R_PKBPanenLainnya_BI = 0,
        R_PKBJumlahHK_BI = 0, 
        R_PKBRpGaji_BI = 0,
		R_PKBHasilPemeliharaan_BI = 0,
		R_PKBHasilLainnya_BI = 0,
		R_KgLateks_SBI = cast(0 as decimal(18,2)), 
		R_KgLump_SBI = cast(0 as decimal(18,2)), 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		R_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = cast(0 as decimal(18,2)),
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)), 
		A_KgBrondol_BI =  cast(0 as decimal(18,2)), 
		A_JumlahTandan_BI = cast(0 as decimal(18,2)), 
		A_JumlahPohon_BI = cast(0 as decimal(18,2)), 
		A_KgPucuk_BI = cast(0 as decimal(18,2)), 
		A_PanenLainnya_BI = cast(0 as decimal(18,2)), 
		A_JumlahHK_BI = cast(0 as decimal(18,2)), 
		A_HaJelajah_BI = cast(0 as decimal(18,2)), 
		A_RpGaji_BI = cast(0 as decimal(18,2)), 
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)), 
		A_HasilLainnya_BI = cast(0 as decimal(18,2)), 
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = cast(0 as decimal(18,2)), 
		A_KgLump_SBI = cast(0 as decimal(18,2)), 
		A_KgTBS_SBI = cast(0 as decimal(18,2)),
		A_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		A_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		A_KgPucuk_SBI = cast(0 as decimal(18,2)),
		A_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		A_JumlahHK_SBI = cast(0 as decimal(18,2)),
		A_HaJelajah_SBI = cast(0 as decimal(18,2)),
		A_RpGaji_SBI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_SBI = cast(0 as decimal(18,2))
		FROM #b as B
		WHERE B.bulan=@BulanAkhir and b.tahun=@TahunAkhir and (B.KMK='01' or B.KMK is null)

	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then B.kodeunit 
				when @Layer='Afdeling' then B.kodeunit+B.kodeafd 
				else B.kodeunit+B.kodeafd+B.kdblok 
			end,
		TahunTanam = B.thntnm,
		KodeBudidaya = B.kodebud,
		GroupMesin = '',
		A_KgLateks_BI = case when B.kodebud='00' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end, 
		A_KgLump_BI = 0, 
		A_KgTBS_BI = case when B.kodebud='01' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		A_KgBrondol_BI =  0,
		A_JumlahTandan_BI = 0,
		A_JumlahPohon_BI = 0,
		A_KgPucuk_BI = case when B.kodebud='02' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		A_PanenLainnya_BI = case when B.kodebud!='00' and B.kodebud!='01' and B.kodebud!='02' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		A_JumlahHK_BI = B.RealisasiJumlahHK,
		A_HaJelajah_BI = 0,
		A_RpGaji_BI = B.nilai,
		A_HasilPemeliharaan_BI = case when SUBSTRING(B.norek,1,3)='601' then B.jmlhasil else 0 end,
		A_HasilLainnya_BI = case when SUBSTRING(B.norek,1,3)!='601' and SUBSTRING(B.norek,1,3)!='602' then B.jmlhasil else 0 end,
		A_RKAPKgLateks_BI = 0,
		A_RKAPKgTBS_BI = 0,
		A_RKAPKgPucuk_BI = 0,
        A_RKAPPanenLainnya_BI = 0,
        A_RKAPJumlahHK_BI = 0, 
        A_RKAPRpGaji_BI = 0, 
		A_RKAPHasilPemeliharaan_BI = 0,
		A_RKAPHasilLainnya_BI = 0,
        A_PKBKgLateks_BI = 0, 
        A_PKBKgTBS_BI = 0,
        A_PKBKgPucuk_BI = 0,
        A_PKBPanenLainnya_BI = 0,
        A_PKBJumlahHK_BI = 0, 
        A_PKBRpGaji_BI = 0,
		A_PKBHasilPemeliharaan_BI = 0,
		A_PKBHasilLainnya_BI = 0,
		A_KgLateks_SBI = cast(0 as decimal(18,2)), 
		A_KgLump_SBI = cast(0 as decimal(18,2)), 
		A_KgTBS_SBI = cast(0 as decimal(18,2)),
		A_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		A_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		A_KgPucuk_SBI = cast(0 as decimal(18,2)),
		A_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		A_JumlahHK_SBI = cast(0 as decimal(18,2)),
		A_HaJelajah_SBI = cast(0 as decimal(18,2)),
		A_RpGaji_SBI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)), 
		R_KgBrondol_BI =  cast(0 as decimal(18,2)), 
		R_JumlahTandan_BI = cast(0 as decimal(18,2)), 
		R_JumlahPohon_BI = cast(0 as decimal(18,2)), 
		R_KgPucuk_BI = cast(0 as decimal(18,2)), 
		R_PanenLainnya_BI = cast(0 as decimal(18,2)), 
		R_JumlahHK_BI = cast(0 as decimal(18,2)), 
		R_HaJelajah_BI = cast(0 as decimal(18,2)), 
		R_RpGaji_BI = cast(0 as decimal(18,2)), 
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)), 
		R_HasilLainnya_BI = cast(0 as decimal(18,2)), 
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = cast(0 as decimal(18,2)), 
		R_KgLump_SBI = cast(0 as decimal(18,2)), 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		R_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = cast(0 as decimal(18,2)),
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_SBI = cast(0 as decimal(18,2))
		FROM #b as B
		WHERE B.bulan=@BulanAkhir and b.tahun=@TahunAkhir and (B.KMK='02')


	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then B.kodeunit 
				when @Layer='Afdeling' then B.kodeunit+B.kodeafd 
				else B.kodeunit+B.kodeafd+B.kdblok 
			end,
		TahunTanam = B.thntnm,
		KodeBudidaya = B.kodebud,
		GroupMesin = '',
		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)),
		R_KgBrondol_BI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_BI = cast(0 as decimal(18,2)),
		R_JumlahPohon_BI = cast(0 as decimal(18,2)),
		R_KgPucuk_BI = cast(0 as decimal(18,2)),
		R_PanenLainnya_BI = cast(0 as decimal(18,2)),
		R_JumlahHK_BI = cast(0 as decimal(18,2)),
		R_HaJelajah_BI = cast(0 as decimal(18,2)),
		R_RpGaji_BI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_HasilLainnya_BI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = case when B.kodebud='00' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end, 
		R_KgLump_SBI = 0, 
		R_KgTBS_SBI = case when B.kodebud='01' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		R_KgBrondol_SBI =  0,
		R_JumlahTandan_SBI = 0,
		R_JumlahPohon_SBI = 0,
		R_KgPucuk_SBI = case when B.kodebud='02' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		R_PanenLainnya_SBI = case when B.kodebud!='00' and B.kodebud!='01' and B.kodebud!='02' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		R_JumlahHK_SBI = B.RealisasiJumlahHK,
		R_HaJelajah_SBI = 0,
		R_RpGaji_SBI = B.nilai,
		R_HasilPemeliharaan_SBI = case when SUBSTRING(B.norek,1,3)='601' then B.jmlhasil else 0 end,
		R_HasilLainnya_SBI = case when SUBSTRING(B.norek,1,3)!='601' and SUBSTRING(B.norek,1,3)!='602' then B.jmlhasil else 0 end,
		R_RKAPKgLateks_SBI = 0,
		R_RKAPKgTBS_SBI = 0,
		R_RKAPKgPucuk_SBI = 0,
        R_RKAPPanenLainnya_SBI = 0,
        R_RKAPJumlahHK_SBI = 0, 
        R_RKAPRpGaji_SBI = 0, 
		R_RKAPHasilPemeliharaan_SBI = 0,
		R_RKAPHasilLainnya_SBI = 0,
        R_PKBKgLateks_SBI = 0, 
        R_PKBKgTBS_SBI = 0,
        R_PKBKgPucuk_SBI = 0,
        R_PKBPanenLainnya_SBI = 0,
        R_PKBJumlahHK_SBI = 0, 
        R_PKBRpGaji_SBI = 0,
		R_PKBHasilPemeliharaan_SBI = 0,
		R_PKBHasilLainnya_SBI = 0,
		
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)), 
		A_KgBrondol_BI =  cast(0 as decimal(18,2)), 
		A_JumlahTandan_BI = cast(0 as decimal(18,2)), 
		A_JumlahPohon_BI = cast(0 as decimal(18,2)), 
		A_KgPucuk_BI = cast(0 as decimal(18,2)), 
		A_PanenLainnya_BI = cast(0 as decimal(18,2)), 
		A_JumlahHK_BI = cast(0 as decimal(18,2)), 
		A_HaJelajah_BI = cast(0 as decimal(18,2)), 
		A_RpGaji_BI = cast(0 as decimal(18,2)), 
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)), 
		A_HasilLainnya_BI = cast(0 as decimal(18,2)), 
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = cast(0 as decimal(18,2)), 
		A_KgLump_SBI = cast(0 as decimal(18,2)), 
		A_KgTBS_SBI = cast(0 as decimal(18,2)),
		A_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		A_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		A_KgPucuk_SBI = cast(0 as decimal(18,2)),
		A_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		A_JumlahHK_SBI = cast(0 as decimal(18,2)),
		A_HaJelajah_SBI = cast(0 as decimal(18,2)),
		A_RpGaji_SBI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_SBI = cast(0 as decimal(18,2))
		FROM #b as B
		where B.KMK='01' or B.KMK is null

	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then B.kodeunit 
				when @Layer='Afdeling' then B.kodeunit+B.kodeafd 
				else B.kodeunit+B.kodeafd+B.kdblok 
			end,
		TahunTanam = B.thntnm,
		KodeBudidaya = B.kodebud,
		GroupMesin = '',

		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)),
		R_KgBrondol_BI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_BI = cast(0 as decimal(18,2)),
		R_JumlahPohon_BI = cast(0 as decimal(18,2)),
		R_KgPucuk_BI = cast(0 as decimal(18,2)),
		R_PanenLainnya_BI = cast(0 as decimal(18,2)),
		R_JumlahHK_BI = cast(0 as decimal(18,2)),
		R_HaJelajah_BI = cast(0 as decimal(18,2)),
		R_RpGaji_BI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_HasilLainnya_BI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = cast(0 as decimal(18,2)),
		R_KgLump_SBI = 0, 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  0,
		R_JumlahTandan_SBI = 0,
		R_JumlahPohon_SBI = 0,
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = 0,
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = 0,
		R_RKAPKgTBS_SBI = 0,
		R_RKAPKgPucuk_SBI = 0,
        R_RKAPPanenLainnya_SBI = 0,
        R_RKAPJumlahHK_SBI = 0, 
        R_RKAPRpGaji_SBI = 0, 
		R_RKAPHasilPemeliharaan_SBI = 0,
		R_RKAPHasilLainnya_SBI = 0,
        R_PKBKgLateks_SBI = 0, 
        R_PKBKgTBS_SBI = 0,
        R_PKBKgPucuk_SBI = 0,
        R_PKBPanenLainnya_SBI = 0,
        R_PKBJumlahHK_SBI = 0, 
        R_PKBRpGaji_SBI = 0,
		R_PKBHasilPemeliharaan_SBI = 0,
		R_PKBHasilLainnya_SBI = 0,
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)),
		A_KgBrondol_BI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_BI = cast(0 as decimal(18,2)),
		A_JumlahPohon_BI = cast(0 as decimal(18,2)),
		A_KgPucuk_BI = cast(0 as decimal(18,2)),
		A_PanenLainnya_BI = cast(0 as decimal(18,2)),
		A_JumlahHK_BI = cast(0 as decimal(18,2)),
		A_HaJelajah_BI = cast(0 as decimal(18,2)),
		A_RpGaji_BI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_HasilLainnya_BI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = case when B.kodebud='00' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end, 
		A_KgLump_SBI = 0, 
		A_KgTBS_SBI = case when B.kodebud='01' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		A_KgBrondol_SBI =  0,
		A_JumlahTandan_SBI = 0,
		A_JumlahPohon_SBI = 0,
		A_KgPucuk_SBI = case when B.kodebud='02' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		A_PanenLainnya_SBI = case when B.kodebud!='00' and B.kodebud!='01' and B.kodebud!='02' and SUBSTRING(B.norek,1,3)='602' then B.jmlhasil else 0 end,
		A_JumlahHK_SBI = B.RealisasiJumlahHK,
		A_HaJelajah_SBI = 0,
		A_RpGaji_SBI = B.nilai,
		A_HasilPemeliharaan_SBI = case when SUBSTRING(B.norek,1,3)='601' then B.jmlhasil else 0 end,
		A_HasilLainnya_SBI = case when SUBSTRING(B.norek,1,3)!='601' and SUBSTRING(B.norek,1,3)!='602' then B.jmlhasil else 0 end,
		A_RKAPKgLateks_SBI = 0,
		A_RKAPKgTBS_SBI = 0,
		A_RKAPKgPucuk_SBI = 0,
        A_RKAPPanenLainnya_SBI = 0,
        A_RKAPJumlahHK_SBI = 0, 
        A_RKAPRpGaji_SBI = 0, 
		A_RKAPHasilPemeliharaan_SBI = 0,
		A_RKAPHasilLainnya_SBI = 0,
        A_PKBKgLateks_SBI = 0, 
        A_PKBKgTBS_SBI = 0,
        A_PKBKgPucuk_SBI = 0,
        A_PKBPanenLainnya_SBI = 0,
        A_PKBJumlahHK_SBI = 0, 
        A_PKBRpGaji_SBI = 0,
		A_PKBHasilPemeliharaan_SBI = 0,
		A_PKBHasilLainnya_SBI = 0
		FROM #b as B
		where B.KMK='02'

	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then C.kodeunit 
				when @Layer='Afdeling' then C.kodeunit+C.kodeafd 
				else C.kodeunit+C.kodeafd+C.kdblok 
			end,
		TahunTanam = C.thntnm,
		KodeBudidaya = C.kodebud,
		GroupMesin = '',
		R_KgLateks_BI = case when C.kodebud='00' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end, 
		R_KgLump_BI = 0, 
		R_KgTBS_BI = case when C.kodebud='01' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		R_KgBrondol_BI =  0,
		R_JumlahTandan_BI = 0,
		R_JumlahPohon_BI = 0,
		R_KgPucuk_BI = case when C.kodebud='02' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		R_PanenLainnya_BI = case when C.kodebud!='00' and C.kodebud!='01' and C.kodebud!='02' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		R_JumlahHK_BI = C.RealisasiJumlahHK,
		R_HaJelajah_BI = 0,
		R_RpGaji_BI = C.jmlupah,
		R_HasilPemeliharaan_BI = case when SUBSTRING(C.norek,1,3)='601' then C.jmlhasil else 0 end,
		R_HasilLainnya_BI = case when SUBSTRING(C.norek,1,3)!='601' and SUBSTRING(C.norek,1,3)!='602' then C.jmlhasil else 0 end,
		R_RKAPKgLateks_BI = 0,
		R_RKAPKgTBS_BI = 0,
		R_RKAPKgPucuk_BI = 0,
        R_RKAPPanenLainnya_BI = 0,
        R_RKAPJumlahHK_BI = 0, 
        R_RKAPRpGaji_BI = 0, 
        R_RKAPHasilPemeliharaan_BI = 0,
		R_RKAPHasilLainnya_BI = 0,
        R_PKBKgLateks_BI = 0, 
        R_PKBKgTBS_BI = 0,
        R_PKBKgPucuk_BI = 0,
        R_PKBPanenLainnya_BI = 0,
        R_PKBJumlahHK_BI = 0, 
        R_PKBRpGaji_BI = 0,
		R_PKBHasilPemeliharaan_BI = 0,
		R_PKBHasilLainnya_BI = 0,
		R_KgLateks_SBI = cast(0 as decimal(18,2)), 
		R_KgLump_SBI = cast(0 as decimal(18,2)), 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		R_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = cast(0 as decimal(18,2)),
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)),
		A_KgBrondol_BI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_BI = cast(0 as decimal(18,2)),
		A_JumlahPohon_BI = cast(0 as decimal(18,2)),
		A_KgPucuk_BI = cast(0 as decimal(18,2)),
		A_PanenLainnya_BI = cast(0 as decimal(18,2)),
		A_JumlahHK_BI = cast(0 as decimal(18,2)),
		A_HaJelajah_BI = cast(0 as decimal(18,2)),
		A_RpGaji_BI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_HasilLainnya_BI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = 0, 
		A_KgLump_SBI = 0, 
		A_KgTBS_SBI = 0,
		A_KgBrondol_SBI =  0,
		A_JumlahTandan_SBI = 0,
		A_JumlahPohon_SBI = 0,
		A_KgPucuk_SBI = 0,
		A_PanenLainnya_SBI = 0,
		A_JumlahHK_SBI = 0,
		A_HaJelajah_SBI = 0,
		A_RpGaji_SBI = 0,
		A_HasilPemeliharaan_SBI = 0,
		A_HasilLainnya_SBI = 0,
		A_RKAPKgLateks_SBI = 0,
		A_RKAPKgTBS_SBI = 0,
		A_RKAPKgPucuk_SBI = 0,
        A_RKAPPanenLainnya_SBI = 0,
        A_RKAPJumlahHK_SBI = 0, 
        A_RKAPRpGaji_SBI = 0, 
		A_RKAPHasilPemeliharaan_SBI = 0,
		A_RKAPHasilLainnya_SBI = 0,
        A_PKBKgLateks_SBI = 0, 
        A_PKBKgTBS_SBI = 0,
        A_PKBKgPucuk_SBI = 0,
        A_PKBPanenLainnya_SBI = 0,
        A_PKBJumlahHK_SBI = 0, 
        A_PKBRpGaji_SBI = 0,
		A_PKBHasilPemeliharaan_SBI = 0,
		A_PKBHasilLainnya_SBI = 0
		FROM #c as C	  
		WHERE C.bulan=@BulanAkhir and C.tahun=@TahunAkhir and (C.KMK='01' or C.KMK is null)    
		

	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then C.kodeunit 
				when @Layer='Afdeling' then C.kodeunit+C.kodeafd 
				else C.kodeunit+C.kodeafd+C.kdblok 
			end,
		TahunTanam = C.thntnm,
		KodeBudidaya = C.kodebud,
		GroupMesin = '',

		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)),
		R_KgBrondol_BI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_BI = cast(0 as decimal(18,2)),
		R_JumlahPohon_BI = cast(0 as decimal(18,2)),
		R_KgPucuk_BI = cast(0 as decimal(18,2)),
		R_PanenLainnya_BI = cast(0 as decimal(18,2)),
		R_JumlahHK_BI = cast(0 as decimal(18,2)),
		R_HaJelajah_BI = cast(0 as decimal(18,2)),
		R_RpGaji_BI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_HasilLainnya_BI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = cast(0 as decimal(18,2)),
		R_KgLump_SBI = 0, 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  0,
		R_JumlahTandan_SBI = 0,
		R_JumlahPohon_SBI = 0,
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = 0,
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = 0,
		R_RKAPKgTBS_SBI = 0,
		R_RKAPKgPucuk_SBI = 0,
        R_RKAPPanenLainnya_SBI = 0,
        R_RKAPJumlahHK_SBI = 0, 
        R_RKAPRpGaji_SBI = 0, 
		R_RKAPHasilPemeliharaan_SBI = 0,
		R_RKAPHasilLainnya_SBI = 0,
        R_PKBKgLateks_SBI = 0, 
        R_PKBKgTBS_SBI = 0,
        R_PKBKgPucuk_SBI = 0,
        R_PKBPanenLainnya_SBI = 0,
        R_PKBJumlahHK_SBI = 0, 
        R_PKBRpGaji_SBI = 0,
		R_PKBHasilPemeliharaan_SBI = 0,
		R_PKBHasilLainnya_SBI = 0,

		A_KgLateks_BI = case when C.kodebud='00' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end, 
		A_KgLump_BI = 0, 
		A_KgTBS_BI = case when C.kodebud='01' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		A_KgBrondol_BI =  0,
		A_JumlahTandan_BI = 0,
		A_JumlahPohon_BI = 0,
		A_KgPucuk_BI = case when C.kodebud='02' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		A_PanenLainnya_BI = case when C.kodebud!='00' and C.kodebud!='01' and C.kodebud!='02' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		A_JumlahHK_BI = C.RealisasiJumlahHK,
		A_HaJelajah_BI = 0,
		A_RpGaji_BI = C.jmlupah,
		A_HasilPemeliharaan_BI = case when SUBSTRING(C.norek,1,3)='601' then C.jmlhasil else 0 end,
		A_HasilLainnya_BI = case when SUBSTRING(C.norek,1,3)!='601' and SUBSTRING(C.norek,1,3)!='602' then C.jmlhasil else 0 end,
		A_RKAPKgLateks_BI = 0,
		A_RKAPKgTBS_BI = 0,
		A_RKAPKgPucuk_BI = 0,
        A_RKAPPanenLainnya_BI = 0,
        A_RKAPJumlahHK_BI = 0, 
        A_RKAPRpGaji_BI = 0, 
        A_RKAPHasilPemeliharaan_BI = 0,
		A_RKAPHasilLainnya_BI = 0,
        A_PKBKgLateks_BI = 0, 
        A_PKBKgTBS_BI = 0,
        A_PKBKgPucuk_BI = 0,
        A_PKBPanenLainnya_BI = 0,
        A_PKBJumlahHK_BI = 0, 
        A_PKBRpGaji_BI = 0,
		A_PKBHasilPemeliharaan_BI = 0,
		A_PKBHasilLainnya_BI = 0,
		A_KgLateks_SBI = cast(0 as decimal(18,2)), 
		A_KgLump_SBI = cast(0 as decimal(18,2)), 
		A_KgTBS_SBI = cast(0 as decimal(18,2)),
		A_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		A_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		A_KgPucuk_SBI = cast(0 as decimal(18,2)),
		A_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		A_JumlahHK_SBI = cast(0 as decimal(18,2)),
		A_HaJelajah_SBI = cast(0 as decimal(18,2)),
		A_RpGaji_SBI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_SBI = cast(0 as decimal(18,2))
		FROM #c as C	  
		WHERE C.bulan=@BulanAkhir and C.tahun=@TahunAkhir and C.KMK='02' 
		

	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then C.kodeunit 
				when @Layer='Afdeling' then C.kodeunit+C.kodeafd 
				else C.kodeunit+C.kodeafd+C.kdblok 
			end,
		TahunTanam = C.thntnm,
		KodeBudidaya = C.kodebud,
		GroupMesin = '',
		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)),
		R_KgBrondol_BI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_BI = cast(0 as decimal(18,2)),
		R_JumlahPohon_BI = cast(0 as decimal(18,2)),
		R_KgPucuk_BI = cast(0 as decimal(18,2)),
		R_PanenLainnya_BI = cast(0 as decimal(18,2)),
		R_JumlahHK_BI = cast(0 as decimal(18,2)),
		R_HaJelajah_BI = cast(0 as decimal(18,2)),
		R_RpGaji_BI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_HasilLainnya_BI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = case when C.kodebud='00' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end, 
		R_KgLump_SBI = 0, 
		R_KgTBS_SBI = case when C.kodebud='01' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		R_KgBrondol_SBI =  0,
		R_JumlahTandan_SBI = 0,
		R_JumlahPohon_SBI = 0,
		R_KgPucuk_SBI = case when C.kodebud='02' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		R_PanenLainnya_SBI = case when C.kodebud!='00' and C.kodebud!='01' and C.kodebud!='02' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		R_JumlahHK_SBI = C.RealisasiJumlahHK,
		R_HaJelajah_SBI = 0,
		R_RpGaji_SBI = C.jmlupah,
		R_HasilPemeliharaan_SBI = case when SUBSTRING(C.norek,1,3)='601' then C.jmlhasil else 0 end,
		R_HasilLainnya_SBI = case when SUBSTRING(C.norek,1,3)!='601' and SUBSTRING(C.norek,1,3)!='602' then C.jmlhasil else 0 end,
		R_RKAPKgLateks_SBI = 0,
		R_RKAPKgTBS_SBI = 0,
		R_RKAPKgPucuk_SBI = 0,
        R_RKAPPanenLainnya_SBI = 0,
        R_RKAPJumlahHK_SBI = 0, 
        R_RKAPRpGaji_SBI = 0, 
        R_RKAPHasilPemeliharaan_SBI = 0,
		R_RKAPHasilLainnya_SBI = 0,
        R_PKBKgLateks_SBI = 0, 
        R_PKBKgTBS_SBI = 0,
        R_PKBKgPucuk_SBI = 0,
        R_PKBPanenLainnya_SBI = 0,
        R_PKBJumlahHK_SBI = 0, 
        R_PKBRpGaji_SBI = 0,
		R_PKBHasilPemeliharaan_SBI = 0,
		R_PKBHasilLainnya_SBI = 0,
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)),
		A_KgBrondol_BI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_BI = cast(0 as decimal(18,2)),
		A_JumlahPohon_BI = cast(0 as decimal(18,2)),
		A_KgPucuk_BI = cast(0 as decimal(18,2)),
		A_PanenLainnya_BI = cast(0 as decimal(18,2)),
		A_JumlahHK_BI = cast(0 as decimal(18,2)),
		A_HaJelajah_BI = cast(0 as decimal(18,2)),
		A_RpGaji_BI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_HasilLainnya_BI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = 0, 
		A_KgLump_SBI = 0, 
		A_KgTBS_SBI = 0,
		A_KgBrondol_SBI =  0,
		A_JumlahTandan_SBI = 0,
		A_JumlahPohon_SBI = 0,
		A_KgPucuk_SBI = 0,
		A_PanenLainnya_SBI = 0,
		A_JumlahHK_SBI = 0,
		A_HaJelajah_SBI = 0,
		A_RpGaji_SBI = 0,
		A_HasilPemeliharaan_SBI = 0,
		A_HasilLainnya_SBI = 0,
		A_RKAPKgLateks_SBI = 0,
		A_RKAPKgTBS_SBI = 0,
		A_RKAPKgPucuk_SBI = 0,
        A_RKAPPanenLainnya_SBI = 0,
        A_RKAPJumlahHK_SBI = 0, 
        A_RKAPRpGaji_SBI = 0, 
		A_RKAPHasilPemeliharaan_SBI = 0,
		A_RKAPHasilLainnya_SBI = 0,
        A_PKBKgLateks_SBI = 0, 
        A_PKBKgTBS_SBI = 0,
        A_PKBKgPucuk_SBI = 0,
        A_PKBPanenLainnya_SBI = 0,
        A_PKBJumlahHK_SBI = 0, 
        A_PKBRpGaji_SBI = 0,
		A_PKBHasilPemeliharaan_SBI = 0,
		A_PKBHasilLainnya_SBI = 0
		FROM #c as C	  
		where C.KMK='01' or C.KMK is null


	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then C.kodeunit 
				when @Layer='Afdeling' then C.kodeunit+C.kodeafd 
				else C.kodeunit+C.kodeafd+C.kdblok 
			end,
		TahunTanam = C.thntnm,
		KodeBudidaya = C.kodebud,
		GroupMesin = '',
		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)),
		R_KgBrondol_BI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_BI = cast(0 as decimal(18,2)),
		R_JumlahPohon_BI = cast(0 as decimal(18,2)),
		R_KgPucuk_BI = cast(0 as decimal(18,2)),
		R_PanenLainnya_BI = cast(0 as decimal(18,2)),
		R_JumlahHK_BI = cast(0 as decimal(18,2)),
		R_HaJelajah_BI = cast(0 as decimal(18,2)),
		R_RpGaji_BI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_HasilLainnya_BI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = cast(0 as decimal(18,2)),
		R_KgLump_SBI = 0, 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  0,
		R_JumlahTandan_SBI = 0,
		R_JumlahPohon_SBI = 0,
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = 0,
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = 0,
		R_RKAPKgTBS_SBI = 0,
		R_RKAPKgPucuk_SBI = 0,
        R_RKAPPanenLainnya_SBI = 0,
        R_RKAPJumlahHK_SBI = 0, 
        R_RKAPRpGaji_SBI = 0, 
		R_RKAPHasilPemeliharaan_SBI = 0,
		R_RKAPHasilLainnya_SBI = 0,
        R_PKBKgLateks_SBI = 0, 
        R_PKBKgTBS_SBI = 0,
        R_PKBKgPucuk_SBI = 0,
        R_PKBPanenLainnya_SBI = 0,
        R_PKBJumlahHK_SBI = 0, 
        R_PKBRpGaji_SBI = 0,
		R_PKBHasilPemeliharaan_SBI = 0,
		R_PKBHasilLainnya_SBI = 0,
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)),
		A_KgBrondol_BI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_BI = cast(0 as decimal(18,2)),
		A_JumlahPohon_BI = cast(0 as decimal(18,2)),
		A_KgPucuk_BI = cast(0 as decimal(18,2)),
		A_PanenLainnya_BI = cast(0 as decimal(18,2)),
		A_JumlahHK_BI = cast(0 as decimal(18,2)),
		A_HaJelajah_BI = cast(0 as decimal(18,2)),
		A_RpGaji_BI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_HasilLainnya_BI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = case when C.kodebud='00' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end, 
		A_KgLump_SBI = 0, 
		A_KgTBS_SBI = case when C.kodebud='01' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		A_KgBrondol_SBI =  0,
		A_JumlahTandan_SBI = 0,
		A_JumlahPohon_SBI = 0,
		A_KgPucuk_SBI = case when C.kodebud='02' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		A_PanenLainnya_SBI = case when C.kodebud!='00' and C.kodebud!='01' and C.kodebud!='02' and SUBSTRING(C.norek,1,3)='602' then C.jmlhasil else 0 end,
		A_JumlahHK_SBI = C.RealisasiJumlahHK,
		A_HaJelajah_SBI = 0,
		A_RpGaji_SBI = C.jmlupah,
		A_HasilPemeliharaan_SBI = case when SUBSTRING(C.norek,1,3)='601' then C.jmlhasil else 0 end,
		A_HasilLainnya_SBI = case when SUBSTRING(C.norek,1,3)!='601' and SUBSTRING(C.norek,1,3)!='602' then C.jmlhasil else 0 end,
		A_RKAPKgLateks_SBI = 0,
		A_RKAPKgTBS_SBI = 0,
		A_RKAPKgPucuk_SBI = 0,
        A_RKAPPanenLainnya_SBI = 0,
        A_RKAPJumlahHK_SBI = 0, 
        A_RKAPRpGaji_SBI = 0, 
        A_RKAPHasilPemeliharaan_SBI = 0,
		A_RKAPHasilLainnya_SBI = 0,
        A_PKBKgLateks_SBI = 0, 
        A_PKBKgTBS_SBI = 0,
        A_PKBKgPucuk_SBI = 0,
        A_PKBPanenLainnya_SBI = 0,
        A_PKBJumlahHK_SBI = 0, 
        A_PKBRpGaji_SBI = 0,
		A_PKBHasilPemeliharaan_SBI = 0,
		A_PKBHasilLainnya_SBI = 0
		FROM #c as C	  
		where C.KMK='02'

	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then D.kodeunit 
				when @Layer='Afdeling' then D.kodeunit+D.kodeafd 
				else D.kodeunit+D.kodeafd+D.kodeblok 
			end,
		TahunTanam = D.thntnm,
		KodeBudidaya = D.kodebud,
		GroupMesin = '',
		R_KgLateks_BI = 0, 
		R_KgLump_BI = 0, 
		R_KgTBS_BI = 0,
		R_KgBrondol_BI =  0,
		R_JumlahTandan_BI = 0,
		R_JumlahPohon_BI = 0,
		R_KgPucuk_BI = 0,
		R_PanenLainnya_BI = 0,
		R_JumlahHK_BI = 0,
		R_HaJelajah_BI = 0,
		R_RpGaji_BI = 0,
		R_HasilPemeliharaan_BI = 0,
		R_HasilLainnya_BI = 0,
		R_RKAPKgLateks_BI = case when D.kodebud='00' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
		R_RKAPKgTBS_BI = case when D.kodebud='01' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
		R_RKAPKgPucuk_BI = case when D.kodebud='02' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
        R_RKAPPanenLainnya_BI = case when D.kodebud!='00' and D.kodebud!='01' and D.kodebud!='02' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
        R_RKAPJumlahHK_BI = D.RKAPJumlahHK, 
        R_RKAPRpGaji_BI = D.RKAPjmlupah, 
        R_RKAPHasilPemeliharaan_BI = case when SUBSTRING(D.norek,1,3)='601' then D.RKAPjmlhasil else 0 end,
		R_RKAPHasilLainnya_BI = case when SUBSTRING(D.norek,1,3)!='601' and SUBSTRING(D.norek,1,3)!='602' then D.RKAPjmlhasil else 0 end,
        R_PKBKgLateks_BI = case when D.kodebud='00' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end, 
        R_PKBKgTBS_BI = case when D.kodebud='01' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        R_PKBKgPucuk_BI = case when D.kodebud='02' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        R_PKBPanenLainnya_BI = case when D.kodebud!='00' and D.kodebud!='01' and D.kodebud!='02' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        R_PKBJumlahHK_BI = D.PMKJumlahHK, 
        R_PKBRpGaji_BI = D.PMKjmlupah,
        R_PKBHasilPemeliharaan_BI = case when SUBSTRING(D.norek,1,3)='601' then D.PMKjmlhasil else 0 end,
		R_PKBHasilLainnya_BI = case when SUBSTRING(D.norek,1,3)!='601' and SUBSTRING(D.norek,1,3)!='602' then D.PMKjmlhasil else 0 end,
		R_KgLateks_SBI = cast(0 as decimal(18,2)), 
		R_KgLump_SBI = cast(0 as decimal(18,2)), 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		R_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = cast(0 as decimal(18,2)),
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)),
		A_KgBrondol_BI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_BI = cast(0 as decimal(18,2)),
		A_JumlahPohon_BI = cast(0 as decimal(18,2)),
		A_KgPucuk_BI = cast(0 as decimal(18,2)),
		A_PanenLainnya_BI = cast(0 as decimal(18,2)),
		A_JumlahHK_BI = cast(0 as decimal(18,2)),
		A_HaJelajah_BI = cast(0 as decimal(18,2)),
		A_RpGaji_BI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_HasilLainnya_BI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = 0, 
		A_KgLump_SBI = 0, 
		A_KgTBS_SBI = 0,
		A_KgBrondol_SBI =  0,
		A_JumlahTandan_SBI = 0,
		A_JumlahPohon_SBI = 0,
		A_KgPucuk_SBI = 0,
		A_PanenLainnya_SBI = 0,
		A_JumlahHK_SBI = 0,
		A_HaJelajah_SBI = 0,
		A_RpGaji_SBI = 0,
		A_HasilPemeliharaan_SBI = 0,
		A_HasilLainnya_SBI = 0,
		A_RKAPKgLateks_SBI = 0,
		A_RKAPKgTBS_SBI = 0,
		A_RKAPKgPucuk_SBI = 0,
        A_RKAPPanenLainnya_SBI = 0,
        A_RKAPJumlahHK_SBI = 0, 
        A_RKAPRpGaji_SBI = 0, 
		A_RKAPHasilPemeliharaan_SBI = 0,
		A_RKAPHasilLainnya_SBI = 0,
        A_PKBKgLateks_SBI = 0, 
        A_PKBKgTBS_SBI = 0,
        A_PKBKgPucuk_SBI = 0,
        A_PKBPanenLainnya_SBI = 0,
        A_PKBJumlahHK_SBI = 0, 
        A_PKBRpGaji_SBI = 0,
		A_PKBHasilPemeliharaan_SBI = 0,
		A_PKBHasilLainnya_SBI = 0
		FROM #d as D	       
		WHERE D.bulan=@BulanAkhir and D.tahun=@TahunAkhir and (d.KMK='01' or d.KMK is null)

		
	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then D.kodeunit 
				when @Layer='Afdeling' then D.kodeunit+D.kodeafd 
				else D.kodeunit+D.kodeafd+D.kodeblok 
			end,
		TahunTanam = D.thntnm,
		KodeBudidaya = D.kodebud,
		GroupMesin = '',
		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)),
		R_KgBrondol_BI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_BI = cast(0 as decimal(18,2)),
		R_JumlahPohon_BI = cast(0 as decimal(18,2)),
		R_KgPucuk_BI = cast(0 as decimal(18,2)),
		R_PanenLainnya_BI = cast(0 as decimal(18,2)),
		R_JumlahHK_BI = cast(0 as decimal(18,2)),
		R_HaJelajah_BI = cast(0 as decimal(18,2)),
		R_RpGaji_BI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_HasilLainnya_BI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = cast(0 as decimal(18,2)),
		R_KgLump_SBI = 0, 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  0,
		R_JumlahTandan_SBI = 0,
		R_JumlahPohon_SBI = 0,
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = 0,
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = 0,
		R_RKAPKgTBS_SBI = 0,
		R_RKAPKgPucuk_SBI = 0,
        R_RKAPPanenLainnya_SBI = 0,
        R_RKAPJumlahHK_SBI = 0, 
        R_RKAPRpGaji_SBI = 0, 
		R_RKAPHasilPemeliharaan_SBI = 0,
		R_RKAPHasilLainnya_SBI = 0,
        R_PKBKgLateks_SBI = 0, 
        R_PKBKgTBS_SBI = 0,
        R_PKBKgPucuk_SBI = 0,
        R_PKBPanenLainnya_SBI = 0,
        R_PKBJumlahHK_SBI = 0, 
        R_PKBRpGaji_SBI = 0,
		R_PKBHasilPemeliharaan_SBI = 0,
		R_PKBHasilLainnya_SBI = 0,
		A_KgLateks_BI = 0, 
		A_KgLump_BI = 0, 
		A_KgTBS_BI = 0,
		A_KgBrondol_BI =  0,
		A_JumlahTandan_BI = 0,
		A_JumlahPohon_BI = 0,
		A_KgPucuk_BI = 0,
		A_PanenLainnya_BI = 0,
		A_JumlahHK_BI = 0,
		A_HaJelajah_BI = 0,
		A_RpGaji_BI = 0,
		A_HasilPemeliharaan_BI = 0,
		A_HasilLainnya_BI = 0,
		A_RKAPKgLateks_BI = case when D.kodebud='00' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
		A_RKAPKgTBS_BI = case when D.kodebud='01' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
		A_RKAPKgPucuk_BI = case when D.kodebud='02' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
        A_RKAPPanenLainnya_BI = case when D.kodebud!='00' and D.kodebud!='01' and D.kodebud!='02' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
        A_RKAPJumlahHK_BI = D.RKAPJumlahHK, 
        A_RKAPRpGaji_BI = D.RKAPjmlupah, 
        A_RKAPHasilPemeliharaan_BI = case when SUBSTRING(D.norek,1,3)='601' then D.RKAPjmlhasil else 0 end,
		A_RKAPHasilLainnya_BI = case when SUBSTRING(D.norek,1,3)!='601' and SUBSTRING(D.norek,1,3)!='602' then D.RKAPjmlhasil else 0 end,
        A_PKBKgLateks_BI = case when D.kodebud='00' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end, 
        A_PKBKgTBS_BI = case when D.kodebud='01' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        A_PKBKgPucuk_BI = case when D.kodebud='02' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        A_PKBPanenLainnya_BI = case when D.kodebud!='00' and D.kodebud!='01' and D.kodebud!='02' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        A_PKBJumlahHK_BI = D.PMKJumlahHK, 
        A_PKBRpGaji_BI = D.PMKjmlupah,
        A_PKBHasilPemeliharaan_BI = case when SUBSTRING(D.norek,1,3)='601' then D.PMKjmlhasil else 0 end,
		A_PKBHasilLainnya_BI = case when SUBSTRING(D.norek,1,3)!='601' and SUBSTRING(D.norek,1,3)!='602' then D.PMKjmlhasil else 0 end,
		A_KgLateks_SBI = cast(0 as decimal(18,2)), 
		A_KgLump_SBI = cast(0 as decimal(18,2)), 
		A_KgTBS_SBI = cast(0 as decimal(18,2)),
		A_KgBrondol_SBI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_SBI = cast(0 as decimal(18,2)),
		A_JumlahPohon_SBI = cast(0 as decimal(18,2)),
		A_KgPucuk_SBI = cast(0 as decimal(18,2)),
		A_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		A_JumlahHK_SBI = cast(0 as decimal(18,2)),
		A_HaJelajah_SBI = cast(0 as decimal(18,2)),
		A_RpGaji_SBI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_SBI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_SBI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_SBI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_SBI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_SBI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_SBI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_SBI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_SBI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_SBI = cast(0 as decimal(18,2))
		FROM #d as D	       
		WHERE D.bulan=@BulanAkhir and D.tahun=@TahunAkhir and D.KMK='02'

	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then D.kodeunit 
				when @Layer='Afdeling' then D.kodeunit+D.kodeafd 
				else D.kodeunit+D.kodeafd+D.kodeblok 
			end,
		TahunTanam = D.thntnm,
		KodeBudidaya = D.kodebud,
		GroupMesin = '',
		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)),
		R_KgBrondol_BI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_BI = cast(0 as decimal(18,2)),
		R_JumlahPohon_BI = cast(0 as decimal(18,2)),
		R_KgPucuk_BI = cast(0 as decimal(18,2)),
		R_PanenLainnya_BI = cast(0 as decimal(18,2)),
		R_JumlahHK_BI = cast(0 as decimal(18,2)),
		R_HaJelajah_BI = cast(0 as decimal(18,2)),
		R_RpGaji_BI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_HasilLainnya_BI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = 0, 
		R_KgLump_SBI = 0, 
		R_KgTBS_SBI = 0,
		R_KgBrondol_SBI =  0,
		R_JumlahTandan_SBI = 0,
		R_JumlahPohon_SBI = 0,
		R_KgPucuk_SBI = 0,
		R_PanenLainnya_SBI = 0,
		R_JumlahHK_SBI = 0,
		R_HaJelajah_SBI = 0,
		R_RpGaji_SBI = 0,
		R_HasilPemeliharaan_SBI = 0,
		R_HasilLainnya_SBI = 0,
		R_RKAPKgLateks_SBI = case when D.kodebud='00' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
		R_RKAPKgTBS_SBI = case when D.kodebud='01' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
		R_RKAPKgPucuk_SBI = case when D.kodebud='02' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
        R_RKAPPanenLainnya_SBI = case when D.kodebud!='00' and D.kodebud!='01' and D.kodebud!='02' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
        R_RKAPJumlahHK_SBI = D.RKAPJumlahHK, 
        R_RKAPRpGaji_SBI = D.RKAPjmlupah, 
        R_RKAPHasilPemeliharaan_SBI = case when SUBSTRING(D.norek,1,3)='601' then D.RKAPjmlhasil else 0 end,
		R_RKAPHasilLainnya_SBI = case when SUBSTRING(D.norek,1,3)!='601' and SUBSTRING(D.norek,1,3)!='602' then D.RKAPjmlhasil else 0 end,
        R_PKBKgLateks_SBI = case when D.kodebud='00' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end, 
        R_PKBKgTBS_SBI = case when D.kodebud='01' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        R_PKBKgPucuk_SBI = case when D.kodebud='02' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        R_PKBPanenLainnya_SBI = case when D.kodebud!='00' and D.kodebud!='01' and D.kodebud!='02' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        R_PKBJumlahHK_SBI = D.PMKJumlahHK, 
        R_PKBRpGaji_SBI = D.PMKjmlupah,
        R_PKBHasilPemeliharaan_SBI = case when SUBSTRING(D.norek,1,3)='601' then D.PMKjmlhasil else 0 end,
		R_PKBHasilLainnya_SBI = case when SUBSTRING(D.norek,1,3)!='601' and SUBSTRING(D.norek,1,3)!='602' then D.PMKjmlhasil else 0 end,
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)),
		A_KgBrondol_BI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_BI = cast(0 as decimal(18,2)),
		A_JumlahPohon_BI = cast(0 as decimal(18,2)),
		A_KgPucuk_BI = cast(0 as decimal(18,2)),
		A_PanenLainnya_BI = cast(0 as decimal(18,2)),
		A_JumlahHK_BI = cast(0 as decimal(18,2)),
		A_HaJelajah_BI = cast(0 as decimal(18,2)),
		A_RpGaji_BI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_HasilLainnya_BI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = 0, 
		A_KgLump_SBI = 0, 
		A_KgTBS_SBI = 0,
		A_KgBrondol_SBI =  0,
		A_JumlahTandan_SBI = 0,
		A_JumlahPohon_SBI = 0,
		A_KgPucuk_SBI = 0,
		A_PanenLainnya_SBI = 0,
		A_JumlahHK_SBI = 0,
		A_HaJelajah_SBI = 0,
		A_RpGaji_SBI = 0,
		A_HasilPemeliharaan_SBI = 0,
		A_HasilLainnya_SBI = 0,
		A_RKAPKgLateks_SBI = 0,
		A_RKAPKgTBS_SBI = 0,
		A_RKAPKgPucuk_SBI = 0,
        A_RKAPPanenLainnya_SBI = 0,
        A_RKAPJumlahHK_SBI = 0, 
        A_RKAPRpGaji_SBI = 0, 
		A_RKAPHasilPemeliharaan_SBI = 0,
		A_RKAPHasilLainnya_SBI = 0,
        A_PKBKgLateks_SBI = 0, 
        A_PKBKgTBS_SBI = 0,
        A_PKBKgPucuk_SBI = 0,
        A_PKBPanenLainnya_SBI = 0,
        A_PKBJumlahHK_SBI = 0, 
        A_PKBRpGaji_SBI = 0,
		A_PKBHasilPemeliharaan_SBI = 0,
		A_PKBHasilLainnya_SBI = 0
		FROM #d as D	       
		where D.KMK='01' or D.KMK is null


	insert into #e
    SELECT 
		KodeBlok = 
			case 
				when @Layer='Kebun' then D.kodeunit 
				when @Layer='Afdeling' then D.kodeunit+D.kodeafd 
				else D.kodeunit+D.kodeafd+D.kodeblok 
			end,
		TahunTanam = D.thntnm,
		KodeBudidaya = D.kodebud,
		GroupMesin = '',
		R_KgLateks_BI = cast(0 as decimal(18,2)), 
		R_KgLump_BI = cast(0 as decimal(18,2)), 
		R_KgTBS_BI = cast(0 as decimal(18,2)),
		R_KgBrondol_BI =  cast(0 as decimal(18,2)),
		R_JumlahTandan_BI = cast(0 as decimal(18,2)),
		R_JumlahPohon_BI = cast(0 as decimal(18,2)),
		R_KgPucuk_BI = cast(0 as decimal(18,2)),
		R_PanenLainnya_BI = cast(0 as decimal(18,2)),
		R_JumlahHK_BI = cast(0 as decimal(18,2)),
		R_HaJelajah_BI = cast(0 as decimal(18,2)),
		R_RpGaji_BI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_HasilLainnya_BI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		R_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		R_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        R_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        R_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		R_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        R_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        R_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        R_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        R_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        R_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		R_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		R_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		R_KgLateks_SBI = cast(0 as decimal(18,2)),
		R_KgLump_SBI = 0, 
		R_KgTBS_SBI = cast(0 as decimal(18,2)),
		R_KgBrondol_SBI =  0,
		R_JumlahTandan_SBI = 0,
		R_JumlahPohon_SBI = 0,
		R_KgPucuk_SBI = cast(0 as decimal(18,2)),
		R_PanenLainnya_SBI = cast(0 as decimal(18,2)),
		R_JumlahHK_SBI = cast(0 as decimal(18,2)),
		R_HaJelajah_SBI = 0,
		R_RpGaji_SBI = cast(0 as decimal(18,2)),
		R_HasilPemeliharaan_SBI = cast(0 as decimal(18,2)),
		R_HasilLainnya_SBI = cast(0 as decimal(18,2)),
		R_RKAPKgLateks_SBI = 0,
		R_RKAPKgTBS_SBI = 0,
		R_RKAPKgPucuk_SBI = 0,
        R_RKAPPanenLainnya_SBI = 0,
        R_RKAPJumlahHK_SBI = 0, 
        R_RKAPRpGaji_SBI = 0, 
		R_RKAPHasilPemeliharaan_SBI = 0,
		R_RKAPHasilLainnya_SBI = 0,
        R_PKBKgLateks_SBI = 0, 
        R_PKBKgTBS_SBI = 0,
        R_PKBKgPucuk_SBI = 0,
        R_PKBPanenLainnya_SBI = 0,
        R_PKBJumlahHK_SBI = 0, 
        R_PKBRpGaji_SBI = 0,
		R_PKBHasilPemeliharaan_SBI = 0,
		R_PKBHasilLainnya_SBI = 0,
		A_KgLateks_BI = cast(0 as decimal(18,2)), 
		A_KgLump_BI = cast(0 as decimal(18,2)), 
		A_KgTBS_BI = cast(0 as decimal(18,2)),
		A_KgBrondol_BI =  cast(0 as decimal(18,2)),
		A_JumlahTandan_BI = cast(0 as decimal(18,2)),
		A_JumlahPohon_BI = cast(0 as decimal(18,2)),
		A_KgPucuk_BI = cast(0 as decimal(18,2)),
		A_PanenLainnya_BI = cast(0 as decimal(18,2)),
		A_JumlahHK_BI = cast(0 as decimal(18,2)),
		A_HaJelajah_BI = cast(0 as decimal(18,2)),
		A_RpGaji_BI = cast(0 as decimal(18,2)),
		A_HasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_HasilLainnya_BI = cast(0 as decimal(18,2)),
		A_RKAPKgLateks_BI = cast(0 as decimal(18,2)),
		A_RKAPKgTBS_BI = cast(0 as decimal(18,2)),
		A_RKAPKgPucuk_BI = cast(0 as decimal(18,2)),
        A_RKAPPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_RKAPJumlahHK_BI = cast(0 as decimal(18,2)),  
        A_RKAPRpGaji_BI = cast(0 as decimal(18,2)), 
		A_RKAPHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_RKAPHasilLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBKgLateks_BI = cast(0 as decimal(18,2)), 
        A_PKBKgTBS_BI = cast(0 as decimal(18,2)),
        A_PKBKgPucuk_BI = cast(0 as decimal(18,2)),
        A_PKBPanenLainnya_BI = cast(0 as decimal(18,2)),
        A_PKBJumlahHK_BI = cast(0 as decimal(18,2)), 
        A_PKBRpGaji_BI = cast(0 as decimal(18,2)),
		A_PKBHasilPemeliharaan_BI = cast(0 as decimal(18,2)),
		A_PKBHasilLainnya_BI = cast(0 as decimal(18,2)),
		A_KgLateks_SBI = 0, 
		A_KgLump_SBI = 0, 
		A_KgTBS_SBI = 0,
		A_KgBrondol_SBI =  0,
		A_JumlahTandan_SBI = 0,
		A_JumlahPohon_SBI = 0,
		A_KgPucuk_SBI = 0,
		A_PanenLainnya_SBI = 0,
		A_JumlahHK_SBI = 0,
		A_HaJelajah_SBI = 0,
		A_RpGaji_SBI = 0,
		A_HasilPemeliharaan_SBI = 0,
		A_HasilLainnya_SBI = 0,
		A_RKAPKgLateks_SBI = case when D.kodebud='00' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
		A_RKAPKgTBS_SBI = case when D.kodebud='01' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
		A_RKAPKgPucuk_SBI = case when D.kodebud='02' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
        A_RKAPPanenLainnya_SBI = case when D.kodebud!='00' and D.kodebud!='01' and D.kodebud!='02' and SUBSTRING(D.norek,1,3)='602' then D.RKAPjmlhasil else 0 end,
        A_RKAPJumlahHK_SBI = D.RKAPJumlahHK, 
        A_RKAPRpGaji_SBI = D.RKAPjmlupah, 
        A_RKAPHasilPemeliharaan_SBI = case when SUBSTRING(D.norek,1,3)='601' then D.RKAPjmlhasil else 0 end,
		A_RKAPHasilLainnya_SBI = case when SUBSTRING(D.norek,1,3)!='601' and SUBSTRING(D.norek,1,3)!='602' then D.RKAPjmlhasil else 0 end,
        A_PKBKgLateks_SBI = case when D.kodebud='00' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end, 
        A_PKBKgTBS_SBI = case when D.kodebud='01' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        A_PKBKgPucuk_SBI = case when D.kodebud='02' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        A_PKBPanenLainnya_SBI = case when D.kodebud!='00' and D.kodebud!='01' and D.kodebud!='02' and SUBSTRING(D.norek,1,3)='602' then D.PMKjmlhasil else 0 end,
        A_PKBJumlahHK_SBI = D.PMKJumlahHK, 
        A_PKBRpGaji_SBI = D.PMKjmlupah,
        A_PKBHasilPemeliharaan_SBI = case when SUBSTRING(D.norek,1,3)='601' then D.PMKjmlhasil else 0 end,
		A_PKBHasilLainnya_SBI = case when SUBSTRING(D.norek,1,3)!='601' and SUBSTRING(D.norek,1,3)!='602' then D.PMKjmlhasil else 0 end
		FROM #d as D	       
		where D.KMK='02'


    SELECT 
		KodeBlok, 
		KodeBudidaya,
		R_KgLateks_BI = sum(R_KgLateks_BI), 
		R_KgLump_BI = SUM(R_KgLump_BI), 
		R_KgTBS_BI = SUM(R_KgTBS_BI),
		R_KgBrondol_BI =  SUM(R_KgBrondol_BI),
		R_JumlahTandan_BI = SUM(R_JumlahTandan_BI),
		R_JumlahPohon_BI = SUM(R_JumlahPohon_BI),
		R_KgPucuk_BI = SUM(R_KgPucuk_BI),
		R_PanenLainnya_BI = SUM(R_PanenLainnya_BI),
		R_JumlahHK_BI = SUM(R_JumlahHK_BI),
		R_HaJelajah_BI = AVG(R_HaJelajah_BI),
		R_RpGaji_BI = SUM(R_RpGaji_BI),
		R_HasilPemeliharaan_BI = SUM(R_HasilPemeliharaan_BI),
		R_HasilLainnya_BI = SUM(R_HasilLainnya_BI),
		R_RKAPKgLateks_BI = SUM(R_RKAPKgLateks_BI),
		R_RKAPKgTBS_BI = SUM(R_RKAPKgTBS_BI),
		R_RKAPKgPucuk_BI = SUM(R_RKAPKgPucuk_BI),
        R_RKAPPanenLainnya_BI = SUM(R_RKAPPanenLainnya_BI),
        R_RKAPJumlahHK_BI = SUM(R_RKAPJumlahHK_BI), 
        R_RKAPRpGaji_BI = SUM(R_RKAPRpGaji_BI), 
        R_RKAPHasilPemeliharaan_BI = SUM(R_RKAPHasilPemeliharaan_BI),
		R_RKAPHasilLainnya_BI = SUM(R_RKAPHasilLainnya_BI),
        R_PKBKgLateks_BI = SUM(R_PKBKgLateks_BI), 
        R_PKBKgTBS_BI = SUM(R_PKBKgTBS_BI),
        R_PKBKgPucuk_BI = SUM(R_PKBKgPucuk_BI),
        R_PKBPanenLainnya_BI = SUM(R_PKBPanenLainnya_BI),
        R_PKBJumlahHK_BI = SUM(R_PKBJumlahHK_BI), 
        R_PKBRpGaji_BI = SUM(R_PKBRpGaji_BI),
        R_PKBHasilPemeliharaan_BI = SUM(R_PKBHasilPemeliharaan_BI),
		R_PKBHasilLainnya_BI = SUM(R_PKBHasilLainnya_BI),
		A_KgLateks_BI = sum(A_KgLateks_BI), 
		A_KgLump_BI = SUM(A_KgLump_BI), 
		A_KgTBS_BI = SUM(A_KgTBS_BI),
		A_KgBrondol_BI = SUM(A_KgBrondol_BI),
		A_JumlahTandan_BI = SUM(A_JumlahTandan_BI),
		A_JumlahPohon_BI = SUM(A_JumlahPohon_BI),
		A_KgPucuk_BI = SUM(A_KgPucuk_BI),
		A_PanenLainnya_BI = SUM(A_PanenLainnya_BI),
		A_JumlahHK_BI = SUM(A_JumlahHK_BI),
		A_HaJelajah_BI = AVG(A_HaJelajah_BI),
		A_RpGaji_BI = SUM(A_RpGaji_BI),
		A_HasilPemeliharaan_BI = SUM(A_HasilPemeliharaan_BI),
		A_HasilLainnya_BI = SUM(A_HasilLainnya_BI),
		A_RKAPKgLateks_BI = SUM(A_RKAPKgLateks_BI),
		A_RKAPKgTBS_BI = SUM(A_RKAPKgTBS_BI),
		A_RKAPKgPucuk_BI = SUM(A_RKAPKgPucuk_BI),
        A_RKAPPanenLainnya_BI = SUM(A_RKAPPanenLainnya_BI),
        A_RKAPJumlahHK_BI = SUM(A_RKAPJumlahHK_BI), 
        A_RKAPRpGaji_BI = SUM(A_RKAPRpGaji_BI), 
        A_RKAPHasilPemeliharaan_BI = SUM(A_RKAPHasilPemeliharaan_BI),
		A_RKAPHasilLainnya_BI = SUM(A_RKAPHasilLainnya_BI),
        A_PKBKgLateks_BI = SUM(A_PKBKgLateks_BI), 
        A_PKBKgTBS_BI = SUM(A_PKBKgTBS_BI),
        A_PKBKgPucuk_BI = SUM(A_PKBKgPucuk_BI),
        A_PKBPanenLainnya_BI = SUM(A_PKBPanenLainnya_BI),
        A_PKBJumlahHK_BI = SUM(A_PKBJumlahHK_BI), 
        A_PKBRpGaji_BI = SUM(A_PKBRpGaji_BI),
        A_PKBHasilPemeliharaan_BI = SUM(A_PKBHasilPemeliharaan_BI),
        A_PKBHasilLainnya_BI = SUM(A_PKBHasilLainnya_BI),
		R_KgLateks_SBI = sum(R_KgLateks_SBI), 
		R_KgLump_SBI = SUM(R_KgLump_SBI), 
		R_KgTBS_SBI = SUM(R_KgTBS_SBI),
		R_KgBrondol_SBI =  SUM(R_KgBrondol_SBI),
		R_JumlahTandan_SBI = SUM(R_JumlahTandan_SBI),
		R_JumlahPohon_SBI = SUM(R_JumlahPohon_SBI),
		R_KgPucuk_SBI = SUM(R_KgPucuk_SBI),
		R_PanenLainnya_SBI = SUM(R_PanenLainnya_SBI),
		R_JumlahHK_SBI = SUM(R_JumlahHK_SBI),
		R_HaJelajah_SBI = AVG(R_HaJelajah_SBI),
		R_RpGaji_SBI = SUM(R_RpGaji_SBI),
		R_HasilPemeliharaan_SBI = SUM(R_HasilPemeliharaan_SBI),
		R_HasilLainnya_SBI = SUM(R_HasilLainnya_SBI),
		R_RKAPKgLateks_SBI = SUM(R_RKAPKgLateks_SBI),
		R_RKAPKgTBS_SBI = SUM(R_RKAPKgTBS_SBI),
		R_RKAPKgPucuk_SBI = SUM(R_RKAPKgPucuk_SBI),
        R_RKAPPanenLainnya_SBI = SUM(R_RKAPPanenLainnya_SBI),
        R_RKAPJumlahHK_SBI = SUM(R_RKAPJumlahHK_SBI), 
        R_RKAPRpGaji_SBI = SUM(R_RKAPRpGaji_SBI), 
        R_RKAPHasilPemeliharaan_SBI = SUM(R_RKAPHasilPemeliharaan_SBI),
		R_RKAPHasilLainnya_SBI = SUM(R_RKAPHasilLainnya_SBI),
        R_PKBKgLateks_SBI = SUM(R_PKBKgLateks_SBI), 
        R_PKBKgTBS_SBI = SUM(R_PKBKgTBS_SBI),
        R_PKBKgPucuk_SBI = SUM(R_PKBKgPucuk_SBI),
        R_PKBPanenLainnya_SBI = SUM(R_PKBPanenLainnya_SBI),
        R_PKBJumlahHK_SBI = SUM(R_PKBJumlahHK_SBI), 
        R_PKBRpGaji_SBI = SUM(R_PKBRpGaji_SBI),
        R_PKBHasilPemeliharaan_SBI = SUM(R_PKBHasilPemeliharaan_SBI),
		R_PKBHasilLainnya_SBI = SUM(R_PKBHasilLainnya_SBI),
		A_KgLateks_SBI = sum(A_KgLateks_SBI), 
		A_KgLump_SBI = SUM(A_KgLump_SBI), 
		A_KgTBS_SBI = SUM(A_KgTBS_SBI),
		A_KgBrondol_SBI =  SUM(A_KgBrondol_SBI),
		A_JumlahTandan_SBI = SUM(A_JumlahTandan_SBI),
		A_JumlahPohon_SBI = SUM(A_JumlahPohon_SBI),
		A_KgPucuk_SBI = SUM(A_KgPucuk_SBI),
		A_PanenLainnya_SBI = SUM(A_PanenLainnya_SBI),
		A_JumlahHK_SBI = SUM(A_JumlahHK_SBI),
		A_HaJelajah_SBI = AVG(A_HaJelajah_SBI),
		A_RpGaji_SBI = SUM(A_RpGaji_SBI),
		A_HasilPemeliharaan_SBI = SUM(A_HasilPemeliharaan_SBI),
		A_HasilLainnya_SBI = SUM(A_HasilLainnya_SBI),
		A_RKAPKgLateks_SBI = SUM(A_RKAPKgLateks_SBI),
		A_RKAPKgTBS_SBI = SUM(A_RKAPKgTBS_SBI),
		A_RKAPKgPucuk_SBI = SUM(A_RKAPKgPucuk_SBI),
        A_RKAPPanenLainnya_SBI = SUM(A_RKAPPanenLainnya_SBI),
        A_RKAPJumlahHK_SBI = SUM(A_RKAPJumlahHK_SBI), 
        A_RKAPRpGaji_SBI = SUM(A_RKAPRpGaji_SBI), 
        A_RKAPHasilPemeliharaan_SBI = SUM(A_RKAPHasilPemeliharaan_SBI),
		A_RKAPHasilLainnya_SBI = SUM(A_RKAPHasilLainnya_SBI),
        A_PKBKgLateks_SBI = SUM(A_PKBKgLateks_SBI), 
        A_PKBKgTBS_SBI = SUM(A_PKBKgTBS_SBI),
        A_PKBKgPucuk_SBI = SUM(A_PKBKgPucuk_SBI),
        A_PKBPanenLainnya_SBI = SUM(A_PKBPanenLainnya_SBI),
        A_PKBJumlahHK_SBI = SUM(A_PKBJumlahHK_SBI), 
        A_PKBRpGaji_SBI = SUM(A_PKBRpGaji_SBI),
        A_PKBHasilPemeliharaan_SBI = SUM(A_PKBHasilPemeliharaan_SBI),
        A_PKBHasilLainnya_SBI = SUM(A_PKBHasilLainnya_SBI)
        INTO #f FROM #e as A
		GROUP BY KodeBlok, KodeBudidaya

			
		select 
			Id=						-- KebunId, AfdelingId atau BlokId
				case 
					when @Layer='Kebun' then (select top 1 kebunid from [ReferensiEF].[dbo].[Kebun] where kd_kbn=A.KodeBlok)
					when @Layer='Afdeling' then (select top 1 afdelingid from [ReferensiEF].[dbo].[Afdeling] where kd_afd=A.KodeBlok)
					else (select top 1 blokid from [ReferensiEF].[dbo].[Blok] where kd_blok=A.KodeBlok)
				end,
			KodeKebun=A.KodeBlok,	-- Kode Kebun, Kode Afdeling 
			Peta='',
			LuasTM=
				case 
					when @Layer='Kebun' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun=A.KodeBlok and [status]='TM')
					when @Layer='Afdeling' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling=A.KodeBlok and [status]='TM')
					else (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling+kodeblok=A.KodeBlok and [status]='TM')
				end,
			Nama=
				case 
					when @Layer='Kebun' then (select top 1 nama from [ReferensiEF].[dbo].[Kebun] where kd_kbn=A.KodeBlok)
					when @Layer='Afdeling' then (select top 1 nama from [ReferensiEF].[dbo].[Afdeling] where kd_afd=A.KodeBlok)
					else (select top 1 nama from [ReferensiEF].[dbo].[Blok] where kd_blok=A.KodeBlok)
				end,
			Value1 =
				case
					when @FieldYangDibandingkan='HK' then
						case 
							when @OrderBulan='BI' then R_JumlahHK_BI+A_JumlahHK_BI
							else R_JumlahHK_SBI+A_JumlahHK_SBI
						end
					when @FieldYangDibandingkan='PRESTASI' then
						case
							when @OrderBulan='BI' then R_KgLateks_BI+R_KgLump_BI+R_KgTBS_BI+R_KgBrondol_BI+R_KgPucuk_BI+R_PanenLainnya_BI+R_HasilPemeliharaan_BI+R_HasilLainnya_BI +
															A_KgLateks_BI+A_KgLump_BI+A_KgTBS_BI+A_KgBrondol_BI+A_KgPucuk_BI+A_PanenLainnya_BI+A_HasilPemeliharaan_BI+A_HasilLainnya_BI
							else R_KgLateks_SBI+R_KgLump_SBI+R_KgTBS_SBI+R_KgBrondol_SBI+R_KgPucuk_SBI+R_PanenLainnya_SBI+R_HasilPemeliharaan_SBI+R_HasilLainnya_SBI +
									A_KgLateks_SBI+A_KgLump_SBI+A_KgTBS_SBI+A_KgBrondol_SBI+A_KgPucuk_SBI+A_PanenLainnya_SBI+A_HasilPemeliharaan_SBI+A_HasilLainnya_SBI
						end
					when @FieldYangDibandingkan='PROTAS' then	
						case
							when @OrderBulan='BI' then (R_KgLateks_BI+R_KgLump_BI+R_KgTBS_BI+R_KgBrondol_BI+R_KgPucuk_BI+R_PanenLainnya_BI+
															A_KgLateks_BI+A_KgLump_BI+A_KgTBS_BI+A_KgBrondol_BI+A_KgPucuk_BI+A_PanenLainnya_BI)/
															(case 
																when @Layer='Kebun' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun=A.KodeBlok and [status]='TM')
																when @Layer='Afdeling' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling=A.KodeBlok and [status]='TM')
																else (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling+kodeblok=A.KodeBlok and [status]='TM')
															end) 
							else (R_KgLateks_SBI+R_KgLump_SBI+R_KgTBS_SBI+R_KgBrondol_SBI+R_KgPucuk_SBI+R_PanenLainnya_SBI+
									A_KgLateks_SBI+A_KgLump_SBI+A_KgTBS_SBI+A_KgBrondol_SBI+A_KgPucuk_SBI+A_PanenLainnya_SBI)/
															(case 
																when @Layer='Kebun' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun=A.KodeBlok and [status]='TM')
																when @Layer='Afdeling' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling=A.KodeBlok and [status]='TM')
																else (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling+kodeblok=A.KodeBlok and [status]='TM')
															end) 
						end
					else
						case
							when @OrderBulan='BI' then R_RpGaji_BI+A_RpGaji_BI
							else R_RpGaji_SBI+A_RpGaji_SBI
						end
				end,
			Value2 =
				case 
					when @DibandingkanDengan='RKAP' then 
						case 
							when @FieldYangDibandingkan='HK' then
								case 
									when @OrderBulan='BI' then R_RKAPJumlahHK_BI+A_RKAPJumlahHK_BI
									else R_RKAPJumlahHK_SBI+A_RKAPJumlahHK_SBI
								end
							when @FieldYangDibandingkan='PRESTASI' then
								case
									when @OrderBulan='BI' then R_RKAPKgLateks_BI+R_RKAPKgTBS_BI+R_RKAPKgPucuk_BI+R_RKAPPanenLainnya_BI+R_RKAPHasilPemeliharaan_BI+R_RKAPHasilLainnya_BI +
																A_RKAPKgLateks_BI+A_RKAPKgTBS_BI+A_RKAPKgPucuk_BI+A_RKAPPanenLainnya_BI+A_RKAPHasilPemeliharaan_BI+A_RKAPHasilLainnya_BI
									else R_RKAPKgLateks_SBI+R_RKAPKgTBS_SBI+R_RKAPKgPucuk_SBI+R_RKAPPanenLainnya_SBI+R_RKAPHasilPemeliharaan_SBI+R_RKAPHasilLainnya_SBI +
											A_RKAPKgLateks_SBI+A_RKAPKgTBS_SBI+A_RKAPKgPucuk_SBI+A_RKAPPanenLainnya_SBI+A_RKAPHasilPemeliharaan_SBI+A_RKAPHasilLainnya_SBI
								end
							when @FieldYangDibandingkan='PROTAS' then	
								case
									when @OrderBulan='BI' then (R_RKAPKgLateks_BI+R_RKAPKgTBS_BI+R_RKAPKgPucuk_BI+R_RKAPPanenLainnya_BI+
																A_RKAPKgLateks_BI+A_RKAPKgTBS_BI+A_RKAPKgPucuk_BI+A_RKAPPanenLainnya_BI)/
															(case 
																when @Layer='Kebun' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun=A.KodeBlok and [status]='TM')
																when @Layer='Afdeling' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling=A.KodeBlok and [status]='TM')
																else (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling+kodeblok=A.KodeBlok and [status]='TM')
															end) 

									else (R_RKAPKgLateks_SBI+R_RKAPKgTBS_SBI+R_RKAPKgPucuk_SBI+R_RKAPPanenLainnya_SBI+
											A_RKAPKgLateks_SBI+A_RKAPKgTBS_SBI+A_RKAPKgPucuk_SBI+A_RKAPPanenLainnya_SBI)/
															(case 
																when @Layer='Kebun' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun=A.KodeBlok and [status]='TM')
																when @Layer='Afdeling' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling=A.KodeBlok and [status]='TM')
																else (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling+kodeblok=A.KodeBlok and [status]='TM')
															end) 
									
								end	
							else
								case
									when @OrderBulan='BI' then R_RKAPRpGaji_BI+A_RKAPRpGaji_BI
									else R_RKAPRpGaji_SBI+A_RKAPRpGaji_SBI
								end
								
						end
					when @DibandingkanDengan='PKB' then
						case 
							when @FieldYangDibandingkan='HK' then
								case 
									when @OrderBulan='BI' then R_PKBJumlahHK_BI+A_PKBJumlahHK_BI
									else R_PKBJumlahHK_SBI+A_PKBJumlahHK_SBI
								end
							when @FieldYangDibandingkan='PRESTASI' then
								case
									when @OrderBulan='BI' then R_PKBKgLateks_BI+R_PKBKgTBS_BI+R_PKBKgPucuk_BI+R_PKBPanenLainnya_BI+R_PKBHasilPemeliharaan_BI+R_PKBHasilLainnya_BI +
																A_PKBKgLateks_BI+A_PKBKgTBS_BI+A_PKBKgPucuk_BI+A_PKBPanenLainnya_BI+A_PKBHasilPemeliharaan_BI+A_PKBHasilLainnya_BI
									else R_PKBKgLateks_SBI+R_PKBKgTBS_SBI+R_PKBKgPucuk_SBI+R_PKBPanenLainnya_SBI+R_PKBHasilPemeliharaan_SBI+R_PKBHasilLainnya_SBI +
											A_PKBKgLateks_SBI+A_PKBKgTBS_SBI+A_PKBKgPucuk_SBI+A_PKBPanenLainnya_SBI+A_PKBHasilPemeliharaan_SBI+A_PKBHasilLainnya_SBI
								end
							when @FieldYangDibandingkan='PROTAS' then
								case
									when @OrderBulan='BI' then (R_PKBKgLateks_BI+R_PKBKgTBS_BI+R_PKBKgPucuk_BI+R_PKBPanenLainnya_BI+
																A_PKBKgLateks_BI+A_PKBKgTBS_BI+A_PKBKgPucuk_BI+A_PKBPanenLainnya_BI)/
															(case 
																when @Layer='Kebun' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun=A.KodeBlok and [status]='TM')
																when @Layer='Afdeling' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling=A.KodeBlok and [status]='TM')
																else (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling+kodeblok=A.KodeBlok and [status]='TM')
															end) 
																
									else (R_PKBKgLateks_SBI+R_PKBKgTBS_SBI+R_PKBKgPucuk_SBI+R_PKBPanenLainnya_SBI+
											A_PKBKgLateks_SBI+A_PKBKgTBS_SBI+A_PKBKgPucuk_SBI+A_PKBPanenLainnya_SBI)/
															(case 
																when @Layer='Kebun' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun=A.KodeBlok and [status]='TM')
																when @Layer='Afdeling' then (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling=A.KodeBlok and [status]='TM')
																else (select SUM(luas) from [SPDK_KBN_KONSOL].[dbo].[Ref_Areal] where kodebudidaya=@Budidaya and kodekebun+kodeafdeling+kodeblok=A.KodeBlok and [status]='TM')
															end) 
											
								end
							else
								case
									when @OrderBulan='BI' then R_RKAPRpGaji_BI+A_RKAPRpGaji_BI
									else R_RKAPRpGaji_SBI+A_RKAPRpGaji_SBI
								end
								
						end
				end
		--	Value3, 
		--	Warna
		from #f as A
		order by KodeBlok
END
