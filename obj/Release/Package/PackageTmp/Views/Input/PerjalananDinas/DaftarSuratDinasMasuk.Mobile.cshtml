<script src="@Url.Content("~/ReportViewer/js/telerikReportViewer-10.2.16.725.js")"></script>
@*<script src="~/Scripts/PerjalananDinas/DaftarSuratDinasMasuk.js"></script>*@
@*<script src="~/Scripts/PDFObject.js"></script>*@
<img id="progress" src="~/Content/Images/ajax-loader.gif" style="position: absolute; left: 50%; top: 50%; " />
@*@(
                // All deferred initialization statements will be rendered here
                Html.TelerikReporting().DeferredScripts()
    )*@

<!--Reference the SignalR library. -->
<script src="@Url.Content("~/Scripts/jquery.signalR-2.2.1.min.js")"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="@Url.Content("~/signalr/hubs")"></script>

<!--header-->
@Html.Kendo().TextBox().Name("namaUser").Value(HttpContext.Current.User.Identity.Name).HtmlAttributes(new { style = "display: none;" })
<div id="_header" style="font-size:10px;" ng-app="__header">
    <div class="k-content" ng-controller="MyCtrl">
        <form kendo-validator="validator" ng-submit="validate($event)">
            <table width="100%" class="hdr">
                <tr>
                    <td>
                        <div style="text-align:center">@ViewBag.Title</div>
                    </td>
                </tr>
            </table>
            <div class="_headerteh">
                <table width="100%;" align="center">
                    <tr>
                        <td width="100%;">
                            <label id="msgInputView" style="text-align:center; color: white; background-color: red; font-size: medium;"></label>
                        </td>
                    </tr>
                </table>

                @(Html.Kendo().TextBox().Name("UnitId").Value(Ptpn8.Models.CRUDApplicationUser.CRUD.Get1Record(HttpContext.Current.User.Identity.Name).PosisiLokasiKerjaId.ToString()).HtmlAttributes(new { style = "width: 100%; display: none" }))

                <table width="100%;">
                <tr>
                    <td width="20%">
                        <label style="text-align:left">Tahun Disposisi:</label>
                    </td>
                    <td width="50%">
                        @(Html.Kendo().NumericTextBox().Name("TahunBuku").Min(2016).Format("D4")
                        .HtmlAttributes(new { @class = "allcaps" })
                        .Value(DateTime.Now.Year)
                        )

                    </td>
                </tr>
                <tr>
                    <td>
                        <label style="text-align:left">Bulan Disposisi:</label>
                    </td>
                    <td>
                        @(Html.Kendo().DropDownList().Name("ddlBulan").DataTextField("Text").DataValueField("Value")
        .Events(ev => ev.Select("ddlBulanOnSelect"))
        .SelectedIndex(DateTime.Now.Month - 1)
        .BindTo(new List<SelectListItem>()
        {
                                                            new SelectListItem() {
                                                                Text = "Januari",
                                                                Value = "1"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "Februari",
                                                                Value = "2"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "Maret",
                                                                Value = "3"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "April",
                                                                Value = "4"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "Mei",
                                                                Value = "5"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "Juni",
                                                                Value = "6"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "Juli",
                                                                Value = "7"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "Agustus",
                                                                Value = "8"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "September",
                                                                Value = "9"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "Oktober",
                                                                Value = "10"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "November",
                                                                Value = "11"
                                                            },
                                                            new SelectListItem() {
                                                                Text = "Desember",
                                                                Value = "12"
                                                            }
        })
                        )

                    </td>
                </tr>

                <tr>
                    <td></td>
                    <td width="100%" align="left">
                        <div class="confirm">
                            <button type="button" id="btnProses" onclick="btnProsesOnClick()" class="k-button" style="color: white; background-color: gray; font-size: small; height: 30px;"><span class="k-font-icon k-i-print"></span>View</button>
                        </div>
                    </td>
                </tr>
                </table>
            </div>
        </form>
    </div>
</div>

@*detail*@
<div id="_detail" class="_detail">
    @(Html.Kendo()
        .Grid<Ptpn8.Models.MemoOnline.View_SuratDinasMasuk>()
        .Name("grdDetail")
        .Columns(c =>
        {
            c.Bound(i => i.SuratDinasMasukId).Width(50).Hidden();
            c.Bound(i => i.TahunAgenda).Title("Tahun").Width(50).Hidden();
            c.Bound(j => j.NoAgenda).Title("Nomor").Width(50).Hidden();
            c.Bound(j => j.StatusSuratDinas).Title("Status").Width(70).Hidden();
            c.Bound(j => j.Nomor_SuratMasuk).Title("No Surat").Width(70).Hidden();
            c.Bound(j => j.Tanggal_SuratMasuk).Title("Tanggal").Width(70).Format("{0:dd/MM/yyyy}").Hidden();
            c.Bound(j => j.Pengirim_SuratMasuk).Title("Pengirim");//.Width(150);
            c.Bound(j => j.Perihal_SuratMasuk).Title("Perihal");//.Width(250);
            c.Bound(j => j.NamaTujuan_SuratDinasMasuk).Title("Ditujukan");//.Width(100);
            c.Command(command =>
            {
                command.Custom("BuatSuratPengantar").Text("Buat Memo Pengantar").Click("buatSuratPengantar")
                    .HtmlAttributes(new { @class = "k-button", style = "font-size: small; color: white; background-color: green; color: white;" });
            });//.Width(200);
        })
        .AutoBind(false)
        .Navigatable()
        .Resizable(resizeable => resizeable.Columns(true))
        .Scrollable()
        .Excel(excel => excel.AllPages(true))
        .Sortable()
        .Groupable()
        .Filterable()
        //.HtmlAttributes(new { style = "Height: 450px" })
        .ClientDetailTemplateId("kirimSuratDinas")
        .Events(ev => ev.DataBound("grdOnDataBound"))
        .DataSource(o => o
            .Ajax()
            .ServerOperation(false)
            .Sort(s => s.Add(x => x.Tanggal_SuratMasuk).Descending())
            .Batch(true)
            .Model(model =>
            {
                model.Id(p => p.SuratDinasMasukId);
            })
            .Read(read => read.Action("GetDataFromGRID", "Input").Data("filterdetailRead").Type(HttpVerbs.Post))
        )
    )
</div>

<script id="kirimSuratDinas" type="text/kendo-tmpl">
    @(Html.Kendo()
                        .Grid<Ptpn8.Models.MemoOnline.ViewKirim_MemoDinas>()
                        .Name("grdKirimMemoDinas_#=SuratDinasMasukId#")
                        .Columns(c =>
                        {
                            c.Bound(i => i.Kirim_MemoDinasId).Width(50).Hidden();
                            c.Bound(i => i.StatusDistribusi).Width(50).Hidden();
                            c.Bound(i => i.StatusTindakLanjutMemoDinas).Title("T/L").Width(50);
                            c.Bound(j => j.Nomor_MemoDinasView).Title("Nomor").Width(120);
                            c.Bound(j => j.Tanggal_MemoDinas).Title("Tanggal Memo").Width(70);
                            c.Bound(j => j.Perihal_MemoDinas).Title("Perihal").Width(200);
                            c.Bound(j => j.NamaTujuan_MemoDinas).Title("Tujuan").Width(120);
                            c.Bound(j => j.CCNamaTujuan_MemoDinas).Title("Tembusan").Width(200);
                            c.Bound(j => j.StatusMemoDinas).Title("Status").Width(70);
                            c.Command(command =>
                            {
                                command.Custom("IsiMemo").Text("View").Click("openWindowIsiMemo")
                                    .HtmlAttributes(new { @class = "k-button k-font-icon k-i-justify-clear", style = "font-size: small; font-weight: 500;" });
                            }).Width(50);

                        })
                        .ClientDetailTemplateId("terimaMemoDinas")
                        .Events(ev => ev.DataBound("grdOnDataBoundTL"))
                        .DataSource(o => o
                            .Ajax()
                            .Sort(s => s.Add(x => x.Tanggal_MemoDinas).Descending())
                            .Model(model =>
                            {
                                model.Id(p => p.Kirim_MemoDinasId);
                            })
                            .Read(read => read.Action("GetDataFromGRID", "Input").Data("filterdetailReadKirimMemoDinas('#=SuratDinasMasukId#')").Type(HttpVerbs.Post))
                        )
                        .ToClientTemplate()
    )

</script>

<script id="terimaMemoDinas" type="text/kendo-tmpl">
    @(Html.Kendo().Grid<Ptpn8.Models.MemoOnline.ViewTerima_MemoDinas>()
                                        .Name("grdTerimaMemoDinas_#=Kirim_MemoDinasId#")
                                        .Columns(column =>
                                        {
                                            column.Bound(o => o.Terima_MemoDinasId).Width(100).Hidden();
                                            column.Bound(o => o.Kirim_MemoDinasId).Width(100).Hidden();
                                            column.Bound(o => o.NamaUnit).Width(100).Title("Penerima").HeaderHtmlAttributes(new { style = "background-color: darkgreen;" });
                                            column.Bound(o => o.NomorTerima_MemoDinas).Title("No Terima").Width(50).HeaderHtmlAttributes(new { style = "background-color: darkgreen;" }).Hidden();
                                            column.Bound(o => o.TanggalTerima_MemoDinas).Title("Tanggal Terima").Width(100).Format("{0:dd/MM/yyyy}").HeaderHtmlAttributes(new { style = "background-color: darkgreen;" });
                                            column.Bound(o => o.StatusTerimaMemoDinas).Title("Status").Width(100).HeaderHtmlAttributes(new { style = "background-color: darkgreen;" });

                                            column.Group(i => i
                                                .Title("Disposisi")
                                                .HeaderHtmlAttributes(new { style = "background-color: darkgreen;" })
                                                .Columns(c =>
                                                {
                                                    c.Bound(q => q.IsiDisposisi_MemoDinas).Title("Disp").Width(100).HeaderHtmlAttributes(new { style = "background-color: darkgreen;" });
                                                    c.Bound(q => q.PenjelasanDisposisi_MemoDinas).Title("Catatan").Width(100).HeaderHtmlAttributes(new { style = "background-color: darkgreen;" });
                                                })
                                            );
                                            column.Bound(o => o.TujuanDisposisi_MemoDinas).Title("Didistribusikan").Width(200).HeaderHtmlAttributes(new { style = "background-color: darkgreen;" });
                                        })
                                        .ClientDetailTemplateId("tindakLanjutMemoDinas")
                                        .HtmlAttributes(new { style = "background-color: cornflowerblue;" })
                                        .DataSource(datasource => datasource
                                        .Ajax()
                                        .Model(model =>
                                        {
                                            model.Id(p => p.Terima_MemoDinasId);
                                        })
                                        .Read(read => read.Action("GetDataFromGRID", "Input").Data("filterdetailReadTerimaMemoDinas('#=Kirim_MemoDinasId#')").Type(HttpVerbs.Post))
                                        )
                                        .ToClientTemplate()
    )
</script>


<script id="tindakLanjutMemoDinas" type="text/kendo-tmpl">
    @(Html.Kendo().Grid<Ptpn8.Models.MemoOnline.ViewTindakLanjut_MemoDinas>()
                                                .Name("grdTindakLanjutMemoDinas_#=Terima_MemoDinasId#")
                                                .Columns(column =>
                                                {
                                                    column.Bound(o => o.TindakLanjut_MemoDinasId).Width(100).Hidden();
                                                    column.Bound(o => o.Terima_MemoDinasId).Width(100).Hidden();
                                                    column.Bound(o => o.NamaUnit).Width(100).Title("Unit").HeaderHtmlAttributes(new { style = "background-color: darkred;" });
                                                    column.Bound(o => o.TanggalTL_MemoDinas).Title("Tanggal TL").Width(70).Format("{0:dd/MM/yyyy}").HeaderHtmlAttributes(new { style = "background-color: darkred;" });
                                                    column.Bound(o => o.StatusTindakLanjutMemoDinas).Title("Status").Width(50).HeaderHtmlAttributes(new { style = "background-color: darkred;" });
                                                    column.Bound(o => o.PenjelasanTindakLanjut_MemoDinas).Title("Penjelasan").Width(200).HeaderHtmlAttributes(new { style = "background-color: darkred;" });
                                                    column.Bound(o => o.PICTL_MemoDinas).Title("PIC").Width(70).HeaderHtmlAttributes(new { style = "background-color: darkred;" });
                                                    column.Bound(o => o.KeteranganSelesai_MemoDinas).Title("Keterangan Selesai").Width(200).HeaderHtmlAttributes(new { style = "background-color: darkred;" });
                                                    column.Bound(o => o.TanggalSelesai_MemoDinas).Title("Tanggal Selesai").Width(70).Format("{0:dd/MM/yyyy}").HeaderHtmlAttributes(new { style = "background-color: darkred;" });
                                                    column.Command(command =>
                                                    {
                                                        command.Custom("BuktiSelesai").Text("View Bukti").Click("openWindowBuktiSelesai")
                                                            .HtmlAttributes(new { @class = "k-button k-font-icon k-i-justify-clear", style = "font-size: small; font-weight: 500;" });
                                                    }).Width(50);

                                                })
                                                .HtmlAttributes(new { style = "background-color: cadetblue;" })
                                                .DataSource(datasource => datasource
                                                .Ajax()
                                                .Model(model =>
                                                {
                                                    model.Id(p => p.TindakLanjut_MemoDinasId);
                                                })
                                                .Read(read => read.Action("GetDataFromGRID", "Input").Data("filterdetailReadTLMemoDinas('#=Terima_MemoDinasId#')").Type(HttpVerbs.Post))
                                                )
                                                .ToClientTemplate()
    )
</script>
@*footer*@
<div id="_footer">
</div>

@*<div id="wIsiSuratDinas" title="Isi Surat Dinas" style="font-size: medium;">
        <table>
            <tr>
                <td></td>
                <td>No Surat:</td>
                <td><label id="_Nomor_SuratMasuk"></label></td>
            </tr>
            <tr>
                <td></td>
                <td>Tanggal Surat:</td>
                <td><label id="_Tanggal_SuratMasuk"></label></td>
            </tr>
            <tr>
                <td></td>
                <td>Pengirim:</td>
                <td><label id="_Pengirim_SuratMasuk"></label></td>
            </tr>
            <tr>
                <td></td>
                <td>Perihal:</td>
                <td><label id="_Perihal_SuratMasuk"></label></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td>
                    @(
                            Html.Kendo().PanelBar().Name("panelSuratMasuk")
                            .HtmlAttributes(new { style = "width:490px;" })
                                .Items(pnl =>
                                {
                                    pnl.Add().Text("Isi Surat").Content(@<img id="img1" class="imgSuratMasuk" />);
                            }
                            )
                     )
                </td>
            </tr>
        </table>
    </div>*@

<div id="wBuatMemoPengantar" title="Buat Memo Pengantar" style="font-size: smaller;">

</div>

@*<div id = "wDisposisiSuratDinas" title="Disposisi Surat Dinas" style="font-size: smaller;">
        <table width = "100%" >
            <tr>
                <td width="15%">
                    <label>Sifat Surat:</label>
                </td>
                <td>
                    @(Html.Kendo().DropDownList().Name("_SifatSurat")
                                    .DataTextField("Text")
                                    .DataValueField("Value")
                                    .HtmlAttributes(new { @readonly = "true" })
                                    .BindTo(new List<SelectListItem>()
                                    {
                                        new SelectListItem()
    {
        Text = "BIASA",
                                            Value = "BIASA"
                                        },
                                        new SelectListItem()
    {
        Text = "SEGERA",
                                            Value = "SEGERA"
                                        },
                                        new SelectListItem()
    {
        Text = "PENTING",
                                            Value = "PENTING"
                                        },
                                        new SelectListItem()
    {
        Text = "RAHASIA",
                                            Value = "RAHASIA"
                                        }
                                    })
                    )
                </td>
            </tr>
            <tr>
                <td><label>Ditujukan Kepada:</label></td>
                <td>
                    <table width = "100%" style="border:solid; border-width: thin; text-align: center;">
                        <tr>
                            <td style = "border: solid; border-width: thin;" width="25%">
                                <input type = "checkbox" id="fieldlistDitujukanA" value="C6DFDB6D-056E-45CC-9D07-A2207FF5FCC3">
                                <label>DIR-UT</label>
                                <table width = "100%" style="text-align: center;">
                                    <tr>
                                        <td style = "border-top: solid; border-width: thin;" >
                                            <label> I.1</label>
                                            <input type = "checkbox" id="fieldlistDitujukan1" value="C7A94AC2-6148-400D-9235-A5DE1837A55F">
                                            <label>CS</label>
                                        </td>
                                        <td style = "border-top: solid; border-left: solid; border-right:solid; border-width: thin;" >
                                            <label> I.2</label>
                                            <input type = "checkbox" id="fieldlistDitujukan2" value="580A7BA1-31E5-4337-ABB2-24A07F5E9778">
                                            <label>SPI</label>
                                        </td>
                                        <td style = "border-top: solid; border-width: thin;" >
                                            <label> I.3</label>
                                            <input type = "checkbox" id="fieldlistDitujukan8" value="30D4C2DB-8BB4-4EE6-884D-6FFBEF181D11">
                                            <label>RENBANG</label>
                                        </td>
                                        <td style = "border-top: solid; border-width: thin;" >
                                            <label> I.4</label>
                                            <input type = "checkbox" id="fieldlistDitujukan3" value="8FC50B2C-2A83-42CD-9C3C-0A14B6C9CD5A">
                                            <label>TI</label>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                            <td style = "border: solid; border-width: thin;" width="25%">
                                <input type = "checkbox" id="fieldlistDitujukanB" value="BDD778FE-BE35-42D7-A891-4B2BE7126CC7">
                                <label>DIR-OP</label>
                                <table width = "100%" style="text-align: center;">
                                    <tr>
                                        <td style = "border-top: solid; border-width: thin;" >
                                            <label> II.1</label>
                                            <input type = "checkbox" id="fieldlistDitujukan4" value="72928006-34F6-46D7-B668-4CA588DF714F">
                                            <label>TAN</label>
                                        </td>
                                        <td style = "border-top: solid; border-left: solid; border-width: thin;" >
                                            <label> II.2</label>
                                            <input type = "checkbox" id="fieldlistDitujukan5" value="78D31B7B-DA29-4A49-B77B-861EE5458D6B">
                                            <label>T.POL</label>
                                        </td>
                                    </tr>
                                </table>

                            </td>
                            <td style = "border: solid; border-width: thin;" width="25%">
                                <input type = "checkbox" id="fieldlistDitujukanD" value="24BDBB95-0CD5-463E-9ABC-A4B03AB70A1A">
                                <label>DIR-KM</label>
                                <table width = "100%" style="text-align: center;">
                                    <tr>
                                        <td style = "border-top: solid; border-width: thin;" >
                                            <label> III.1</label>
                                            <input type = "checkbox" id="fieldlistDitujukan9" value="BBEEFC43-26E5-4F66-9DE3-D523A5462855">
                                            <label>KEU</label>
                                        </td>
                                        <td style = "border-top: solid; border-left: solid; border-right:solid; border-width: thin;" >
                                            <label> III.2</label>
                                            <input type = "checkbox" id="fieldlistDitujukan10" value="0AAFC5BE-96ED-4213-AEB4-6B8808404878">
                                            <label>AKT</label>
                                        </td>
                                        <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                            <label> III.3</label>
                                            <input type = "checkbox" id="fieldlistDitujukan11" value="F0D332DB-817A-479B-A229-FF31BBBB3872">
                                            <label>PBJ</label>
                                        </td>
                                        <td style = "border-top: solid; border-width: thin;" >
                                            <label> III.4</label>
                                            <input type = "checkbox" id="fieldlistDitujukan6" value="A492B23A-E11F-4650-BC19-A48713AFEFB6">
                                            <label>HC</label>
                                        </td>
                                        <td style = "border-top: solid; border-left: solid; border-right:solid; border-width: thin;" >
                                            <label> III.5</label>
                                            <input type = "checkbox" id="fieldlistDitujukan7" value="977EF1BF-D05F-4680-9080-58093FBE7D95">
                                            <label>HK-UM</label>
                                        </td>
                                        <td style = "border-top: solid; border-width: thin;" >
                                            <label> III.6</label>
                                            <input type = "checkbox" id="fieldlistDitujukan12" value="2FD211DD-610D-4EB7-B209-F4D1ED24D1CB">
                                            <label>PSR</label>
                                        </td>
                                    </tr>
                                </table>

                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <table width = "100%" style="border:solid; border-width: thin; text-align: center;">
                        <tr>
                            <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                < input type="checkbox" id="fieldlistDitujukan14" value="FD73DF57-2F13-4A4D-980F-BEB92EBED1FC">
                                <label>SSK-DU</label>
                            </td>
                            <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                < input type="checkbox" id="fieldlistDitujukan15" value="E89C016D-D5F2-460F-8E88-225695B257B7">
                                <label>HSR</label>
                            </td>
                            <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                < input type="checkbox" id="fieldlistDitujukan16" value="DD9B064B-6A3C-43EE-A3DC-8CF8E100A4BF">
                                <label>I-TEH</label>
                            </td>
                            <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                < input type="checkbox" id="fieldlistDitujukan17" value="147031BD-D0E2-4730-87B8-F12E2E1EE1FC">
                                <label>I-ASA</label>
                            </td>
                            <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                < input type="checkbox" id="fieldlistDitujukan18" value="329AAF85-2087-4F41-B4F6-304C70A178C0">
                                <label>I-AGR</label>
                            </td>
                            <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                < input type="checkbox" id="fieldlistDitujukan20" value="E8B60A6F-C658-44A4-9486-DFEF5EADE092">
                                <label>GM-TEH 1</label>
                            </td>
                            <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                < input type="checkbox" id="fieldlistDitujukan19" value="60A6881F-B09B-440D-8742-778D83A455C1">
                                <label>GM-TEH 2</label>
                            </td>
                            <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                < input type="checkbox" id="fieldlistDitujukan21" value="E7F2EB45-A6FF-4FBD-9006-5FB34F7AFDC1">
                                <label>GM-KRT</label>
                            </td>
                            <td style = "border-top: solid; border-right:solid; border-width: thin;" >
                                < input type="checkbox" id="fieldlistDitujukan22" value="C4F3C41D-AAE2-44BD-8C8A-A22DFD50BA66">
                                <label>GM-SWT</label>
                            </td>
                        </tr>

                    </table>
                </td>

            </tr>
            <tr>
                <td><label>Disposisi</label></td>
                <td>
                    <table width = "100%" >
                        <tr>
                            <td width="50%">
                                <ul class="fieldlistDisposisi">
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi1" name="fieldlistDisposisi1"><label id = "lblDisposisi1" class="chxDisable">Setuju</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi2" name="fieldlistDisposisi2"><label id = "lblDisposisi2" class="chxDisable">Tolak</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi3" name="fieldlistDisposisi3"><label id = "lblDisposisi3" class="chxDisable">Kaji & Saran</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi4" name="fieldlistDisposisi4"><label id = "lblDisposisi4" class="chxDisable">Bicarakan Dengan Saya</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi5" name="fieldlistDisposisi5"><label id = "lblDisposisi5" class="chxDisable">Jawab</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi6" name="fieldlistDisposisi6"><label id = "lblDisposisi6" class="chxDisable">Selesaikan</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi7" name="fieldlistDisposisi7"><label id = "lblDisposisi7" class="chxDisable">Perbaiki</label>
                                    </li>
                                </ul>

                            </td>
                            <td>
                                <ul class="fieldlistDisposisi">
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi8" name="fieldlistDisposisi8"><label id = "lblDisposisi8" class="chxDisable">Edarkan</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi9" name="fieldlistDisposisi9"><label id = "lblDisposisi9" class="chxDisable">Untuk Perhatian</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id= "fieldlistDisposisi10" name= "fieldlistDisposisi10" >< label id= "lblDisposisi10" class="chxDisable">Untuk Diketahui</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id= "fieldlistDisposisi11" name= "fieldlistDisposisi11" >< label id= "lblDisposisi11" class="chxDisable">Sesuai Penjelasan</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id= "fieldlistDisposisi12" name= "fieldlistDisposisi12" >< label id= "lblDisposisi12" class="chxDisable">Ingatkan</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi13" name="fieldlistDisposisi13"><label id = "lblDisposisi13" class="chxDisable">Simpan</label>
                                    </li>
                                    <li>
                                        <input type = "checkbox" id="fieldlistDisposisi14" name="fieldlistDisposisi14"><label id = "lblDisposisi14" class="chxDisable">Perbanyak</label>
                                    </li>
                                </ul>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td><label>Penjelasan</label></td>
                <td>
                    @Html.TextArea("penjelasan", "", new { @class = "k-textbox", style = "width: 90%; height: 150px;" })
                </td>
            </tr>
            <tr>
                <td><label>Tanggal:</label></td>
                <td>@Html.Kendo().DateTimePicker().Name("tgldisposisi").HtmlAttributes(new { @readonly = "true" })</td>
            </tr>
        </table>

        <p></p>
        <table width = "100%" >
            <tr>
                <td align="center">
                    @Html.Kendo().Button().Name("btnBatalDisposisi").Events(ev => ev.Click("btnBatalDisposisiOnClick")).Content("Ok")
                </td>
            </tr>
        </table>
    </div>*@

<div id="wIsiMemo" title="View Memo" style="display: block;">
    <table width="100%">
        <tr>
            <td>
                <p>
                    <label style="font-size:x-large; font-weight:600; text-align:center;">MEMO</label>
                </p>
                <p>
                    <table>
                        <tr>
                            <td width="20%"> Nomor:</td>
                            <td><label id="_NoMemo"></label></td>
                        </tr>
                        <tr>
                            <td> Kepada:</td>
                            <td><label id="_Kepada"></label></td>
                        </tr>
                        <tr>
                            <td> Dari:</td>
                            <td><label id="_Dari"></label></td>
                        </tr>
                        <tr>
                            <td> Perihal:</td>
                            <td><label id="_Perihal"></label></td>
                        </tr>
                        <tr>
                            <td> Tanggal:</td>
                            <td><label id="_Tanggal"></label></td>
                        </tr>
                    </table>
                    <div id="yaMemoDistribusi" style="display:none;">
                        <table>
                            <tr>
                                <td width="4%"></td>
                                <td width="15%"></td>
                                <td><label>DISTRIBUSI SURAT MASUK</label><label id="_TahunAgenda_SuratMasuk" style="display: none;"></label></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td><label id="_NomorAgenda_SuratMasuk" style="display: none;"></label></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>No Surat:</td>
                                <td><label id="_Nomor_SuratMasuk"></label></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td> Tanggal Surat:</td>
                                <td><label id="_Tanggal_SuratMasuk"></label></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td> Pengirim:</td>
                                <td><label id="_Pengirim_SuratMasuk"></label></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td> Perihal:</td>
                                <td><label id="_Perihal_SuratMasuk"></label></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td>
                                    @(
                                                Html.Kendo().PanelBar().Name("panelSuratMasuk")
                                                    .HtmlAttributes(new { style = "width:490px;" })
                                                    .Items(pnl =>
                                                {
                                                    pnl.Add().Text("Isi Surat (Hasil Scan)").Content(@<img id="img1" class="imgSuratMasuk" />);
                            pnl.Add().Text("Disposisi Direksi (Hasil Scann)").Content(@<img id="imgdisposisi" class="imgSuratMasuk" />);
    pnl.Add().Text("Disposisi Direksi").Content(
@<div title="Disposisi Surat Dinas" style="font-size: smaller;">
     <table width="100%">
         <tr>
             <td width="15%">
                 <label>Sifat Surat:</label>
             </td>
             <td>
                 @(Html.Kendo().DropDownList().Name("_SifatSurat")
.DataTextField("Text")
.DataValueField("Value")
.HtmlAttributes(new { @readonly = "true" })
.BindTo(new List<SelectListItem>()
{
                                                     new SelectListItem() {
                                                     Text = "BIASA",
                                                     Value = "BIASA"
                                                     },
                                                     new SelectListItem() {
                                                     Text = "SEGERA",
                                                     Value = "SEGERA"
                                                     },
                                                     new SelectListItem() {
                                                     Text = "PENTING",
                                                     Value = "PENTING"
                                                     },
                                                     new SelectListItem() {
                                                     Text = "RAHASIA",
                                                     Value = "RAHASIA"
                                                     }
})
                 )
             </td>
         </tr>
         <tr>
             <td><label>Ditujukan Kepada:</label></td>
             <td>
                 <table width="100%" style="border:solid; border-width: thin; text-align: center;">
                     <tr>
                         <td style="border: solid; border-width: thin;" width="25%">
                             <input type="checkbox" id="fieldlistDitujukanA" value="C6DFDB6D-056E-45CC-9D07-A2207FF5FCC3">
                             <label>DIREKTUR</label>
                             <table width="100%" style="text-align: center;">
                                 <tr>
                                     <td style="border-top: solid; border-width: thin;">
                                         <label>I.1</label>
                                         <input type="checkbox" id="fieldlistDitujukan1" value="203BB8F7-5983-4C65-936F-9C3D83486428">
                                         <label>CS</label>
                                     </td>
                                     <td style="border-top: solid; border-left: solid; border-right:solid; border-width: thin;">
                                         <label>I.2</label>
                                         <input type="checkbox" id="fieldlistDitujukan2" value="203BB8F7-5983-4C65-936F-9C3D83486429">
                                         <label>SPI</label>
                                     </td>
                                 </tr>
                             </table>
                         </td>
                         <td style="border: solid; border-width: thin;" width="25%">
                             <input type="checkbox" id="fieldlistDitujukanC" value="78DD72E8-18BA-4A78-85FE-578923128A95">
                             <label>OPS. I</label>
                             <table width="100%" style="text-align: center;">
                                 <tr>
                                     <td style="border-top: solid; border-width: thin;">
                                         <label>II.1</label>
                                         <input type="checkbox" id="fieldlistDitujukan4" value="203BB8F7-5983-4C65-936F-9C3D83486430">
                                         <label>OPS TEH & ANTAN</label>
                                     </td>
                                 </tr>
                             </table>
                         </td>
                         <td style="border: solid; border-width: thin;" width="25%">
                             <input type="checkbox" id="fieldlistDitujukanB" value="BDD778FE-BE35-42D7-A891-4B2BE7126CC7">
                             <label>OPS. II</label>
                             <table width="100%" style="text-align: center;">
                                 <tr>
                                     <td style="border-top: solid; border-width: thin;">
                                         <label>II.1</label>
                                         <input type="checkbox" id="fieldlistDitujukan5" value="203BB8F7-5983-4C65-936F-9C3D83486431">
                                         <label>OPS SAWIT & KARET</label>
                                     </td>
                                 </tr>
                             </table>
                         </td>
                         <td style="border: solid; border-width: thin;" width="25%">
                             <input type="checkbox" id="fieldlistDitujukanD" value="24BDBB95-0CD5-463E-9ABC-A4B03AB70A1A">
                             <label>BUSINESS SUPPORT</label>
                             <table width="100%" style="text-align: center;">
                                 <tr>
                                     <td style="border-top: solid; border-width: thin;">
                                         <label>III.1</label>
                                         <input type="checkbox" id="fieldlistDitujukan9" value="203BB8F7-5983-4C65-936F-9C3D83486432">
                                         <label>AKT-KEU</label>
                                     </td>
                                     <td style="border-top: solid; border-left: solid; border-right:solid; border-width: thin;">
                                         <label>III.2</label>
                                         <input type="checkbox" id="fieldlistDitujukan10" value="203BB8F7-5983-4C65-936F-9C3D83486433">
                                         <label>SDM</label>
                                     </td>
                                     <td style="border-top: solid; border-right:solid; border-width: thin;">
                                         <label>III.3</label>
                                         <input type="checkbox" id="fieldlistDitujukan11" value="203BB8F7-5983-4C65-936F-9C3D83486434">
                                         <label>PU&TI</label>
                                     </td>
                                     <td style="border-top: solid; border-width: thin;">
                                         <label>III.4</label>
                                         <input type="checkbox" id="fieldlistDitujukan6" value="203BB8F7-5983-4C65-936F-9C3D83486435">
                                         <label>RSO</label>
                                     </td>
                                 </tr>
                             </table>

                         </td>
                     </tr>
                 </table>
             </td>
         </tr>
         <tr>
             <td></td>
             <td>
                 <table width="100%" style="border:solid; border-width: thin; text-align: center;">
                     <tr>
                        <td style="border-top: solid; border-right:solid; border-width: thin;">
                            <input type="checkbox" id="fieldlistDitujukan25" value="203BB8F7-5983-4C65-936F-9C3D83486436">
                            <label>ACS</label>
                        </td>
                        <td style="border-top: solid; border-right:solid; border-width: thin;">
                            <input type="checkbox" id="fieldlistDitujukan24" value="0D342E58-4715-44F5-A912-F3E98242FAA4">
                            <label>OPT. AST</label>
                        </td>
                         <td style="border-top: solid; border-right:solid; border-width: thin;">
                             <input type="checkbox" id="fieldlistDitujukan23" value="0D342E58-4715-44F5-A912-F3E98242FAA3">
                             <label>KAWASAN</label>
                         </td>
                         <td style="border-top: solid; border-right:solid; border-width: thin;">
                             <input type="checkbox" id="fieldlistDitujukan24" value="0D342E58-4715-44F5-A912-F3E98242FAA4">
                             <label>OPT. AST</label>
                         </td>
                         <td style="border-top: solid; border-right:solid; border-width: thin;">
                             <input type="checkbox" id="fieldlistDitujukan20" value="E8B60A6F-C658-44A4-9486-DFEF5EADE092">
                             <label>GM-WILAYAH I</label>
                         </td>
                         <td style="border-top: solid; border-right:solid; border-width: thin;">
                             <input type="checkbox" id="fieldlistDitujukan19" value="60A6881F-B09B-440D-8742-778D83A455C1">
                             <label>GM-WILAYAH II & AGR </label>
                         </td>
                         <td style="border-top: solid; border-right:solid; border-width: thin;">
                             <input type="checkbox" id="fieldlistDitujukan21" value="E7F2EB45-A6FF-4FBD-9006-5FB34F7AFDC1">
                             <label>GM-WILAYAH III & IHT</label>
                         </td>
                         <td style="border-top: solid; border-right:solid; border-width: thin;">
                             <input type="checkbox" id="fieldlistDitujukan22" value="C4F3C41D-AAE2-44BD-8C8A-A22DFD50BA66">
                             <label>GM-WILAYAH IV</label>
                         </td>
                     </tr>
                 </table>
             </td>

         </tr>
         <tr>
             <td><label>Disposisi</label></td>
             <td>
                 <table width="100%">
                     <tr>
                         <td width="50%">
                             <ul class="fieldlistDisposisi">
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi1" name="fieldlistDisposisi1"><label id="lblDisposisi1" class="chxDisable">Setuju</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi1").Label("Setuju").HtmlAttributes(new { @class = "chxDisable" }))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi2" name="fieldlistDisposisi2"><label id="lblDisposisi2" class="chxDisable">Tolak</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi2").Label("Tolak"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi3" name="fieldlistDisposisi3"><label id="lblDisposisi3" class="chxDisable">Kaji & Saran</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi3").Label("Kaji & Saran"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi4" name="fieldlistDisposisi4"><label id="lblDisposisi4" class="chxDisable">Bicarakan Dengan Saya</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi4").Label("Bicarakan Dengan Saya"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi5" name="fieldlistDisposisi5"><label id="lblDisposisi5" class="chxDisable">Jawab</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi5").Label("Jawab"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi6" name="fieldlistDisposisi6"><label id="lblDisposisi6" class="chxDisable">Selesaikan</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi6").Label("Selesaikan"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi7" name="fieldlistDisposisi7"><label id="lblDisposisi7" class="chxDisable">Perbaiki</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi7").Label("Perbaiki"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi15" name="fieldlistDisposisi15"><label id="lblDisposisi15" class="chxDisable">Hadiri</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi7").Label("Perbaiki"))*@
                                 </li>

                             </ul>

                         </td>
                         <td>
                             <ul class="fieldlistDisposisi">
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi8" name="fieldlistDisposisi8"><label id="lblDisposisi8" class="chxDisable">Edarkan</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi8").Label("Edarkan"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi9" name="fieldlistDisposisi9"><label id="lblDisposisi9" class="chxDisable">Untuk Perhatian</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi9").Label("Untuk Perhatian"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi10" name="fieldlistDisposisi10"><label id="lblDisposisi10" class="chxDisable">Untuk Diketahui</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi10").Label("Untuk Diketahui"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi11" name="fieldlistDisposisi11"><label id="lblDisposisi11" class="chxDisable">Sesuai Penjelasan</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi11").Label("Sesuai Penjelasan"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi12" name="fieldlistDisposisi12"><label id="lblDisposisi12" class="chxDisable">Ingatkan</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi12").Label("Ingatkan"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi13" name="fieldlistDisposisi13"><label id="lblDisposisi13" class="chxDisable">Simpan</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi13").Label("Simpan"))*@
                                 </li>
                                 <li>
                                     <input type="checkbox" id="fieldlistDisposisi14" name="fieldlistDisposisi14"><label id="lblDisposisi14" class="chxDisable">Perbanyak</label>
                                     @*@(Html.Kendo().CheckBox().Name("fieldlistDisposisi14").Label("Perbanyak"))*@
                                 </li>
                             </ul>
                         </td>
                     </tr>
                 </table>
             </td>
         </tr>
         <tr>
             <td><label>Penjelasan</label></td>
             <td>
                 @Html.TextArea("penjelasan", "", new { @class = "k-textbox", style = "width: 90%; height: 150px;" })
             </td>
         </tr>
         <tr>
             <td><label>Tanggal:</label></td>
             <td>@Html.Kendo().DateTimePicker().Name("tgldisposisi").HtmlAttributes(new { @readonly = "true" })</td>
         </tr>
     </table>
</div>
                                        );
                }
)
                                    )
                                </td>
            </td>
        </tr>
    </table>
</div>

<table>
    <tr>
        <td>Lampiran:</td>
        <td>
            <table>
                <tr>
                    <td>
                        <label id="_Lampiran_MemoDinas" style="display: none;"></label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="demo-section k-content wide">
                            <div class="wrapper">
                                <div id="daftarFile"></div>
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>
                </p>
<p>
    @Html.Kendo().Editor().Name("isiMemo").Tools(t => t.Clear()).HtmlAttributes(new { style = "border:none;" })

</p>
<p>
    <table>
        <tr>
            <td>
                <label style="font-size:smaller;">Tembusan</label>
            </td>
        </tr>
        <tr>
            <td>
                @Html.Kendo().TreeView().Name("_Tembusan").HtmlAttributes(new { style = "font-size: smaller;" })
            </td>
        </tr>
    </table>
</p>
            </td>
        </tr>
<tr>
    <td>
        @Html.Kendo().QRCode().Name("QRMemoDinas").Value("Uji Coba").Size(120).ErrorCorrection(QRErrorCorrectionLevel.M)
    </td>
</tr>
<tr>
    <td align="center">
        <button id="Ok" class="k-button">Ok</button>
    </td>
</tr>
    </table>
</div>

<div id="wBuktiSelesai" title="Bukti Selesai" style="display: block;">
    <table width="100%">
        <tr>
            <td>
                <label id="_Lampiran_BuktiSelesai" style="display: none;"></label>
            </td>
        </tr>
        <tr>
            <td>
                <div class="demo-section k-content wide">
                    <div class="wrapper">
                        <div id="daftarFileBuktiSelesai"></div>
                    </div>
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <button id="OkBuktiSelesai" type="button">Ok</button>
            </td>
        </tr>
    </table>
</div>


<style>
    ul {
        list-style-type: none;
    }

    .fieldlistDitujukan {
        padding-left: 0;
    }

    .fieldlistDisposisi {
        padding-left: 0;
    }

    table.k-editor {
        border-collapse: collapse;
    }

    .daftarfile {
        float: left;
        position: relative;
        margin: 0 10px 10px 0;
        padding: 0;
        font-size: larger;
        font-weight: 600;
        width: 100%;
    }

        .daftarfile img {
            width: 30px;
            height: 30px;
        }

    .wrapper:after {
        content: ".";
        display: block;
        height: 0;
        clear: both;
        visibility: hidden;
    }

    .sembunyikan {
        color: red;
        background-color: aquamarine;
    }

    .imgSuratMasuk {
        width: 490px;
    }

        .imgSuratMasuk:hover {
            transform: scale(1.5);
        }

    .chxDisable {
        display: inline;
        margin-left: 5px;
    }

    .unChk {
        color: lightgray;
    }

    .fieldlistDitujukan {
        padding-left: 0;
    }

    .fieldlistDisposisi {
        padding-left: 0;
    }
</style>

<script>
    var wndIsiSudin, wndDisposisiSudin, wndBuatMemoPengantar, wndBuktiSelesai;
    var _NomorInputView;
    var model;
    var headerBaru, detailBaru;
    var rowNumber = 0;
    var menuId = '94f44d1a-77de-44ef-abf4-7eb08937257c';

    function resetRowNumber(e) {
        rowNumber = 0;
    }

    function renderNumber(data) {
        var no = ++rowNumber;
        data.NoBaris = no;
        return no;
    }

    $('.k-window.titlebar').css('style', 'display: none');
    $(".k-button-icontext").addClass("k-state-disabled").removeClass("k-grid-add");
    $(document).ajaxStart(function () {
        $("#_header").addClass('disabledbutton');
        $("#_detail").addClass('disabledbutton');
        $("#_footer").addClass('disabledbutton');
        $("#progress").show();
    }).ajaxStop(function () {
        $("#progress").hide();
        $("#_header").removeClass('disabledbutton');
        $("#_detail").removeClass('disabledbutton');
        $("#_footer").removeClass('disabledbutton');
    });

    $(function () {
        hubMemoDinas = $.connection.memoDinasHub;
        $.connection.hub.start().done(function () {
            // sudah terhubung ke hub
        });

        hubMemoDinas.client.suratKeluarMemoDinas = function (data) {
            var grd = $("#grdDetail").data('kendoGrid');
            grd.dataSource.read();
        };

    });

    function hapusPenggunaPortalYangAktif() {
        var url = '/Account/HapusPenggunaPortalYangAktif';
        return $.ajax({
            url: url,
            data: {
                _menuId: menuId
            },
            type: 'POST',
            datatype: 'json'
        });
    }
    $(document).ready(function () {
        wndIsiSudin = $("#wIsiSuratDinas").kendoWindow({
            title: "Isi Surat Dinas",
            modal: true,
            visible: false,
            resizable: true,
            width: 600,
            height: 600
        }).data("kendoWindow");

        wndDisposisiSudin = $("#wDisposisiSuratDinas").kendoWindow({
            title: "Disposisi Surat Dinas",
            modal: true,
            visible: false,
            resizable: true
        }).data("kendoWindow");

        wndBuatMemoPengantar = $("#wBuatMemoPengantar").kendoWindow({
            title: "Buat Memo Pengantar",
            modal: true,
            visible: false,
            resizable: true
        }).data("kendoWindow");


        wndIsiMemo = $("#wIsiMemo").kendoWindow({
            title: "Kirim Memo",
            modal: true,
            visible: false,
            resizable: true
        }).data("kendoWindow");

        wndBuktiSelesai = $("#wBuktiSelesai").kendoWindow({
            title: "Bukti Memo Selesai",
            modal: true,
            visible: false,
            resizable: true
            //width: 800,
            //height: 600
        }).data("kendoWindow");


        gridStatus = 'belum-ngapa-ngapain';
    });

    $(window).on("beforeunload", function () {
        return "Please don't leave me!";
    });

    $(window).on("unload", function () {
        hapusPenggunaPortalYangAktif();
    });

    angular.module("__header", ["kendo.directives"])
        .controller("MyCtrl", function ($scope) {
            $scope.validate = function (event) {
                event.preventDefault();
            }
        });

    function openWindowIsiSudin(e) {
        e.preventDefault();
        var grid = this;
        var row = $(e.currentTarget).closest("tr");
        var data = grid.dataItem(row);

        readSuratMasukSudin(data.TahunAgenda, data.NoAgenda);


    }

    function openWindowBuatMemoPengantar(e) {
        //e.preventDefault();
        //var grid = this;
        //var row = $(e.currentTarget).closest("tr");
        //var data = grid.dataItem(row);

        //wndBuatMemoPengantar.open().center();

        //$("#Ok").click(function () {
        //    wndBuatMemoPengantar.close();
        //});

        //e.preventDefault();
        //$.ajax({
        //    url: 'Input/Input',
        //    data: { aplikasiId: '7b8b79fa-04e7-40a3-a7b5-d1de6bca2b83', menuId: '0dedeaed-9a05-4fa0-9b21-b9c61b3e5f52'},
        //    success: function () {
        //        alert('Added');
        //    }
        //});
    }

    function buatSuratPengantar(e) {
        e.preventDefault();
        var grid = this;
        var row = $(e.currentTarget).closest("tr");
        var data = grid.dataItem(row);

        sisipParameterUntukSuratPengantar(data.SuratDinasMasukId).done(function () {
            window.location.href = "/Input/Input?aplikasiId=7b8b79fa-04e7-40a3-a7b5-d1de6bca2b83&menuId=76633740-79e0-4077-829e-7b45ebd31ac2";
        });
    }

    function sisipParameterUntukSuratPengantar(id) {
        var url = '/Input/buatContextParameter';
        return $.ajax({
            url: url,
            data: {
                namaContext: 'ParameterUntukSuratPengantar',
                isiContext: id
            },
            type: 'POST',
            datatype: 'json'
        });
    }


    function readSuratMasukSudin(thn, no) {
        ambilSuratMasukSudin(thn, no).done(function (dta) {
            if (dta.length > 0) {
                $('#__Nomor_SuratMasuk').text(dta[0][5]);
                $('#__Pengirim_SuratMasuk').text(dta[0][7]);
                $('#__Perihal_SuratMasuk').text(dta[0][9]);
                $('#__Tanggal_SuratMasuk').text(dta[0][4]);
                $('#img1').removeAttr('src');
                $('#img2').removeAttr('src');
                $('#img3').removeAttr('src');
                $('#img4').removeAttr('src');
                $('#img5').removeAttr('src');
                d = new Date();
                if (dta[0][10] == "System.Byte[]") $('#img1').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img1.jpg?' + d.getTime());
                if (dta[0][11] == "System.Byte[]") $('#img2').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img2.jpg?' + d.getTime());
                if (dta[0][12] == "System.Byte[]") $('#img3').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img3.jpg?' + d.getTime());
                if (dta[0][13] == "System.Byte[]") $('#img4').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img4.jpg?' + d.getTime());
                if (dta[0][14] == "System.Byte[]") $('#img5').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img5.jpg?' + d.getTime());
                wndIsiSudin.open().center();
            }
        });
    }

    function ambilSuratMasukSudin(thn, nmr) {
        var url = '/Input/ExecSQL';
        return $.ajax({
            url: url,
            data: {
                scriptSQL: "SET DATEFORMAT DMY; SELECT TOP 1 [thn_agenda],[no_agenda],[tgl_terima],[penerima],[tgl_surat],[no_surat],[kel_pengirim],[pengirim],[kel_perihal],[perihal],[img1],img2,img3,img4,img5,[imgdisposisi] FROM [Sekper].[dbo].[agenda_surat_masuk] WHERE thn_agenda=" + thn + " and no_agenda=" + nmr,
                _menuId: menuId
            },
            type: 'POST',
            datatype: 'json'
        });
    }

    function openWindowDisposisiSudin(e) {
        e.preventDefault();

        var grid = this;
        var row = $(e.currentTarget).closest("tr");
        var __data = grid.dataItem(row);
        dataROW = __data;

        if (__data.StatusSuratDinas == 'SUDIN-DISPOSISI' || __data.StatusSuratDinas == 'SUDIN-KIRIM') {

            var _X = dataROW.CCTujuanId_SuratDinasMasuk.split(',');
            var _Y = dataROW.TujuanId_SuratDinasMasuk.split(',');
            _X.push(_Y[0]);

            wndDisposisiSudin.open().center();

            $('#_SifatSurat').data('kendoDropDownList').value(dataROW.Sifat_SuratDinasMasuk);

            $("#fieldlistDitujukanA").prop("checked", false);
            $("#fieldlistDitujukanB").prop("checked", false);
            $("#fieldlistDitujukanC").prop("checked", false);
            $("#fieldlistDitujukanD").prop("checked", false);
            // DIRUT
            if (_X.join().toUpperCase().search('C6DFDB6D-056E-45CC-9D07-A2207FF5FCC3') > -1) {
                $("#fieldlistDitujukanA").prop('checked', true).prop("disabled", true);
            }
            // DIROP
            if (_X.join().toUpperCase().search('BDD778FE-BE35-42D7-A891-4B2BE7126CC7') > -1) {
                $("#fieldlistDitujukanB").prop('checked', true).prop("disabled", true);
            }
            // DIRMA
            if (_X.join().toUpperCase().search('78DD72E8-18BA-4A78-85FE-578923128A95') > -1) {
                $("#fieldlistDitujukanC").prop('checked', true).prop("disabled", true);
            }
            // DIRKOM
            if (_X.join().toUpperCase().search('24BDBB95-0CD5-463E-9ABC-A4B03AB70A1A') > -1) {
                $("#fieldlistDitujukanD").prop('checked', true).prop("disabled", true);
            }

            $("#fieldlistDitujukanA").prop("disabled", true);
            $("#fieldlistDitujukanB").prop('disabled', true);
            $("#fieldlistDitujukanC").prop('disabled', true);
            $("#fieldlistDitujukanD").prop('disabled', true);


            var arrDitujukan = [];
            for (var i = 24; i > 0; i--) {
                if (typeof ($("#fieldlistDitujukan" + i.toString()).val()) != "undefined") {
                    $("#fieldlistDitujukan" + i.toString()).prop("checked", false);
                }
            }

            var tujuanDisposisi = dataROW.TujuanDisposisi_SuratDinasMasuk;
            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486428") > -1) {
                $("#fieldlistDitujukan1").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan1').addClass('unChk');
                $('#lbl2Ditujukan1').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486429") > -1) {
                $("#fieldlistDitujukan2").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan2').addClass('unChk');
                $('#lbl2Ditujukan2').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486430") > -1) {
                $("#fieldlistDitujukan4").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan4').addClass('unChk');
                $('#lbl2Ditujukan4').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486431") > -1) {
                $("#fieldlistDitujukan5").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan5').addClass('unChk');
                $('#lbl2Ditujukan5').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486435") > -1) {
                $("#fieldlistDitujukan6").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan6').addClass('unChk');
                $('#lbl2Ditujukan6').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486432") > -1) {
                $("#fieldlistDitujukan9").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan9').addClass('unChk');
                $('#lbl2Ditujukan9').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486433") > -1) {
                $("#fieldlistDitujukan10").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan10').addClass('unChk');
                $('#lbl2Ditujukan10').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486434") > -1) {
                $("#fieldlistDitujukan11").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan11').addClass('unChk');
                $('#lbl2Ditujukan11').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("60A6881F-B09B-440D-8742-778D83A455C1") > -1) {
                $("#fieldlistDitujukan19").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan19').addClass('unChk');
                $('#lbl2Ditujukan19').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("E8B60A6F-C658-44A4-9486-DFEF5EADE092") > -1) {
                $("#fieldlistDitujukan20").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan20').addClass('unChk');
                $('#lbl2Ditujukan20').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("E7F2EB45-A6FF-4FBD-9006-5FB34F7AFDC1") > -1) {
                $("#fieldlistDitujukan21").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan21').addClass('unChk');
                $('#lbl2Ditujukan21').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("C4F3C41D-AAE2-44BD-8C8A-A22DFD50BA66") > -1) {
                $("#fieldlistDitujukan22").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan22').addClass('unChk');
                $('#lbl2Ditujukan22').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("0D342E58-4715-44F5-A912-F3E98242FAA3") > -1) {
                $("#fieldlistDitujukan23").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan23').addClass('unChk');
                $('#lbl2Ditujukan23').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("0D342E58-4715-44F5-A912-F3E98242FAA4") > -1) {
                $("#fieldlistDitujukan24").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan24').addClass('unChk');
                $('#lbl2Ditujukan24').addClass('unChk');
            }
            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486436") > -1) {
                $("#fieldlistDitujukan25").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan25').addClass('unChk');
                $('#lbl2Ditujukan25').addClass('unChk');
            }



            for (var i = 1; i <= 25; i++) {
                $("#fieldlistDisposisi" + i.toString()).prop('checked', false).prop("disabled", true);
            }
            arrDisposisi = __data.IsiDisposisi_SuratDinasMasuk.split(",");
            for (var i = 1; i <= 25; i++) {
                if (jQuery.inArray($('#lblDisposisi' + i.toString()).text(), arrDisposisi) > -1) {
                    $("#fieldlistDisposisi" + i.toString()).prop('checked', true).prop("disabled", true);
                }
                else {
                    $('#lblDisposisi' + i.toString()).addClass("unChk");
                }
            }
            $("#penjelasan").val(__data.PenjelasanDisposisi_SuratDinasMasuk).prop("disabled", true);
            $('#tgldisposisi').data('kendoDateTimePicker').value(__data.TanggalDidisposisiOlehDireksi);
        }
    }


    function openWindowIsiMemo(e) {
        e.preventDefault();
        var grid = this;
        var parentGrid = $('#grdDetail').data('kendoGrid');
        var row = $(e.currentTarget).closest("tr");
        var data = grid.dataItem(row);
        var Isi = data.Isi_MemoDinasFinal;

        var detailGridWrapper = this.wrapper
        var parentRow = $(detailGridWrapper).closest("tr").prev();
        var __data = parentGrid.dataItem(parentRow);
        dataROW = __data;

        if (data.SifatSurat_MemoDinas == 'RAHASIA') {
            $('#wIsiMemo').css('display', 'none')
        }
        else {
            $('#wIsiMemo').css('display', 'block')
            wndIsiMemo.open().maximize();
            stringDecode(data.Isi_MemoDinasFinal).done(function (data) {
                $('#isiMemo').data('kendoEditor').value(data);
                $('#isiMemo').data('kendoEditor').body.setAttribute('contenteditable', false);
            });

            $('#_NoMemo').text(data.Nomor_MemoDinasView);
            $('#_Kepada').text(data.NamaTujuan_MemoDinas);
            $('#_Dari').text(data.NamaUnit);
            $('#_Perihal').text(data.Perihal_MemoDinas.toString().toUpperCase());
            $('#_Tanggal').text(data.Tanggal_MemoDinas.getDate().toString() + '/' + (data.Tanggal_MemoDinas.getMonth() + 1).toString() + '/' + data.Tanggal_MemoDinas.getFullYear().toString());

            $('#_Lampiran_MemoDinas').text(data.Lampiran_MemoDinas)

            var listLampiranMemoDinas = data.Lampiran_MemoDinas;
            if (listLampiranMemoDinas == null || listLampiranMemoDinas == '') {
                listLampiranMemoDinas = [];
            }
            else {
                listLampiranMemoDinas = listLampiranMemoDinas.split(',');
            }
            $("#daftarFile").html("")
            for (var i = 0; i < listLampiranMemoDinas.length; i++) {
                listLampiranMemoDinas[i] = listLampiranMemoDinas[i].substr(data.UnitId.toString().length + 1, 100);
                renderNamaFile(listLampiranMemoDinas[i]);
            }

            var treeV = $('#_Tembusan').data('kendoTreeView');
            treeV.dataSource.data([])
            var arrTembusan = data.CCNamaTujuan_MemoDinas.split(',');
            for (var i = 0; i < arrTembusan.length; i++) {
                treeV.append({ id: i, text: '- ' + arrTembusan[i] });
            }

            //var tgl = new Date(parseInt(data.Tanggal_MemoDinas.substr(6)));
            var tgl = data.Tanggal_MemoDinas;
            $('#QRMemoDinas').data('kendoQRCode').value("No Memo: " + data.Nomor_MemoDinasView + "; Kepada: " + data.NamaTujuan_MemoDinas + "; Dari: " + data.NamaUnit + ";" + "Perihal: " + data.Perihal_MemoDinas.toString().toUpperCase() + "; Tanggal: " +
                tgl.getDate().toString() + '/' + tgl.getMonth().toString() + '/' + tgl.getFullYear().toString());

            if (data.StatusDistribusi == true) {
                $('#_TahunAgenda_SuratMasuk').text(data.TahunAgenda_SuratMasuk);
                $('#_NomorAgenda_SuratMasuk').text(data.NomorAgenda_SuratMasuk);
                readSuratMasuk();
                $('#yaMemoDistribusi').show();
            }
            else {
                $('#_TahunAgenda_SuratMasuk').text('');
                $('#_NomorAgenda_SuratMasuk').text('');
                $('#yaMemoDistribusi').hide();
            }


            $("#Ok").click(function () {
                wndIsiMemo.close();
            });
        }

        if (__data.StatusSuratDinas == 'SUDIN-DISPOSISI' || __data.StatusSuratDinas == 'SUDIN-KIRIM') {

            var _X = dataROW.CCTujuanId_SuratDinasMasuk.split(',');
            var _Y = dataROW.TujuanId_SuratDinasMasuk.split(',');
            _X.push(_Y[0]);

            //    wndDisposisiSudin.open().center();

            $('#_SifatSurat').data('kendoDropDownList').value(dataROW.Sifat_SuratDinasMasuk);
            $("#fieldlistDitujukanA").prop("checked", false);
            $("#fieldlistDitujukanB").prop("checked", false);
            $("#fieldlistDitujukanC").prop("checked", false);
            $("#fieldlistDitujukanD").prop("checked", false);
            // DIRUT
            if (_X.join().toUpperCase().search('C6DFDB6D-056E-45CC-9D07-A2207FF5FCC3') > -1) {
                $("#fieldlistDitujukanA").prop('checked', true).prop("disabled", true);
            }
            // DIROP
            if (_X.join().toUpperCase().search('BDD778FE-BE35-42D7-A891-4B2BE7126CC7') > -1) {
                $("#fieldlistDitujukanB").prop('checked', true).prop("disabled", true);
            }
            // DIRMA
            if (_X.join().toUpperCase().search('78DD72E8-18BA-4A78-85FE-578923128A95') > -1) {
                $("#fieldlistDitujukanC").prop('checked', true).prop("disabled", true);
            }
            // DIRKOM
            if (_X.join().toUpperCase().search('24BDBB95-0CD5-463E-9ABC-A4B03AB70A1A') > -1) {
                $("#fieldlistDitujukanD").prop('checked', true).prop("disabled", true);
            }

            $("#fieldlistDitujukanA").prop("disabled", true);
            $("#fieldlistDitujukanB").prop('disabled', true);
            $("#fieldlistDitujukanC").prop('disabled', true);
            $("#fieldlistDitujukanD").prop('disabled', true);


            var arrDitujukan = [];
            for (var i = 24; i > 0; i--) {
                if (typeof ($("#fieldlistDitujukan" + i.toString()).val()) != "undefined") {
                    $("#fieldlistDitujukan" + i.toString()).prop("checked", false);
                }
            }

            var tujuanDisposisi = dataROW.TujuanDisposisi_SuratDinasMasuk;
            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486428") > -1) {
                $("#fieldlistDitujukan1").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan1').addClass('unChk');
                $('#lbl2Ditujukan1').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486429") > -1) {
                $("#fieldlistDitujukan2").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan2').addClass('unChk');
                $('#lbl2Ditujukan2').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486430") > -1) {
                $("#fieldlistDitujukan4").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan4').addClass('unChk');
                $('#lbl2Ditujukan4').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486431") > -1) {
                $("#fieldlistDitujukan5").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan5').addClass('unChk');
                $('#lbl2Ditujukan5').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486435") > -1) {
                $("#fieldlistDitujukan6").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan6').addClass('unChk');
                $('#lbl2Ditujukan6').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486432") > -1) {
                $("#fieldlistDitujukan9").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan9').addClass('unChk');
                $('#lbl2Ditujukan9').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486433") > -1) {
                $("#fieldlistDitujukan10").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan10').addClass('unChk');
                $('#lbl2Ditujukan10').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486434") > -1) {
                $("#fieldlistDitujukan11").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan11').addClass('unChk');
                $('#lbl2Ditujukan11').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("60A6881F-B09B-440D-8742-778D83A455C1") > -1) {
                $("#fieldlistDitujukan19").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan19').addClass('unChk');
                $('#lbl2Ditujukan19').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("E8B60A6F-C658-44A4-9486-DFEF5EADE092") > -1) {
                $("#fieldlistDitujukan20").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan20').addClass('unChk');
                $('#lbl2Ditujukan20').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("E7F2EB45-A6FF-4FBD-9006-5FB34F7AFDC1") > -1) {
                $("#fieldlistDitujukan21").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan21').addClass('unChk');
                $('#lbl2Ditujukan21').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("C4F3C41D-AAE2-44BD-8C8A-A22DFD50BA66") > -1) {
                $("#fieldlistDitujukan22").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan22').addClass('unChk');
                $('#lbl2Ditujukan22').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("0D342E58-4715-44F5-A912-F3E98242FAA3") > -1) {
                $("#fieldlistDitujukan23").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan23').addClass('unChk');
                $('#lbl2Ditujukan23').addClass('unChk');
            }

            if (tujuanDisposisi.toUpperCase().search("0D342E58-4715-44F5-A912-F3E98242FAA4") > -1) {
                $("#fieldlistDitujukan24").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan24').addClass('unChk');
                $('#lbl2Ditujukan24').addClass('unChk');
            }
            if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486436") > -1) {
                $("#fieldlistDitujukan25").prop('checked', true).prop("disabled", true);
            }
            else {
                $('#lbl1Ditujukan25').addClass('unChk');
                $('#lbl2Ditujukan25').addClass('unChk');
            }


            for (var i = 1; i <= 25; i++) {
                $("#fieldlistDisposisi" + i.toString()).prop('checked', false).prop("disabled", true);
            }
            arrDisposisi = __data.IsiDisposisi_SuratDinasMasuk.split(",");
            for (var i = 1; i <= 25; i++) {
                if (jQuery.inArray($('#lblDisposisi' + i.toString()).text(), arrDisposisi) > -1) {
                    $("#fieldlistDisposisi" + i.toString()).prop('checked', true).prop("disabled", true);
                }
                else {
                    $('#lblDisposisi' + i.toString()).addClass("unChk");
                }
            }
            $("#penjelasan").val(__data.PenjelasanDisposisi_SuratDinasMasuk).prop("disabled", true);
            $('#tgldisposisi').data('kendoDateTimePicker').value(__data.TanggalDidisposisiOlehDireksi);
        }
    }

    function renderNamaFile(nmFile) {
        var extension = "";
        var i = nmFile.lastIndexOf('.');
        if (i > 0)
            extension = nmFile.substring(i + 1).toLowerCase().substring(0, 3);
        else
            extension = "";
        $("<p><div class='daftarfile'><table><tr><td><img src='/Content/Images/FileTypeIcon/png/" + extension + ".png'/></td></tr><tr><td>[" + nmFile + "]</td></tr><tr><td><button type='button' onClick='btnViewOnClick(\"" + nmFile + "\")'><span class='k-font-icon k-i-pencil'></span>Lihat</button></td></tr></table></div></p>").appendTo($("#daftarFile"));
    }

    function btnViewOnClick(nmFile) {
        var file = $('#UnitId').val() + '_' + nmFile;
        var newwindow = window.open("/LampiranMemo/" + file, "window2", "");
    }


    function stringDecode(strDecode) {
        var url = '/Input/StringDecode';
        return $.ajax({
            url: url,
            data: {
                str: strDecode
            },
            type: 'POST',
            datatype: 'json'
        });
    }

    function gridDestroy() {
        $("#grdDetail").data("kendoGrid").dataSource.read([]);
    }


    function btnProsesOnClick(e) {
        var grid = $('#grdDetail').data('kendoGrid');
        grid.dataSource.read();
    }

    function cariUserYangLagiNgedit() {
        var url = '/Input/CariUserYangLagiNgedit';
        return $.ajax({
            url: url,
            //contentType: 'application/json; charset=utf-8',
            data: {
                _menuId: menuId
            },
            type: 'POST',
            datatype: 'json'
        });

    }

    function filterNomorInput(e) {
        var mdl = JSON.stringify(ViewToModel());
        return { _model: mdl, _menuId: menuId };
    }

    // Detail

    function grdOnChange(e) {
    }

    function filterGridUpdate(e) {
        var mdl = e.models;
        var arr = [];
        for (var i = 0; i < mdl.length; i++) {
            arr.push(JSON.stringify(mdl[i]));
        }
        return {
            _model: arr,
            _menuId: menuId
        };
    }

    function filterGridDestroy(e) {
        return {
            _model: JSON.stringify(e),
            _menuId: menuId
        };
    }


    function filterdetailRead(e) {
        var nBulan = $('#ddlBulan').data('kendoDropDownList').selectedIndex + 1;
        var nTahun = $('#TahunBuku').val();
        var aa =
            "declare @@direksiId uniqueidentifier;" +
            "set @@direksiId = '" + $('#DireksiId').val() + "'; " +
            "SELECT DISTINCT A.SuratDinasMasukId,A.TahunAgenda, A.NoAgenda, A.UnitId, A.TujuanId_SuratDinasMasuk, " +
            "A.CCTujuanId_SuratDinasMasuk, A.TanggalDikirimKeDireksi, A.Kirim_MemoDinasId, A.TahunBuku, " +
            "A.NomorInput, A.StatusSuratDinas, A.PengirimSuratDinas FROM [SPDK_KanpusEF].[dbo].[eOffice_SuratDinasMasuk] A " +
            "JOIN [SPDK_KanpusEF].[dbo].[eOffice_DisposisiSuratDinasMasuk] B ON A.SuratDinasMasukId = B.SuratDinasMasukId " +
            "where month(B.TanggalDidisposisiOlehDireksi)=" + nBulan.toString() + " and year(B.TanggalDidisposisiOlehDireksi)=" + nTahun.toString() + " " +
            "and (TujuanId_SuratDinasMasuk =@@direksiId or CCTujuanId_SuratDinasMasuk like '%'+ cast(@@direksiId as varchar(50))+'%') " +
            "and StatusSuratDinas in ('SUDIN-DISPOSISI','SUDIN-KIRIM')";

        return {
            strClassView: "Ptpn8.Models.MemoOnline.View_SuratDinasMasuk",
            scriptSQL: aa,
            _menuId: menuId
        };
    }

    function ddlBulanOnSelect(e) {

    }

    function filterdetailReadKirimMemoDinas(a) {
        var aa = "declare @@bulanRomawi varchar(50); set @@bulanRomawi = 'I   II  III IV  V   VI  VII VIIIIX  X   XI  XII '; " +
            "select DISTINCT C.TahunAgenda_SuratMasuk, C.NomorAgenda_SuratMasuk,C.StatusDistribusi,C.Kirim_MemoDinasId, StatusTindakLanjutMemoDinas=case when (select count(*) from [dbo].[eOffice_TindakLanjut_MemoDinas] D where D.Terima_MemoDinasId=A.Terima_MemoDinasId and D.StatusTindakLanjutMemoDinas like 'SELESAI')>0 then 'SELESAI' else 'BELUM SELESAI' end, " +
            "'M/'+B.Nomenklatur+'/'+cast(C.Nomor_MemoDinas as varchar(5))+'/'+substring(@@bulanRomawi,(month(C.Tanggal_MemoDinas)*4)-3,4)+'/'+rtrim(cast(year(C.Tanggal_MemoDinas) as varchar(4))) as Nomor_MemoDinasView, " +
            "C.Tanggal_MemoDinas, C.Perihal_MemoDinas, (select top 1 orgid from [ReferensiEF].[dbo].[Unit] where OrgId=C.TujuanId_MemoDinas) as TujuanId_MemoDinas,(select top 1 NamaUnit from [ReferensiEF].[dbo].[Unit] where OrgId=C.TujuanId_MemoDinas) as NamaTujuan_MemoDinas, C.StatusMemoDinas, C.Lampiran_MemoDinas, " +
            "C.Isi_MemoDinasFinal, [SPDK_KanpusEF].[dbo].[func_ConcatCCTujuan](C.CCTujuanId_MemoDinas) as CCNamaTujuan_MemoDinas " +
            "from [SPDK_KanpusEF].[dbo].[eOffice_Kirim_MemoDinas] C " +
            "join [SPDK_KanpusEF].[dbo].[eOffice_Terima_MemoDinas] A on A.Kirim_MemoDinasId=C.Kirim_MemoDinasId " +
            "join [ReferensiEF].[dbo].[Unit] B on C.UnitId=B.OrgId " +
            "where [SuratDinasMasukId]='" + a + "' and C.UnitId='203BB8F7-5983-4C65-936F-9C3D83486428' and C.Perihal_Memodinas like 'Pengantar%'";

        return {
            strClassView: "Ptpn8.Models.MemoOnline.ViewKirim_MemoDinas",
            scriptSQL: aa,
            _menuId: menuId
        };

    }

    function filterdetailReadTerimaMemoDinas(a) {
        return {
            strClassView: "Ptpn8.Models.MemoOnline.ViewTerima_MemoDinas",
            scriptSQL: "select A.Terima_MemoDinasId,A.Kirim_MemoDinasId,A.UnitId,A.NomorTerima_MemoDinas,A.TanggalTerima_MemoDinas," +
                "A.Penerima_MemoDinas, A.TanggalDisposisi_MemoDinas, A.PembuatDisposisi_MemoDinas, A.TujuanDisposisi_MemoDinas,A.IsiDisposisi_MemoDinas," +
                "A.PenjelasanDisposisi_MemoDinas, A.StatusTerimaMemoDinas, A.TujuanIdDisposisi_MemoDinas, B.NamaUnit from [SPDK_KanpusEF].[dbo].[eOffice_Terima_MemoDinas] A " +
                "join[ReferensiEF].[dbo].[Unit] B on A.UnitId=B.OrgId where [Kirim_MemoDinasId]='" + a + "'",
            _menuId: menuId
        };
    }

    function filterdetailReadTLMemoDinas(a) {
        return {
            strClassView: "Ptpn8.Models.MemoOnline.ViewTindakLanjut_MemoDinas",
            scriptSQL: "select A.TindakLanjut_MemoDinasId,A.Terima_MemoDinasId,A.UnitId,A.TanggalTerimaDisposisi_MemoDinas,A.PembuatTindakLanjut_MemoDinas," +
                "A.PenjelasanTindakLanjut_MemoDinas,A.StatusTindakLanjutMemoDinas,A.PICTL_MemoDinas,A.TanggalTL_MemoDinas,A.KeteranganSelesai_MemoDinas,A.TanggalSelesai_MemoDinas, A.BuktiSelesai_MemoDinas, " +
                "B.NamaUnit from [SPDK_KanpusEF].[dbo].[eOffice_TindakLanjut_MemoDinas] A " +
                "join[ReferensiEF].[dbo].[Unit] B on A.UnitId=B.OrgId where [Terima_MemoDinasId]='" + a + "'",
            _menuId: menuId
        };
    }

    function readSuratMasuk() {
        ambilSuratMasuk($('#_TahunAgenda_SuratMasuk').text(), $('#_NomorAgenda_SuratMasuk').text()).done(function (dta) {
            if (dta.length > 0) {
                $('#_Nomor_SuratMasuk').text(dta[0][5]);
                $('#_Pengirim_SuratMasuk').text(dta[0][7]);
                $('#_Perihal_SuratMasuk').text(dta[0][9]);
                $('#_Tanggal_SuratMasuk').text(dta[0][4]);
                $('#img1x').removeAttr('src');
                $('#img2x').removeAttr('src');
                $('#img3x').removeAttr('src');
                $('#img4x').removeAttr('src');
                $('#img5x').removeAttr('src');
                $('#imgdisposisi').removeAttr('src');
                d = new Date();
                if (dta[0][10] == "System.Byte[]") $('#img1x').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img1.jpg?' + d.getTime());
                if (dta[0][11] == "System.Byte[]") $('#img2x').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img2.jpg?' + d.getTime());
                if (dta[0][12] == "System.Byte[]") $('#img3x').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img3.jpg?' + d.getTime());
                if (dta[0][13] == "System.Byte[]") $('#img4x').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img4.jpg?' + d.getTime());
                if (dta[0][14] == "System.Byte[]") $('#img5x').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_img5.jpg?' + d.getTime());
                if (dta[0][15] == "System.Byte[]") $('#imgdisposisi').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_imgdisposisi.jpg?' + d.getTime()); $('#imgdisposisi').attr('src', '/Content/Images/View/' + $('#namaUser').val() + '_imgdisposisi.jpg?' + d.getTime());
                if (true) {

                    var _X = dta[0][21];
                    //var _Y = dta[0][18].split(',');
                    //_X.push(_Y[0]);

                    $('#_SifatSurat').data('kendoDropDownList').value(dta[0][20]);

                    $("#fieldlistDitujukanA").prop("checked", false);
                    $("#fieldlistDitujukanB").prop("checked", false);
                    $("#fieldlistDitujukanC").prop("checked", false);
                    $("#fieldlistDitujukanD").prop("checked", false);

                    // DIRUT
                    if (_X.toUpperCase().search('C6DFDB6D-056E-45CC-9D07-A2207FF5FCC3') > -1) {
                        $("#fieldlistDitujukanA").prop('checked', true).prop("disabled", true);
                    }
                    // DIROP
                    if (_X.toUpperCase().search('BDD778FE-BE35-42D7-A891-4B2BE7126CC7') > -1) {
                        $("#fieldlistDitujukanB").prop('checked', true).prop("disabled", true);
                    }
                    // DIRMA
                    if (_X.toUpperCase().search('78DD72E8-18BA-4A78-85FE-578923128A95') > -1) {
                        $("#fieldlistDitujukanC").prop('checked', true).prop("disabled", true);
                    }
                    // DIRKOM
                    if (_X.toUpperCase().search('24BDBB95-0CD5-463E-9ABC-A4B03AB70A1A') > -1) {
                        $("#fieldlistDitujukanD").prop('checked', true).prop("disabled", true);
                    }

                    $("#fieldlistDitujukanA").prop("disabled", true);
                    $("#fieldlistDitujukanB").prop('disabled', true);
                    $("#fieldlistDitujukanC").prop('disabled', true);
                    $("#fieldlistDitujukanD").prop('disabled', true);


                    var arrDitujukan = [];
                    for (var i = 24; i > 0; i--) {
                        if (typeof ($("#fieldlistDitujukan" + i.toString()).val()) != "undefined") {
                            $("#fieldlistDitujukan" + i.toString()).prop("checked", false);
                        }
                    }

                    var tujuanDisposisi = dta[0][21];
                    if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486428") > -1) {
                        $("#fieldlistDitujukan1").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan1').addClass('unChk');
                        $('#lbl2Ditujukan1').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486429") > -1) {
                        $("#fieldlistDitujukan2").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan2').addClass('unChk');
                        $('#lbl2Ditujukan2').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486430") > -1) {
                        $("#fieldlistDitujukan4").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan4').addClass('unChk');
                        $('#lbl2Ditujukan4').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486431") > -1) {
                        $("#fieldlistDitujukan5").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan5').addClass('unChk');
                        $('#lbl2Ditujukan5').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486435") > -1) {
                        $("#fieldlistDitujukan6").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan6').addClass('unChk');
                        $('#lbl2Ditujukan6').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486432") > -1) {
                        $("#fieldlistDitujukan9").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan9').addClass('unChk');
                        $('#lbl2Ditujukan9').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486433") > -1) {
                        $("#fieldlistDitujukan10").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan10').addClass('unChk');
                        $('#lbl2Ditujukan10').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486434") > -1) {
                        $("#fieldlistDitujukan11").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan11').addClass('unChk');
                        $('#lbl2Ditujukan11').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("60A6881F-B09B-440D-8742-778D83A455C1") > -1) {
                        $("#fieldlistDitujukan19").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan19').addClass('unChk');
                        $('#lbl2Ditujukan19').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("E8B60A6F-C658-44A4-9486-DFEF5EADE092") > -1) {
                        $("#fieldlistDitujukan20").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan20').addClass('unChk');
                        $('#lbl2Ditujukan20').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("E7F2EB45-A6FF-4FBD-9006-5FB34F7AFDC1") > -1) {
                        $("#fieldlistDitujukan21").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan21').addClass('unChk');
                        $('#lbl2Ditujukan21').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("C4F3C41D-AAE2-44BD-8C8A-A22DFD50BA66") > -1) {
                        $("#fieldlistDitujukan22").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan22').addClass('unChk');
                        $('#lbl2Ditujukan22').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("0D342E58-4715-44F5-A912-F3E98242FAA3") > -1) {
                        $("#fieldlistDitujukan23").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan23').addClass('unChk');
                        $('#lbl2Ditujukan23').addClass('unChk');
                    }

                    if (tujuanDisposisi.toUpperCase().search("0D342E58-4715-44F5-A912-F3E98242FAA4") > -1) {
                        $("#fieldlistDitujukan24").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan24').addClass('unChk');
                        $('#lbl2Ditujukan24').addClass('unChk');
                    }
                    if (tujuanDisposisi.toUpperCase().search("203BB8F7-5983-4C65-936F-9C3D83486436") > -1) {
                        $("#fieldlistDitujukan25").prop('checked', true).prop("disabled", true);
                    }
                    else {
                        $('#lbl1Ditujukan25').addClass('unChk');
                        $('#lbl2Ditujukan25').addClass('unChk');
                    }


                    for (var i = 1; i <= 25; i++) {
                        $("#fieldlistDisposisi" + i.toString()).prop('checked', false).prop("disabled", true);
                    }
                    arrDisposisi = dta[0][22].split(",");
                    for (var i = 1; i <= 25; i++) {
                        if (jQuery.inArray($('#lblDisposisi' + i.toString()).text(), arrDisposisi) > -1) {
                            $("#fieldlistDisposisi" + i.toString()).prop('checked', true).prop("disabled", true);
                        }
                        else {
                            $('#lblDisposisi' + i.toString()).addClass("unChk");
                        }
                    }
                    $("#penjelasan").val(dta[0][25]).prop("disabled", true);
                    $('#tgldisposisi').data('kendoDateTimePicker').value(dta[0][24]);
                }
            }
        });
    }

    function ambilSuratMasuk(thn, nmr) {
        var url = '/Input/ExecSQL';
        return $.ajax({
            url: url,
            data: {
                //scriptSQL: "SET DATEFORMAT DMY; SELECT TOP 1 [thn_agenda],[no_agenda],[tgl_terima],[penerima],[tgl_surat],[no_surat],[kel_pengirim],[pengirim],[kel_perihal],[perihal],[img1],[imgdisposisi] FROM [Sekper].[dbo].[agenda_surat_masuk] WHERE thn_agenda=" + thn + " and no_agenda=" + nmr,
                scriptSQL: "SET DATEFORMAT DMY; SELECT TOP 1 [thn_agenda],[no_agenda],[tgl_terima],[penerima],[tgl_surat],[no_surat],[kel_pengirim],[pengirim],[kel_perihal],[perihal],[img1],img2,img3,img4,img5,[imgdisposisi], " +
                    " B.SuratDinasMasukId, B.StatusSuratDinas, B.TujuanId_SuratDinasMasuk,B.CCTujuanId_SuratDinasMasuk, C.Sifat_SuratDinasMasuk, C.TujuanDisposisi_SuratDinasMasuk, C.IsiDisposisi_SuratDinasMasuk, C.PenjelasanDisposisi_SuratDinasMasuk,C.TanggalDidisposisiOlehDireksi FROM [Sekper].[dbo].[agenda_surat_masuk] A " +
                    " JOIN [SPDK_KanpusEF].[dbo].[eOffice_SuratDinasMasuk] B ON B.TahunAgenda=A.thn_agenda AND B.NoAgenda=A.no_agenda " +
                    " JOIN [SPDK_KanpusEF].[dbo].[eOffice_DisposisiSuratDinasMasuk] C ON C.SuratDinasMasukId=B.SuratDinasMasukId AND C.DireksiId=B.TujuanId_SuratDinasMasuk" +
                    " WHERE thn_agenda=" + thn + " and no_agenda=" + nmr + " AND (SELECT count(*) FROM [SPDK_KanpusEF].[dbo].[eOffice_SuratDinasMasuk] WHERE TahunAgenda = " + thn + " and NoAgenda = " + nmr + ")>= 1",


                _menuId: menuId
            },
            type: 'POST',
            datatype: 'json'
        });
    }

    function grdOnDataBound(e) {
        var rows = e.sender.tbody.children();
        for (var j = 0; j < rows.length; j++) {
            var row = $(rows[j]);
            var dataItem = e.sender.dataItem(row);
            var unitid = dataItem.get("");
            var r = row.find(".k-grid-BuatSuratPengantar");

            if (dataItem.get("StatusSuratDinas") == "SUDIN-DIREKSI") {
                r.text('Belum Disposisi Direksi');
                r.addClass('disabledbutton');
                r.attr("style", "color: white; background-color: red;")
            }
            else if (dataItem.get("StatusSuratDinas") == "SUDIN-KIRIM") {
                r.text('Sudah Terkirim ke Divisi/Unit');
                r.addClass('disabledbutton');
                r.attr("style", "color: white; background-color: red;")
            }
            else {
                row.find(".k-grid-BuatSuratPengantar").removeClass('disabledbutton');
            }
        }
    }

    function btnBatalDisposisiOnClick(e) {
        e.preventDefault();
        wndDisposisiSudin.close();
    }


    function openWindowBuktiSelesai(e) {
        e.preventDefault();
        var grid = this;
        var row = $(e.currentTarget).closest("tr");
        var data = grid.dataItem(row);
        var Isi = data.BuktiSelesai_MemoDinas;
        var unitId = '';
        dataROW = data;
        wndBuktiSelesai.open().center();

        $('#_Lampiran_BuktiSelesai').text(data.BuktiSelesai_MemoDinas);

        var listBuktiSelesai_MemoDinas = data.BuktiSelesai_MemoDinas;
        if (listBuktiSelesai_MemoDinas == null || listBuktiSelesai_MemoDinas == '') {
            listBuktiSelesai_MemoDinas = [];
        }
        else {
            listBuktiSelesai_MemoDinas = listBuktiSelesai_MemoDinas.split(',');
        }
        $("#daftarFileBuktiSelesai").html("")
        for (var i = 0; i < listBuktiSelesai_MemoDinas.length; i++) {
            unitId = listBuktiSelesai_MemoDinas[i].substr(0, data.UnitId.toString().length)
            listBuktiSelesai_MemoDinas[i] = listBuktiSelesai_MemoDinas[i].substr(data.UnitId.toString().length + 1, 100);
            renderNamaFileBukti(listBuktiSelesai_MemoDinas[i], unitId);
        }

        $("#OkBuktiSelesai").click(function () {
            wndBuktiSelesai.close();
        });
    }

    function renderNamaFileBukti(nmFile, unitId) {
        var extension = "";
        var i = nmFile.lastIndexOf('.');
        if (i > 0)
            extension = nmFile.substring(i + 1).toLowerCase().substring(0, 3);
        else
            extension = "";
        var namaFile = unitId + "_" + nmFile;
        $("<p><div class='daftarfile'><table><tr><td><img src='/Content/Images/FileTypeIcon/png/" + extension + ".png'/></td></tr><tr><td>[" + nmFile + "]</td></tr><tr><td><button type='button' onClick='btnViewBuktiMemoOnClick(\"" + namaFile + "\")'><span class='k-font-icon k-i-pencil'></span>Lihat</button></td></tr></table></div></p>").appendTo($("#daftarFileBuktiSelesai"));
    }


    function btnViewBuktiMemoOnClick(nmFile) {
        //var file = $('#UnitId').val() + '_' + nmFile;
        var newwindow = window.open("/BuktiSelesaiMemo/" + nmFile, "window2", "");
    }

    function grdOnDataBoundTL(e) {
        var rows = e.sender.tbody.children();

        for (var j = 0; j < rows.length; j++) {
            var row = $(rows[j]);
            var dataItem = e.sender.dataItem(row);
            var unitid = dataItem.get("");

            if (dataItem.get("StatusTindakLanjutMemoDinas") == "SELESAI") {
                row.addClass("sudahSelesai");
            }
            else {
                row.addClass("belumSelesai");
            }
        }
    }


    function ubahStatusNotif(nmuser, id) {
        var url = '/Input/ExecSQL';
        return $.ajax({
            url: url,
            data: {
                scriptSQL: "exec [SPDK_KanpusEF]..[UbahNotifJadiTerbaca] '" + nmuser + "','" + menuId + "','" + id + "'",
                //"update [SPDK_KanpusEF].[dbo].[eOffice_NotifikasiSudinModin] set StatusNotifikasi='TERBACA' where NamaUser='" + nmuser + "' and MenuId='" + menuId + "'",
                _menuId: menuId
            },
            type: 'POST',
            datatype: 'json'
        });

    }
</script>


